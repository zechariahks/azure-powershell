{
  "Entries": [
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE5LTAxLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "BuiltinFilterParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:d5ece4fd-7ff1-48af-8fe8-6955b65e168c"
        ],
        "x-ms-correlation-request-id": [
          "ebe944af-eca2-4aa9-82b6-531d2c22c4a0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205233Z:ebe944af-eca2-4aa9-82b6-531d2c22c4a0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:32 GMT"
        ],
        "Content-Length": [
          "453434"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit virtual machines without disaster recovery configured\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Resources/links\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"ASR-Protect-*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Sockets state for a Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an Function app must be carefully reviewed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DisableWebSockets\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"001802d1-4969-4c82-a700-c29c6c6f9bbd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL managed instance TDE protector should be encrypted with your own key\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Transparent Data Encryption (TDE) with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/encryptionProtector\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"048248b0-55cd-46da-b1ff-39efd52db260\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Linux VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"12*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MMAExtension\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"OmsAgentForLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.7\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"053d3325-282c-4e5c-b944-24faffd30d77\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Azure Data Lake Store should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"057ef27e-665e-4328-8ea3-04b3122bd9fb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL DB Level Audit Setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit DB level audit setting for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                    \"equals\": \"[parameters('setting')]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit VMs that do not use managed disks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits VMs that do not use managed disks\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every resource to access your Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Cross origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"CorsRestrictionsForFunctionApp\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0820b7b9-23aa-4725-a1ce-ae4558f718e5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Windows VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MMAExtension\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported PHP Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPHP\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08b17839-76c6-4015-90e0-33d9d54d219c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Network Security Group Rules for Internet facing virtual machines should be hardened\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Security Center analyzes the traffic patterns of Internet facing virtual machines and provides Network Security Group rule recommendations that reduce the potential attack surface\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"adaptiveNetworkHardenings\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08e6af2d-db70-460a-bfe9-d5bd474ba9d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"There should be more than one owner assigned to your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is recommended to designate more than one subscription owner in order to have administrator access redundancy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DesignateMoreThanOneOwner\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09024ccc-0c5f-475e-9457-b7c0d9ed487b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Disk encryption should be applied on virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"VMs without an enabled disk encryption will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit resource location matches resource group location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that the resource location matches its resource group location\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notIn\": [\r\n              \"[resourcegroup().location]\",\r\n              \"global\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL server TDE protector should be encrypted with your own key\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Transparent Data Encryption (TDE) with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/encryptionProtector\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d134df8-db83-46fb-ad72-fe0c9428c8dd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines on which Windows Defender Exploit Guard is not enabled. This policy should only be used along with its corresponding deploy policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"name\",\r\n                    \"equals\": \"WindowsDefenderExploitGuard\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Authorized IP ranges should be defined on Kubernetes Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAuthorizedIPRanges\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Remote debugging should be turned off for Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Remote debugging requires inbound ports to be opened on an function app.  Remote debugging should be turned off.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoteDebuggingForFunctionApp\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e60b895-3786-45da-8377-9c6b4b6ac5f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"CertificateThumbprints\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsCertificateInTrustedRoot\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprints')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsCertificateInTrustedRoot\"\r\n                    },\r\n                    \"CertificateThumbprints\": {\r\n                      \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"CertificateThumbprints\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"106ccbe4-a791-4f33-a44a-06796944b8d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Dependency Agent Deployment - VM Image (OS) unlisted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"12-SP2\",\r\n                                \"12-SP3\",\r\n                                \"12-SP4\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"14.04.0-LTS\",\r\n                                \"14.04.1-LTS\",\r\n                                \"14.04.5-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"16.04-LTS\",\r\n                                \"16.04.0-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"18.04-LTS\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"Centos\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11ac78e3-31bc-4f0c-8434-37ab963cea07\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"installedApplication\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WhitelistedApplication\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[InstalledApplication]bwhitelistedapp;Name', '=', parameters('installedApplication')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WhitelistedApplication\"\r\n                    },\r\n                    \"installedApplication\": {\r\n                      \"value\": \"[parameters('installedApplication')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"installedApplication\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[InstalledApplication]bwhitelistedapp;Name\",\r\n                                \"value\": \"[parameters('installedApplication')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs in which the Administrators group contains any of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group contains any of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"MembersToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members to exclude\",\r\n              \"description\": \"A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembersToExclude\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToExclude', '=', parameters('MembersToExclude')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AdministratorsGroupMembersToExclude\"\r\n                    },\r\n                    \"MembersToExclude\": {\r\n                      \"value\": \"[parameters('MembersToExclude')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"MembersToExclude\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;MembersToExclude\",\r\n                                \"value\": \"[parameters('MembersToExclude')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"144f1397-32f9-4598-8c88-118decc3ccba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a minimum password age of 1 day. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordAge\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MinimumPasswordAge\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16390df4-2f73-4b42-af13-c801066763df\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not have the specified Windows PowerShell modules installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsPowerShellModules\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16f9b37c-4408-4c30-bc17-254958f2e2d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Transparent Data Encryption on SQL databases should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit transparent data encryption status for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"enabled\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Access to App Services should be restricted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure security center has discovered that the networking configuration of some of your app services are overly permissive and allow inbound traffic from ranges that are too broad\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Web/sites\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"restrictAccessToAppServices\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a833ff1-d297-4a0f-9944-888428f8e0ff\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability assessment should be enabled on your SQL managed instances\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit SQL managed instances which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n                \"equals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b7aa243-30e4-4c9e-bca8-d0d3022b634a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Dependency Agent for Windows VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.6\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c210e94-a481-4beb-95fa-1571b434fb04\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Virtual machines should be migrated to new Azure Resource Manager resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, ARM-based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.classicCompute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d84d5fb-01f6-4d12-ba4f-4a26081d403d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported .NET Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestDotNet\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1de7b11d-1870-41a5-8181-507e7c663cfb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require tag and its value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"An Azure Active Directory administrator should be provisioned for SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/administrators\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f314764-cb73-4fc9-b863-8eca98ac36e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"The NSGs rules for web applications on IaaS should be hardened\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure security center has discovered that some of your virtual machines are running web applications, and the NSGs associated to these virtual machines are overly permissive with regards to the web application ports\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Apps that are not using custom domains\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of custom domains protects a API app from common attacks such as phishing and other DNS-related attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UsedCustomDomains\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"224da9fe-0d38-4e79-adb3-0a6e2af942ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Management ports should be closed on your virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"restrictAccessToManagementPorts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22730e10-96f6-4aac-ad84-9383d35b5917\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Only secure connections to your Redis Cache should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit enabling of only connections via SSL to Redis Cache. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n        \"metadata\": {\r\n          \"category\": \"Cache\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Cache/redis\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22bee202-a82f-4305-9a2a-6d7f44d4dedb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not restrict the minimum password length to 14 characters. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordLength\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MinimumPasswordLength\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23020aa6-1135-4be2-bae2-149982b06eca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not have a maximum password age of 70 days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not have a maximum password age of 70 days. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"MaximumPasswordAge\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24dde96d-f0b1-425e-884f-4a1421e2dcdc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Endpoint protection solution should be installed on virtual machine scale sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit the existence and health of an endpoint protection solution on your virtual machines scale sets, to protect them from threats and vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"EndpointProtection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26a828e1-e88f-464e-bbb3-c134a282b9de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Metric alert rules should be configured on Batch accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit configuration of metric alert rules on Batch account to enable the required metric\",\r\n        \"metadata\": {\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name that an alert rule must be enabled on\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/alertRules\",\r\n              \"existenceScope\": \"Subscription\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/isEnabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.metricName\",\r\n                    \"equals\": \"[parameters('metricName')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.resourceUri\",\r\n                    \"equals\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourcegroups/', resourceGroup().name, '/providers/Microsoft.Batch/batchAccounts/', field('name'))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\",\r\n                  \"2019-Datacenter\",\r\n                  \"2019-Datacenter-Core\",\r\n                  \"2019-Datacenter-Core-smalldisk\",\r\n                  \"2019-Datacenter-Core-with-Containers\",\r\n                  \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                  \"2019-Datacenter-smalldisk\",\r\n                  \"2019-Datacenter-with-Containers\",\r\n                  \"2019-Datacenter-with-Containers-smalldisk\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExclusionsPaths\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsExtensions\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsProcesses\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"RealtimeProtectionEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsIsEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"false\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsScanType\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Quick\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsDay\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"7\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsTime\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"120\",\r\n                        \"metadata\": {\r\n                          \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security\",\r\n                          \"type\": \"IaaSAntimalware\",\r\n                          \"typeHandlerVersion\": \"1.3\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AntimalwareEnabled\": true,\r\n                            \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                            \"ScheduledScanSettings\": {\r\n                              \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                              \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                              \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                              \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                            },\r\n                            \"Exclusions\": {\r\n                              \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                              \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                              \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"RealtimeProtectionEnabled\": {\r\n                      \"value\": \"true\"\r\n                    },\r\n                    \"ScheduledScanSettingsIsEnabled\": {\r\n                      \"value\": \"true\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append tag and its default value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Appends the specified tag and value when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not store passwords using reversible encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not store passwords using reversible encryption. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"StorePasswordsUsingReversibleEncryption\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d60d3b7-aa10-454c-88a8-de39d99d17c6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Linux VMs that allow remote connections from accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Linux virtual machines that allow remote connections from accounts without passwords. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"PasswordPolicy_msid110\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d67222d-05fd-4526-a171-2ee132ad9e83\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web Application should only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"OnlyHttpsForWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2fde8a98-6892-426a-83ba-050e640c0ce0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs that are not joined to the specified domain\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not joined to the specified domain. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"DomainName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Domain Name (FQDN)\",\r\n              \"description\": \"The fully qualified domain name (FQDN) that the Windows VMs should be joined to\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDomainMembership\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[DomainMembership]WindowsDomainMembership;DomainName', '=', parameters('DomainName')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsDomainMembership\"\r\n                    },\r\n                    \"DomainName\": {\r\n                      \"value\": \"[parameters('DomainName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"DomainName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[DomainMembership]WindowsDomainMembership;DomainName\",\r\n                                \"value\": \"[parameters('DomainName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"315c850a-272d-4502-8935-b79010405970\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageId\",\r\n                          \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageId\",\r\n                          \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"12*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"14.04*LTS\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"16.04*LTS\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"18.04*LTS\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Oracle\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Oracle-Linux\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7.*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"CentOS\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32133ab0-ee4b-4b44-98d6-042180979d50\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the specified services are not installed and 'Running'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"ServiceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Service names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the services that should be installed and 'Running'. e.g. 'WinRm;Wi*'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsServiceStatus\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[WindowsServiceStatus]WindowsServiceStatus1;ServiceName', '=', parameters('ServiceName')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsServiceStatus\"\r\n                    },\r\n                    \"ServiceName\": {\r\n                      \"value\": \"[parameters('ServiceName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ServiceName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\",\r\n                                \"value\": \"[parameters('ServiceName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32b1e4d4-6cd5-47b4-a935-169da8a5c262\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Linux VMs that have accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that have accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"AzureDatabricks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"RHEL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"osa\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordPolicy_msid232\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"PasswordPolicy_msid232\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3470477a-b35a-49db-aca5-1073d04524fe\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit unrestricted network access to storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit unrestricted network access in your storage account firewall settings. Instead, configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premise clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\r\n                \"equals\": \"Allow\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34c877ad-507e-4c82-993e-3452a6e0ad3c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Logic Apps should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Logic Apps\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Logic/workflows\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34f95f76-5386-4de7-b824-0d8478470c9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not have a maximum password age of 70 days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a maximum password age of 70 days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MaximumPasswordAge\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MaximumPasswordAge\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"356a906e-05e5-4625-8729-90771e0ee934\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every resource to access your API App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Cross origin Resource Sharing (CORS) should not allow all domains to access your API app. Allow only required domains to interact with your API app.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"CorsRestrictionsForApiApp\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Advanced Threat Protection on Storage Accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables Advanced Threat Protection on Storage Accounts.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/advancedThreatProtectionSettings\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/advancedThreatProtectionSettings/isEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"storageAccountName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-08-01-preview\",\r\n                        \"type\": \"Microsoft.Storage/storageAccounts/providers/advancedThreatProtectionSettings\",\r\n                        \"name\": \"[concat(parameters('storageAccountName'), '/Microsoft.Security/current')]\",\r\n                        \"properties\": {\r\n                          \"isEnabled\": true\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"storageAccountName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"361c2074-3595-4e5d-8cab-4f21dffc835c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Automation account variables should be encrypted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is important to enable encryption of Automation account variable assets when storing sensitive data\",\r\n        \"metadata\": {\r\n          \"category\": \"Automation\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Automation/automationAccounts/variables\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Automation/automationAccounts/variables/isEncrypted\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3657f5a0-770e-44a3-b44e-9431ba1e9735\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Threat Detection on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures that Threat Detection is enabled on SQL Servers.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/securityAlertPolicies.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"emailAccountAdmins\": true\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"36d49e87-48c4-4f2e-beed-ba4ed02b71f5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts should be migrated to new Azure Resource Manager resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use new Azure Resource Manager for your storage accounts to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.classicStorage/storageAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37e0d2fe-28a5-43d6-a273-67d37d1f5606\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in IoT Hub should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Devices/IotHubs\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"383856f8-de7f-44a2-81fc-e5135b5c2aa4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Advanced data security settings for SQL managed instance should contain an email address to receive security alerts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure that an email address is provided for the 'Send alerts to' field in the Advanced Data Security server settings. This email address receives alert notifications when anomalous activities are detected on SQL managed instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Pod Security Policies should be defined on Kubernetes Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Define Pod Security Policies to reduce the attack vector by removing unnecessary application privileges. It is recommended to configure Pod Security Policies to only allow pods to access the resources which they have permissions to access.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3abeb944-26af-43ee-b83d-32aaf060fb94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Dependency Agent for Windows VM Scale Sets (VMSS)\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency Agent for Windows VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"DependencyAgentWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.7\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3be22e3b-d919-47aa-805e-8985dbeb0ad9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Windows VM Scale Sets (VMSS)\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics Agent for Windows VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MMAExtension\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3c1b3629-c8f8-4bf6-862c-037cb9094038\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit the OS vulnerabilities on your virtual machine scale sets to protect them from attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"OsVulnerabilities\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy default Log Analytics Agent for Ubuntu VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"Canonical\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"UbuntuServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"18.04-LTS\",\r\n                  \"16.04-LTS\",\r\n                  \"16.04.0-LTS\",\r\n                  \"14.04.2-LTS\",\r\n                  \"12.04.5-LTS\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"OmsAgentForLinux\",\r\n                          \"typeHandlerVersion\": \"1.4\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Linux VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported PHP Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPHP\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3fe37002-5d00-4b37-a301-da09e3a0ca66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Secure transfer to storage accounts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit requirment of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"404c3081-a854-4457-ae30-26a93ef643f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Batch accounts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"428256e6-1fac-4f48-a757-df34c2b3336d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Monitor permissive network access in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"permissiveNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44452482-524f-4bf4-b852-0bff7cc4a3ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require SQL Server version 12.0\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures all SQL servers use version 12.0\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/version\",\r\n                  \"equals\": \"12.0\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Python Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPython\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"46544d7b-1f0d-46f5-81da-5c1351de1b06\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require automatic OS image patching on Virtual Machine Scale Sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgradePolicy.enableAutomaticOSUpgrade\",\r\n                \"notEquals\": \"True\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\",\r\n                \"notEquals\": \"True\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"465f0161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Adaptive Application Controls should be enabled on virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible Application Whitelist configuration will be monitored by Azure Security Center\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"applicationWhitelisting\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47a6b606-51aa-4496-8bb7-64b11cf66adc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for an API App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects an API app from common attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"ConfigureIPRestrictions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"48893b84-a2c8-4d9a-badf-835d5d1b7d53\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append tag and its default value to resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Appends the specified tag and value when any resource group which is missing this tag is created or updated. Does not modify the tags of resource groups created before this policy was applied until those resource groups are changed.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Linux VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"AzureDatabricks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"RHEL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"osa\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"installed_application_linux\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent', '=', concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"installed_application_linux\"\r\n                    },\r\n                    \"ApplicationName\": {\r\n                      \"value\": \"[parameters('ApplicationName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ApplicationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\",\r\n                                \"value\": \"[concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4d1c04de-2172-403f-901b-90608c35c721\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Dependency Agent for Linux VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"14.04.0-LTS\",\r\n                              \"14.04.1-LTS\",\r\n                              \"14.04.5-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"16.04-LTS\",\r\n                              \"16.04.0-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"18.04-LTS\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"12-SP2\",\r\n                              \"12-SP3\",\r\n                              \"12-SP4\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.6\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"A maximum of 3 owners should be designated for your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is recommended to designate up to 3 subscription owners in order to reduce the potential for breach by a compromised owner.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DesignateLessThanXOwners\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f11b553-d42e-4e3a-89be-32ca364cad4c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every resource to access your Web Application\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Cross origin Resource Sharing (CORS) should not allow all domains to access your web application. Allow only required domains to interact with your web app.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"CorsRestrictionsForWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5744710e-cc2f-4ee8-8809-3b11e89f4bc9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not have a minimum password age of 1 day. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"MinimumPasswordAge\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5aa11bbc-5c76-4302-80e5-aba46a4282e7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not restrict the minimum password length to 14 characters. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"MinimumPasswordLength\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5aebc8d1-020d-4037-89a0-02043a7524ec\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Linux VMs that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Linux virtual machines that have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"not_installed_application_linux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5b842acb-0fe7-41b0-9f40-880ec4ad84d8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Log Analytics Agent Deployment in VMSS - VM Image (OS) unlisted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMSS as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"12*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"14.04*LTS\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"16.04*LTS\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"18.04*LTS\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Oracle\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Oracle-Linux\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7.*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"CentOS\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"External accounts with write permissions should be removed from your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"External accounts with write privileges should be removed from your subscription in order to prevent unmonitored access.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoveExternalAccountsWithWritePermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5c607a2e-c700-4744-8254-d77e7c9eb5e4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Function App should only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"OnlyHttpsForFunctionApp\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5df82f4f-773a-4a2d-97a2-422a806f1a55\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported .NET Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestDotNet\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5e3315e0-a414-4efb-a4d2-c7bd2b0443d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WhitelistedApplication\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5e393799-e3ca-4e43-a9a5-0ec4648a57d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in India data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation in the following locations only: West India, South India, Central India\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Linux VM Scale Sets (VMSS)\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics Agent for Linux VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"12*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MMAExtension\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"OmsAgentForLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.7\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"External accounts with read permissions should be removed from your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"External accounts with read privileges should be removed from your subscription in order to prevent unmonitored access.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoveExternalAccountsWithReadPermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5f76cf89-fbf2-47fd-a3f4-b891fa780b60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows web servers that are not using secure communication protocols\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"AuditSecureProtocol\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"60ffe3e2-4604-4460-8f22-0f1da058266c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Advanced Data Security on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables Advanced Data Security on SQL Servers. This includes turning on Threat Detection and Vulnerability Assessment. It will automatically create a storage account in the same region and resource group as the SQL server to store scan results, with a 'sqlva' prefix.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/securityAlertPolicies.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"serverResourceGroupName\": \"[resourceGroup().name]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), variables('serverResourceGroupName'), parameters('location'))]\",\r\n                      \"storageName\": \"[tolower(concat('sqlva', variables('uniqueStorage')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                        \"name\": \"[variables('storageName')]\",\r\n                        \"apiVersion\": \"2016-01-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"sku\": {\r\n                          \"name\": \"Standard_LRS\"\r\n                        },\r\n                        \"kind\": \"Storage\",\r\n                        \"properties\": {}\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"emailAccountAdmins\": true\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/vulnerabilityAssessments\",\r\n                        \"apiVersion\": \"2018-06-01-preview\",\r\n                        \"properties\": {\r\n                          \"storageContainerPath\": \"[concat(reference(resourceId('Microsoft.Storage/storageAccounts', variables('storageName'))).primaryEndpoints.blob, 'vulnerability-assessment')]\",\r\n                          \"storageAccountAccessKey\": \"[listKeys(resourceId('Microsoft.Storage/storageAccounts', variables('storageName')), '2018-02-01').keys[0].value]\",\r\n                          \"recurringScans\": {\r\n                            \"isEnabled\": true,\r\n                            \"emailSubscriptionAdmins\": true,\r\n                            \"emails\": []\r\n                          }\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Storage/storageAccounts/', variables('storageName'))]\",\r\n                          \"[concat('Microsoft.Sql/servers/', parameters('serverName'), '/securityAlertPolicies/Default')]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6134c3db-786f-471e-87bc-8f479dc890f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Service Fabric provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node communication using a primary cluster certificate. Set the protection level to ensure that all node-to-node messages are encrypted and digitally signed\",\r\n        \"metadata\": {\r\n          \"category\": \"Service Fabric\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ServiceFabric/clusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ServiceFabric/clusters/fabricSettings[*].name\",\r\n                    \"notEquals\": \"Security\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name\",\r\n                    \"notEquals\": \"ClusterProtectionLevel\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value\",\r\n                    \"notEquals\": \"EncryptAndSign\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"617c02be-7f02-4efd-8836-3180d47b6c68\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit missing blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy is no longer necessary because storage blob encryption is enabled by default and cannot be turned off.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"655cb504-bcee-4362-bd4c-402e6aa38759\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for a Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects a Function app from common attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"ConfigureIPRestrictions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"664346d9-be92-43fb-a219-d595eeb76a90\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs on which the Log Analytics agent is not connected as expected\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"WorkspaceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Connected workspace IDs\",\r\n              \"description\": \"A semicolon-separated list of the workspace IDs that the Log Analytics agent should be connected to\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsLogAnalyticsAgentConnection\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId', '=', parameters('WorkspaceId')))]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsLogAnalyticsAgentConnection\"\r\n                    },\r\n                    \"WorkspaceId\": {\r\n                      \"value\": \"[parameters('WorkspaceId')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"WorkspaceId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId\",\r\n                                \"value\": \"[parameters('WorkspaceId')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/68511db2-bd02-41c4-ae6b-1900a012968a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"68511db2-bd02-41c4-ae6b-1900a012968a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which Windows Defender Exploit Guard is not enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"NotAvailableMachineState\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"State in which to show VMs on which Windows Defender Exploit Guard is not available\",\r\n              \"description\": \"Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to 'Non-Compliant' will make machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) non-compliant. Setting this value to 'Compliant' will make these machines compliant.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Compliant\",\r\n              \"Non-Compliant\"\r\n            ],\r\n            \"defaultValue\": \"Non-Compliant\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDefenderExploitGuard\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState', '=', parameters('NotAvailableMachineState')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsDefenderExploitGuard\"\r\n                    },\r\n                    \"NotAvailableMachineState\": {\r\n                      \"value\": \"[parameters('NotAvailableMachineState')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NotAvailableMachineState\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\",\r\n                                \"value\": \"[parameters('NotAvailableMachineState')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for a Web Application\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects a web application from common attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"ConfigureIPRestrictions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6a8450e2-6c61-43b4-be65-62e3a197bffe\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deprecated accounts should be removed from your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deprecated accounts should be removed from your subscriptions.  Deprecated accounts are accounts that have been blocked from signing in.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoveDeprecatedAccounts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6b1cbf55-e8b6-442f-ba4c-7246b6381474\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"displayName\": \"Not allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6fdb9205-3462-4cfc-87d8-16c7860b53f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs on which the DSC configuration is not compliant\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsDscConfiguration\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7227ebe5-9ff7-47ab-b823-171cd02fb90f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that allow re-use of the previous 24 passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that allow re-use of the previous 24 passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"EnforcePasswordHistory\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"EnforcePasswordHistory\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"726671ac-c4de-4908-8c7d-6043ae62e3b6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed storage account SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to specify a set of storage account SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7433c107-6db4-4ad1-b57a-a76dce0154a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit enabling of diagnostic logs in App Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit enabling of diagnostic logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"App Service\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/config\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"web\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/detailedErrorLoggingEnabled\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/httpLoggingEnabled\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/requestTracingEnabled\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"752c6934-9bcc-4749-b004-655e676ae2ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerabilities should be remediated by a Vulnerability Assessment solution\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Monitors vulnerabilities detected by Vulnerability Assessment solution and VMs without a Vulnerability Assessment solution in Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"vulnerabilityAssessment\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"760a85ff-6162-42b3-8d70-698e268f648c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Dependency Agent for Linux VM Scale Sets (VMSS)\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency Agent for Linux VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"14.04.0-LTS\",\r\n                              \"14.04.1-LTS\",\r\n                              \"14.04.5-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"16.04-LTS\",\r\n                              \"16.04.0-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"18.04-LTS\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"12-SP2\",\r\n                              \"12-SP3\",\r\n                              \"12-SP4\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"DependencyAgentLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.7\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"765266ab-e40e-4c61-bcb2-5a5275d0b7c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows Server VMs on which Windows Serial Console is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows Server virtual machines on which Windows Serial Console is not enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"EMSPortNumber\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"EMS Port Number\",\r\n              \"description\": \"An integer indicating the COM port to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ],\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"EMSBaudRate\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"EMS Baud Rate\",\r\n              \"description\": \"An integer indicating the baud rate to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"9600\",\r\n              \"19200\",\r\n              \"38400\",\r\n              \"57600\",\r\n              \"115200\"\r\n            ],\r\n            \"defaultValue\": \"115200\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsSerialConsole\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber', '=', parameters('EMSPortNumber'), ',', '[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate', '=', parameters('EMSBaudRate')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsSerialConsole\"\r\n                    },\r\n                    \"EMSPortNumber\": {\r\n                      \"value\": \"[parameters('EMSPortNumber')]\"\r\n                    },\r\n                    \"EMSBaudRate\": {\r\n                      \"value\": \"[parameters('EMSBaudRate')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"EMSPortNumber\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"EMSBaudRate\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber\",\r\n                                \"value\": \"[parameters('EMSPortNumber')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate\",\r\n                                \"value\": \"[parameters('EMSBaudRate')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7a031c68-d6ab-406e-a506-697a19c634b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7a031c68-d6ab-406e-a506-697a19c634b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Virtual Machine Scale Sets should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"It is recommended to enable Logs so that activity trail can be recreated when investigations are required in the event of an incident or a compromise.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                        \"equals\": \"IaaSDiagnostics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                        \"equals\": \"Microsoft.Azure.Diagnostics\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                        \"equals\": \"LinuxDiagnostic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                        \"equals\": \"Microsoft.OSTCExtensions\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7c1b1214-f927-48bf-8882-84f0af6588b1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Require blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures blob encryption for storage accounts is turned on. It only applies to Microsoft.Storage resource types, not other storage providers. This policy is deprecated because storage blob encryption is now enabled by default, and can no longer be disabled.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"NotInstalledApplication\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7e56b49b-5990-4159-a734-511ea19b731c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that have not restarted within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that have not restarted within the specified number of days. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"MachineLastBootUpTime\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7e84ba44-6d03-46fd-950e-5efa5a1112fa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not have the password complexity setting enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the password complexity setting enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordMustMeetComplexityRequirements\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"PasswordMustMeetComplexityRequirements\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit diagnostic setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit diagnostic setting for selected resource types\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypes')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7f89b1eb-583c-429a-8828-af049802c1d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL auditing settings at the server level for the Action-Groups and Actions\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"SQL auditing should be configured to capture certain Action-Groups and Actions. The AuditActionsAndGroups property should contain at least SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP FAILED_DATABASE_AUTHENTICATION_GROUP, BATCH_COMPLETED_GROUP to ensure a thorough audit logging\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\",\r\n                      \"notEquals\": \"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\",\r\n                      \"notEquals\": \"FAILED_DATABASE_AUTHENTICATION_GROUP\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\",\r\n                      \"notEquals\": \"BATCH_COMPLETED_GROUP\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7ff426e2-515f-405a-91c8-4f2333442eb5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Event Hub should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Event Hub\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.EventHub/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"83a214f7-d01a-484b-91a9-ed54470c9a6a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enables transparent data encryption on SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullDbName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('fullDbName'), '/current')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n                        \"apiVersion\": \"2014-04-01\",\r\n                        \"properties\": {\r\n                          \"status\": \"Enabled\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullDbName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86a912f6-9a06-4e26-b447-11b16ba8659f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"System updates should be installed on your machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Missing security system updates on your servers will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"systemUpdates\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86b3d65f-7626-441e-b690-81a8b71cff60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require specified tag\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforces existence of a tag. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/871b6d14-10aa-478d-b590-94f262ecfa99\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"871b6d14-10aa-478d-b590-94f262ecfa99\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Linux VMs that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'python; powershell'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"AzureDatabricks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"RHEL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"osa\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"not_installed_application_linux\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent', '=', concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"not_installed_application_linux\"\r\n                    },\r\n                    \"ApplicationName\": {\r\n                      \"value\": \"[parameters('ApplicationName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ApplicationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\",\r\n                                \"value\": \"[concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"884b209a-963b-4520-8006-d20cb3c213e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL servers should be configured with auditing retention days greater than 90 days.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit SQL servers configured with an auditing retention period of less than 90 days.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/servers/auditingSettings/retentionDays\",\r\n                \"greater\": 90\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"89099bee-89e0-4b26-a5f4-165451757743\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs with a pending reboot\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines with a pending reboot. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsPendingReboot\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8b0de57a-f511-4d45-a277-17cb79cb163b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require tag and its value on resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"notEquals\": \"[parameters('tagValue')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8ce3da23-7156-49e4-b145-24f95f9dcb46\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not store passwords using reversible encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not store passwords using reversible encryption. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"StorePasswordsUsingReversibleEncryption\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"StorePasswordsUsingReversibleEncryption\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8ff0b18b-262e-4512-857a-48ad0aeb9a78\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified Windows PowerShell modules installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"Modules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"PowerShell Modules\",\r\n              \"description\": \"A semicolon-separated list of the names of the PowerShell modules that should be installed. You may also specify a specific version of a module that should be installed by including a comma after the module name, followed by the desired version. e.g. PSDscResources; SqlServerDsc, 12.0.0.0; ComputerManagementDsc, 6.1.0.0\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsPowerShellModules\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[PowerShellModules]PowerShellModules1;Modules', '=', parameters('Modules')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsPowerShellModules\"\r\n                    },\r\n                    \"Modules\": {\r\n                      \"value\": \"[parameters('Modules')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"Modules\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[PowerShellModules]PowerShellModules1;Modules\",\r\n                                \"value\": \"[parameters('Modules')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"90ba2ee7-4ca8-4673-84d1-c851c50d3baf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MFA should be enabled accounts with write permissions on your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with write privileges to prevent a breach of accounts or resources.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"EnableMFAForWritePermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9297c21d-2ed6-4474-b48f-163f75654ce3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that contain certificates expiring within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that contain certificates expiring within the specified number of days. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"CertificateExpiration\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9328f27e-611e-44a7-a244-39109d7d35ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9328f27e-611e-44a7-a244-39109d7d35ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs in which the Administrators group does not contain all of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group does not contain all of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"MembersToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members to include\",\r\n              \"description\": \"A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembersToInclude\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToInclude', '=', parameters('MembersToInclude')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AdministratorsGroupMembersToInclude\"\r\n                    },\r\n                    \"MembersToInclude\": {\r\n                      \"value\": \"[parameters('MembersToInclude')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"MembersToInclude\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;MembersToInclude\",\r\n                                \"value\": \"[parameters('MembersToInclude')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"93507a81-10a4-4af0-9ee2-34cf25a96e98\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in European data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation in the following locations only: North Europe, West Europe\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"northeurope\",\r\n                \"westeurope\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"94c19f19-8192-48cd-a11b-e37099d3e36b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require specified tag on resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces existence of a tag on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"96670d01-0a4d-4649-9c89-2d3abc0a5025\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure that 'Send alerts to' is set in SQL server Advanced Data Security settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure that an email address is provided for the 'Send alerts to' field in the Advanced Data Security server settings. This email address receives alert notifications when anomalous activities are detected on SQL servers.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/servers/securityAlertPolicies/emailAddresses[*]\",\r\n                \"notEquals\": \"\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9677b740-f641-4f3c-b9c5-466005c85278\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9677b740-f641-4f3c-b9c5-466005c85278\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in United States data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation in the following locations only: Central US, East US, East US2, North Central US, South Central US, West US\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"centralus\",\r\n                \"eastus\",\r\n                \"eastus2\",\r\n                \"northcentralus\",\r\n                \"southcentralus\",\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"983211ba-f348-4758-983b-21fa29294869\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Azure SQL Database to Event Hub\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Azure SQL Database to stream to a regional Event Hub on any Azure SQL Database which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy\"\r\n          },\r\n          \"eventHubRuleId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Event Hub Authorization Rule Id\",\r\n              \"description\": \"The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\",\r\n              \"strongType\": \"Microsoft.EventHub/Namespaces/AuthorizationRules\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Event Hub - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Event Hub  - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"eventHubRuleId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Sql/servers/databases/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('fullName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"eventHubAuthorizationRuleId\": \"[parameters('eventHubRuleId')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"QueryStoreRuntimeStatistics\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"QueryStoreWaitStatistics\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Errors\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"DatabaseWaitStatistics\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Blocks\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"SQLInsights\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Audit\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"SQLSecurityAuditEvents\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Timeouts\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"AutomaticTuning\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Deadlocks\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled diagnostic settings for ', parameters('fullName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"fullName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"eventHubRuleId\": {\r\n                      \"value\": \"[parameters('eventHubRuleId')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9a7c7a7d-49e5-4213-bea8-6a502b6272e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9a7c7a7d-49e5-4213-bea8-6a502b6272e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported Java Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported Java version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestJava\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9bfe3727-0a17-471f-a2fe-eddd6b668745\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Security center has identified some of your Network Security Groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to easily target your resources.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedNetworkEndpoint\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9daedab3-fb2d-461e-b861-71790eead4f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append tag and its value from the resource group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Appends the specified tag with its value from the resource group when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"value\": \"[resourceGroup().tags[parameters('tagName')]]\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"value\": \"[resourceGroup().tags[parameters('tagName')]]\",\r\n                \"notEquals\": \"\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[resourceGroup().tags[parameters('tagName')]]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9ea02ca2-71db-412d-8b00-7c7ca9fcd32d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9ea02ca2-71db-412d-8b00-7c7ca9fcd32d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that are not set to the specified time zone\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that are not set to the specified time zone. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsTimeZone\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9f658460-46b7-43af-8565-94fc0662be38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9f658460-46b7-43af-8565-94fc0662be38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs on which the Log Analytics agent is not connected as expected\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. This policy should only be used along with its corresponding deploy policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsLogAnalyticsAgentConnection\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a030a57e-4639-4e8f-ade9-a92f33afe7ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization can deploy. Only resource types that support 'tags' and 'location' will be affected by this policy. To restrict all resources please duplicate this policy and change the 'mode' to 'All'.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that can be deployed.\",\r\n              \"displayName\": \"Allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"type\",\r\n              \"in\": \"[parameters('listOfResourceTypesAllowed')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a08ec900-254a-4555-9bf5-e42af04b5c5c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Service Bus namespace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Service Bus clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you shoud create access policies at the entity level for queues and topics to provide access to only the specific entity\",\r\n        \"metadata\": {\r\n          \"category\": \"Service Bus\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ServiceBus/namespaces/authorizationRules\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"RootManageSharedAccessKey\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1817ec0-a368-432a-8057-8371e17ac6ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that are not joined to the specified domain\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that are not joined to the specified domain. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsDomainMembership\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a29ee95c-0395-4515-9851-cc04ffe82a91\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit usage of custom RBAC rules\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit built-in roles such as 'Owner, Contributer, Reader' instead of custom RBAC roles, which are error prone. Using custom roles is treated as an exception and requires a rigorous review and threat modeling\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Authorization/roleDefinitions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Authorization/roleDefinitions/type\",\r\n                \"equals\": \"CustomRole\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a451c1ef-c6ca-483d-87ed-f49761e3ffb5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL server level Auditing settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audits the existence of SQL Auditing at the server level\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Desired Auditing setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"enabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"[parameters('setting')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"DDoS Protection Standard should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"DDoS protection standard should be enabled for all virtual networks with a subnet that is part of an application gateway with a public IP.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"EnableDDoSProtection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a7aca53f-2ed4-4466-a25e-0b45ade68efd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require encryption on Data Lake Store accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures encryption is enabled on all Data Lake Store accounts\",\r\n        \"metadata\": {\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataLakeStore/accounts/encryptionState\",\r\n                \"equals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a7ff3161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Monitor unencrypted SQL databases in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unencrypted SQL databases will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8bef009-a5c9-4d0f-90d7-6018734e8a16\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy network watcher when virtual networks are created\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"networkWatcherRG\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[field('location')]\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWatcher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MFA should be enabled on accounts with owner permissions on your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with owner permissions to prevent a breach of accounts or resources.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"EnableMFAForOwnerPermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"aa633080-8b72-40c4-a2d7-d00c03e80bed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Automatic provisioning of security monitoring agent\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Installs security agent on VMs for advanced security alerts and preventions in Azure Security Center. Applies only for subscriptions that use Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"securityAgent\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6037-1fc4-47f6-aac5-89706589be24\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Advanced data security should be enabled on your SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit SQL servers without Advanced Data Security\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/servers/securityAlertPolicies/state\",\r\n                \"equals\": \"Enabled\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Advanced data security should be enabled on your managed instances\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit SQL managed instances without Advanced Data Security\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/state\",\r\n                \"equals\": \"Enabled\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Role-Based Access Control (RBAC) should be used on Kubernetes Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To provide granular filtering on the actions that users can perform, use Role-Based Access Control (RBAC) to manage permissions in Kubernetes Service Clusters and configure relevant authorization policies.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/enableRBAC\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/enableRBAC\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'environment' tag value in allowed values\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation if the 'environment' tag is set to one of the following values: production, dev, test, staging\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags.environment\",\r\n              \"in\": [\r\n                \"production\",\r\n                \"dev\",\r\n                \"test\",\r\n                \"staging\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ac7e5fc0-c029-4b12-91d4-a8500ce697f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL managed instances should send security alerts to admins and subscription owners\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that 'email notification to admins and subscription owners' is enabled in the SQL managed instance advanced threat protection settings. This ensures that any detections of anomalous activities on SQL managed instance are reported as soon as possible to the admins.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAccountAdmins\",\r\n                \"equals\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"aeb23562-188d-47cb-80b8-551f16ef9fff\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Monitor missing Endpoint Protection in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"endpointProtection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af6cd1bd-1635-48cb-bde7-5b15693900b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Monitor unaudited SQL servers in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"SQL servers which don't have SQL auditing turned on will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"auditing\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af8051bf-258b-44e2-a2bf-165330459f9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Just-In-Time network access control should be applied on virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible network Just In Time (JIT) access will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"jitNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b0f33259-77d7-4c9e-aac6-3aabcfae693c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Linux VMs that do not have the passwd file permissions set to 0644\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Linux virtual machines that do not have the passwd file permissions set to 0644. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"PasswordPolicy_msid121\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b18175dd-c599-4c64-83ba-bb018a06d35b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Event Hub clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you shoud create access policies at the entity level for queues and topics to provide access to only the specific entity\",\r\n        \"metadata\": {\r\n          \"category\": \"Event Hub\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.EventHub/namespaces/authorizationRules\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"RootManageSharedAccessKey\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b278e460-7cfc-4451-8294-cccc40a940d7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows web servers that are not using secure communication protocols\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AuditSecureProtocol\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AuditSecureProtocol\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b2fc8f91-866d-4434-9089-5ebfe38d6fd8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Search services should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Search\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Search/searchServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b4330a05-a843-4bc8-bf9a-cacce50c67f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Sockets state for an API App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an API app must be carefully reviewed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DisableWebSockets\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b48334a4-911b-4084-b1ab-3e6a4e50b951\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Service Fabric clusters should only use Azure Active Directory for client authentication\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit usage of client authentication only via Azure Active Directory in Service Fabric\",\r\n        \"metadata\": {\r\n          \"category\": \"Service Fabric\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ServiceFabric/clusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\",\r\n                    \"equals\": \"\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b54ed75b-3e1a-44ac-a333-05ba39b99ff0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in App Services should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit enabling of diagnostic logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/detailedErrorLoggingEnabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/httpLoggingEnabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/requestTracingEnabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs in which the Administrators group does not contain only the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group does not contain only the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"Members\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members\",\r\n              \"description\": \"A semicolon-separated list of all the expected members of the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembers\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;Members', '=', parameters('Members')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AdministratorsGroupMembers\"\r\n                    },\r\n                    \"Members\": {\r\n                      \"value\": \"[parameters('Members')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"Members\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;Members\",\r\n                                \"value\": \"[parameters('Members')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b821191b-3a12-44bc-9c38-212138a29ff3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b821191b-3a12-44bc-9c38-212138a29ff3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported Python Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPython\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bc0378bb-d7ab-4614-a0f6-5a6e3f02d644\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: IP Forwarding on your virtual machine should be disabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enabling IP forwarding on a virtual machine's NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"disableIPForwarding\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bd352bd5-2853-4985-bf0d-73806b4a5744\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL managed instance Advanced Data Security settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/disabledAlerts[*]\",\r\n                \"equals\": \"\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bda18df3-5e41-4709-add9-2554ce68c966\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs in which the Administrators group contains any of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines in which the Administrators group contains any of the specified members. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"AdministratorsGroupMembersToExclude\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bde62c94-ccca-4821-a815-92c1d31a76de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Java Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported Java version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestJava\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"be0a7681-bed4-48dc-9ff3-f0171ee170b6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Asia data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation in the following locations only: East Asia, Southeast Asia, West India, South India, Central India, Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"eastasia\",\r\n                \"southeastasia\",\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\",\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs that are not set to the specified time zone\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not set to the specified time zone. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"TimeZone\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Time zone\",\r\n              \"description\": \"The expected time zone\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"(UTC-12:00) International Date Line West\",\r\n              \"(UTC-11:00) Coordinated Universal Time-11\",\r\n              \"(UTC-10:00) Aleutian Islands\",\r\n              \"(UTC-10:00) Hawaii\",\r\n              \"(UTC-09:30) Marquesas Islands\",\r\n              \"(UTC-09:00) Alaska\",\r\n              \"(UTC-09:00) Coordinated Universal Time-09\",\r\n              \"(UTC-08:00) Baja California\",\r\n              \"(UTC-08:00) Coordinated Universal Time-08\",\r\n              \"(UTC-08:00) Pacific Time (US & Canada)\",\r\n              \"(UTC-07:00) Arizona\",\r\n              \"(UTC-07:00) Chihuahua, La Paz, Mazatlan\",\r\n              \"(UTC-07:00) Mountain Time (US & Canada)\",\r\n              \"(UTC-06:00) Central America\",\r\n              \"(UTC-06:00) Central Time (US & Canada)\",\r\n              \"(UTC-06:00) Easter Island\",\r\n              \"(UTC-06:00) Guadalajara, Mexico City, Monterrey\",\r\n              \"(UTC-06:00) Saskatchewan\",\r\n              \"(UTC-05:00) Bogota, Lima, Quito, Rio Branco\",\r\n              \"(UTC-05:00) Chetumal\",\r\n              \"(UTC-05:00) Eastern Time (US & Canada)\",\r\n              \"(UTC-05:00) Haiti\",\r\n              \"(UTC-05:00) Havana\",\r\n              \"(UTC-05:00) Indiana (East)\",\r\n              \"(UTC-05:00) Turks and Caicos\",\r\n              \"(UTC-04:00) Asuncion\",\r\n              \"(UTC-04:00) Atlantic Time (Canada)\",\r\n              \"(UTC-04:00) Caracas\",\r\n              \"(UTC-04:00) Cuiaba\",\r\n              \"(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\",\r\n              \"(UTC-04:00) Santiago\",\r\n              \"(UTC-03:30) Newfoundland\",\r\n              \"(UTC-03:00) Araguaina\",\r\n              \"(UTC-03:00) Brasilia\",\r\n              \"(UTC-03:00) Cayenne, Fortaleza\",\r\n              \"(UTC-03:00) City of Buenos Aires\",\r\n              \"(UTC-03:00) Greenland\",\r\n              \"(UTC-03:00) Montevideo\",\r\n              \"(UTC-03:00) Punta Arenas\",\r\n              \"(UTC-03:00) Saint Pierre and Miquelon\",\r\n              \"(UTC-03:00) Salvador\",\r\n              \"(UTC-02:00) Coordinated Universal Time-02\",\r\n              \"(UTC-02:00) Mid-Atlantic - Old\",\r\n              \"(UTC-01:00) Azores\",\r\n              \"(UTC-01:00) Cabo Verde Is.\",\r\n              \"(UTC) Coordinated Universal Time\",\r\n              \"(UTC+00:00) Dublin, Edinburgh, Lisbon, London\",\r\n              \"(UTC+00:00) Monrovia, Reykjavik\",\r\n              \"(UTC+00:00) Sao Tome\",\r\n              \"(UTC+01:00) Casablanca\",\r\n              \"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\",\r\n              \"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\",\r\n              \"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris\",\r\n              \"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb\",\r\n              \"(UTC+01:00) West Central Africa\",\r\n              \"(UTC+02:00) Amman\",\r\n              \"(UTC+02:00) Athens, Bucharest\",\r\n              \"(UTC+02:00) Beirut\",\r\n              \"(UTC+02:00) Cairo\",\r\n              \"(UTC+02:00) Chisinau\",\r\n              \"(UTC+02:00) Damascus\",\r\n              \"(UTC+02:00) Gaza, Hebron\",\r\n              \"(UTC+02:00) Harare, Pretoria\",\r\n              \"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\",\r\n              \"(UTC+02:00) Jerusalem\",\r\n              \"(UTC+02:00) Kaliningrad\",\r\n              \"(UTC+02:00) Khartoum\",\r\n              \"(UTC+02:00) Tripoli\",\r\n              \"(UTC+02:00) Windhoek\",\r\n              \"(UTC+03:00) Baghdad\",\r\n              \"(UTC+03:00) Istanbul\",\r\n              \"(UTC+03:00) Kuwait, Riyadh\",\r\n              \"(UTC+03:00) Minsk\",\r\n              \"(UTC+03:00) Moscow, St. Petersburg\",\r\n              \"(UTC+03:00) Nairobi\",\r\n              \"(UTC+03:30) Tehran\",\r\n              \"(UTC+04:00) Abu Dhabi, Muscat\",\r\n              \"(UTC+04:00) Astrakhan, Ulyanovsk\",\r\n              \"(UTC+04:00) Baku\",\r\n              \"(UTC+04:00) Izhevsk, Samara\",\r\n              \"(UTC+04:00) Port Louis\",\r\n              \"(UTC+04:00) Saratov\",\r\n              \"(UTC+04:00) Tbilisi\",\r\n              \"(UTC+04:00) Volgograd\",\r\n              \"(UTC+04:00) Yerevan\",\r\n              \"(UTC+04:30) Kabul\",\r\n              \"(UTC+05:00) Ashgabat, Tashkent\",\r\n              \"(UTC+05:00) Ekaterinburg\",\r\n              \"(UTC+05:00) Islamabad, Karachi\",\r\n              \"(UTC+05:00) Qyzylorda\",\r\n              \"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi\",\r\n              \"(UTC+05:30) Sri Jayawardenepura\",\r\n              \"(UTC+05:45) Kathmandu\",\r\n              \"(UTC+06:00) Astana\",\r\n              \"(UTC+06:00) Dhaka\",\r\n              \"(UTC+06:00) Omsk\",\r\n              \"(UTC+06:30) Yangon (Rangoon)\",\r\n              \"(UTC+07:00) Bangkok, Hanoi, Jakarta\",\r\n              \"(UTC+07:00) Barnaul, Gorno-Altaysk\",\r\n              \"(UTC+07:00) Hovd\",\r\n              \"(UTC+07:00) Krasnoyarsk\",\r\n              \"(UTC+07:00) Novosibirsk\",\r\n              \"(UTC+07:00) Tomsk\",\r\n              \"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi\",\r\n              \"(UTC+08:00) Irkutsk\",\r\n              \"(UTC+08:00) Kuala Lumpur, Singapore\",\r\n              \"(UTC+08:00) Perth\",\r\n              \"(UTC+08:00) Taipei\",\r\n              \"(UTC+08:00) Ulaanbaatar\",\r\n              \"(UTC+08:45) Eucla\",\r\n              \"(UTC+09:00) Chita\",\r\n              \"(UTC+09:00) Osaka, Sapporo, Tokyo\",\r\n              \"(UTC+09:00) Pyongyang\",\r\n              \"(UTC+09:00) Seoul\",\r\n              \"(UTC+09:00) Yakutsk\",\r\n              \"(UTC+09:30) Adelaide\",\r\n              \"(UTC+09:30) Darwin\",\r\n              \"(UTC+10:00) Brisbane\",\r\n              \"(UTC+10:00) Canberra, Melbourne, Sydney\",\r\n              \"(UTC+10:00) Guam, Port Moresby\",\r\n              \"(UTC+10:00) Hobart\",\r\n              \"(UTC+10:00) Vladivostok\",\r\n              \"(UTC+10:30) Lord Howe Island\",\r\n              \"(UTC+11:00) Bougainville Island\",\r\n              \"(UTC+11:00) Chokurdakh\",\r\n              \"(UTC+11:00) Magadan\",\r\n              \"(UTC+11:00) Norfolk Island\",\r\n              \"(UTC+11:00) Sakhalin\",\r\n              \"(UTC+11:00) Solomon Is., New Caledonia\",\r\n              \"(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky\",\r\n              \"(UTC+12:00) Auckland, Wellington\",\r\n              \"(UTC+12:00) Coordinated Universal Time+12\",\r\n              \"(UTC+12:00) Fiji\",\r\n              \"(UTC+12:00) Petropavlovsk-Kamchatsky - Old\",\r\n              \"(UTC+12:45) Chatham Islands\",\r\n              \"(UTC+13:00) Coordinated Universal Time+13\",\r\n              \"(UTC+13:00) Nuku'alofa\",\r\n              \"(UTC+13:00) Samoa\",\r\n              \"(UTC+14:00) Kiritimati Island\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsTimeZone\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[WindowsTimeZone]WindowsTimeZone1;TimeZone', '=', parameters('TimeZone')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsTimeZone\"\r\n                    },\r\n                    \"TimeZone\": {\r\n                      \"value\": \"[parameters('TimeZone')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"TimeZone\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[WindowsTimeZone]WindowsTimeZone1;TimeZone\",\r\n                                \"value\": \"[parameters('TimeZone')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c21f7060-c148-41cf-a68b-0ab3e14c764c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines on which the specified services are not installed and 'Running'. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsServiceStatus\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"System updates on virtual machine scale sets should be installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit whether there are any missing system security updates and critical updates that should be installed to ensure that your Windows and Linux virtual machine scale sets are secure.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"SystemUpdates\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c3f317a7-a95c-4547-b7e7-11017ebdf2fe\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Linux VMs that have accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Linux virtual machines that have accounts without passwords. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"PasswordPolicy_msid232\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c40c9087-1981-4e73-9f53-39743eda9d05\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that contain certificates expiring within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that contain certificates expiring within the specified number of days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"CertificateStorePath\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate store path\",\r\n              \"description\": \"The path to the certificate store containing the certificates to check the expiration dates of. Default value is 'Cert:' which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: 'Cert:\\\\LocalMachine', 'Cert:\\\\LocalMachine\\\\TrustedPublisher', 'Cert:\\\\CurrentUser'\"\r\n            },\r\n            \"defaultValue\": \"Cert:\"\r\n          },\r\n          \"ExpirationLimitInDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expiration limit in days\",\r\n              \"description\": \"An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\"\r\n            },\r\n            \"defaultValue\": \"30\"\r\n          },\r\n          \"CertificateThumbprintsToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to include\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"CertificateThumbprintsToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to exclude\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"IncludeExpiredCertificates\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include expired certificates\",\r\n              \"description\": \"Must be 'true' or 'false'. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"CertificateExpiration\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateStorePath', '=', parameters('CertificateStorePath'), ',', '[CertificateStore]CertificateStore1;ExpirationLimitInDays', '=', parameters('ExpirationLimitInDays'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprintsToInclude'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude', '=', parameters('CertificateThumbprintsToExclude'), ',', '[CertificateStore]CertificateStore1;IncludeExpiredCertificates', '=', parameters('IncludeExpiredCertificates')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"CertificateExpiration\"\r\n                    },\r\n                    \"CertificateStorePath\": {\r\n                      \"value\": \"[parameters('CertificateStorePath')]\"\r\n                    },\r\n                    \"ExpirationLimitInDays\": {\r\n                      \"value\": \"[parameters('ExpirationLimitInDays')]\"\r\n                    },\r\n                    \"CertificateThumbprintsToInclude\": {\r\n                      \"value\": \"[parameters('CertificateThumbprintsToInclude')]\"\r\n                    },\r\n                    \"CertificateThumbprintsToExclude\": {\r\n                      \"value\": \"[parameters('CertificateThumbprintsToExclude')]\"\r\n                    },\r\n                    \"IncludeExpiredCertificates\": {\r\n                      \"value\": \"[parameters('IncludeExpiredCertificates')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"CertificateStorePath\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExpirationLimitInDays\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"CertificateThumbprintsToInclude\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"CertificateThumbprintsToExclude\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"IncludeExpiredCertificates\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateStorePath\",\r\n                                \"value\": \"[parameters('CertificateStorePath')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;ExpirationLimitInDays\",\r\n                                \"value\": \"[parameters('ExpirationLimitInDays')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprintsToInclude')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprintsToExclude')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;IncludeExpiredCertificates\",\r\n                                \"value\": \"[parameters('IncludeExpiredCertificates')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"API App should only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"OnlyHttpsForApiApp\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Data Lake Analytics should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeAnalytics/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c95c74d9-38fe-4f0d-af86-0c7d626a315c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs with a pending reboot\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with a pending reboot. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsPendingReboot\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsPendingReboot\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c96f3246-4382-4264-bf6b-af0b35e23c3c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Network Security Groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy automatically deploys diagnostic settings to network security groups. A storage account with name '{storagePrefixParameter}{NSGLocation}' will be automatically created.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"storagePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage Account Prefix for Regional Storage Account\",\r\n              \"description\": \"This prefix will be combined with the network security group location to form the created storage account name.\"\r\n            }\r\n          },\r\n          \"rgName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Group Name for Storage Account (must exist)\",\r\n              \"description\": \"The resource group that the storage account will be created in. This resource group must already exist.\",\r\n              \"strongType\": \"ExistingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"setbypolicy\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storagePrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"rgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"storageDeployName\": \"[concat('policyStorage_', uniqueString(parameters('location'), parameters('nsgName')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\",\r\n                        \"name\": \"[concat(parameters('nsgName'),'/Microsoft.Insights/setbypolicy')]\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [\r\n                          \"[variables('storageDeployName')]\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"storageAccountId\": \"[reference(variables('storageDeployName')).outputs.storageAccountId.value]\",\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupEvent\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            },\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupRuleCounter\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[variables('storageDeployName')]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('rgName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storagePrefix\": {\r\n                              \"value\": \"[parameters('storagePrefix')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"storagePrefix\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"apiVersion\": \"2017-06-01\",\r\n                                \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                                \"name\": \"[concat(parameters('storageprefix'), parameters('location'))]\",\r\n                                \"sku\": {\r\n                                  \"name\": \"Standard_LRS\",\r\n                                  \"tier\": \"Standard\"\r\n                                },\r\n                                \"kind\": \"Storage\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"tags\": {\r\n                                  \"created-by\": \"policy\"\r\n                                },\r\n                                \"scale\": null,\r\n                                \"properties\": {\r\n                                  \"networkAcls\": {\r\n                                    \"bypass\": \"AzureServices\",\r\n                                    \"defaultAction\": \"Allow\",\r\n                                    \"ipRules\": [],\r\n                                    \"virtualNetworkRules\": []\r\n                                  },\r\n                                  \"supportsHttpsTrafficOnly\": true\r\n                                }\r\n                              }\r\n                            ],\r\n                            \"outputs\": {\r\n                              \"storageAccountId\": {\r\n                                \"type\": \"string\",\r\n                                \"value\": \"[resourceId(parameters('rgName'), 'Microsoft.Storage/storageAccounts',concat(parameters('storagePrefix'), parameters('location')))]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"storagePrefix\": {\r\n                      \"value\": \"[parameters('storagePrefix')]\"\r\n                    },\r\n                    \"rgName\": {\r\n                      \"value\": \"[parameters('rgName')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Remote debugging should be turned off for Web Application\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Remote debugging requires inbound ports to be opened on a web application.  Remote debugging should be turned off.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoteDebuggingForWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb510bfd-1cba-4d9f-a230-cb0976f4bb71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain only the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines in which the Administrators group does not contain only the specified members. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"AdministratorsGroupMembers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cc7cda28-f867-4311-8497-a526129a8d19\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cc7cda28-f867-4311-8497-a526129a8d19\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Sensitive data in your SQL databases should be classified\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Security Center monitors the data discovery and classification scan results for your SQL databases and provides recommendations to classify the sensitive data in your databases for better monitoring and security\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/managedInstances/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"sqlDataClassification\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed virtual machine SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to specify a set of virtual machine SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for virtual machines.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"VMSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cccc23c7-8427-4f53-ad12-b6a63eb452b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'department' tag set\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation only if the 'department' tag is set\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags\",\r\n              \"containsKey\": \"department\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cd8dc879-a2ae-43c3-8211-1877c5755064\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that allow re-use of the previous 24 passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that allow re-use of the previous 24 passwords. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"EnforcePasswordHistory\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cdbf72d9-ac9c-4026-8a3a-491a5ac59293\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Key Vault should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.KeyVault/vaults\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cf820ca0-f99e-4f3e-84fb-66e913812d21\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Function Apps that are not using custom domains\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of custom domains protects a Function app from common attacks such as phishing and other DNS-related attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UsedCustomDomains\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d1cb47db-b7a1-4c46-814e-aad1c0e84f3c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs on which the DSC configuration is not compliant\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDscConfiguration\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsDscConfiguration\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d38b4c26-9d2e-47d7-aefe-18d859a8706a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows Server VMs on which Windows Serial Console is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows Server virtual machines on which Windows Serial Console is not enabled. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsSerialConsole\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d7ccd0ca-8d78-42af-a43d-6b7f928accbc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using custom domains\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of custom domains protects a web application from common attacks such as phishing and other DNS-related attacks.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UsedCustomDomains\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dd2ea520-6b06-45c3-806e-ea297c23e06a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e01598e8-6538-41ed-95e8-8b29746cd697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerabilities in security configuration on your machines should be remediated\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"osVulnerabilities\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Dependency Agent Deployment in VMSS - VM Image (OS) unlisted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMSS as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"12-SP2\",\r\n                                \"12-SP3\",\r\n                                \"12-SP4\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"14.04.0-LTS\",\r\n                                \"14.04.1-LTS\",\r\n                                \"14.04.5-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"16.04-LTS\",\r\n                                \"16.04.0-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"18.04-LTS\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"Centos\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e2dd799a-a932-4e9d-ac17-d473bc3c6c10\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MFA should be enabled on accounts with read permissions on your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with read privileges to prevent a breach of accounts or resources.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"EnableMFAForReadPermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e3576e28-8b17-4677-84c3-db2990658d64\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"global\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"notEquals\": \"Microsoft.AzureActiveDirectory/b2cDirectories\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e56962a6-4747-49cd-b67b-bf8b01975c4c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Node.js Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported Node.js version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestNodeJS\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e67687e8-08d5-4e7f-8226-5b4753bba008\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subnets should be associated with a Network Security Group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Protect your subnet from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your subnet.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"networkSecurityGroupsOnSubnets\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e71308d3-144b-4262-b144-efdc3cc90517\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL server Advanced Data Security settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/servers/securityAlertPolicies/disabledAlerts[*]\",\r\n                \"equals\": \"\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e756b945-1b1b-480b-8de8-9a0859d5f7ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations for resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e765b5de-1225-4ba3-bd56-1ac6695af988\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Sockets state for a Web Application\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within a web application must be carefully reviewed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true,\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DisableWebSockets\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e797f851-8be7-4c40-bb56-2e3395215b0e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Remote debugging should be turned off for API App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Remote debugging requires inbound ports to be opened on an API app.  Remote debugging should be turned off.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoteDebuggingForApiApp\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deprecated accounts with owner permissions should be removed from your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deprecated accounts with owner permissions should be removed from your subscription.  Deprecated accounts are accounts that have been blocked from signing in.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoveDeprecatedAccountsWithOwnerPermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ebb62a0c-3560-49e1-89ed-27e074e9f8ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Linux VMs that allow remote connections from accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that allow remote connections from accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"AzureDatabricks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"RHEL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"osa\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordPolicy_msid110\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"PasswordPolicy_msid110\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ec49586f-4939-402d-a29e-6ff502b20592\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Key Vault to Event Hub\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Key Vault to stream to a regional Event Hub when any Key Vault which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy\"\r\n          },\r\n          \"eventHubRuleId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Event Hub Authorization Rule Id\",\r\n              \"description\": \"The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\",\r\n              \"strongType\": \"Microsoft.EventHub/Namespaces/AuthorizationRules\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Event Hub - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Event Hub  - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.KeyVault/vaults\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vaultName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"eventHubRuleId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.KeyVault/vaults/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"eventHubAuthorizationRuleId\": \"[parameters('eventHubRuleId')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"AuditEvent\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled diagnostic settings for ', parameters('vaultName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"vaultName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"eventHubRuleId\": {\r\n                      \"value\": \"[parameters('eventHubRuleId')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ed7c8c13-51e7-49d1-8a43-8490431a0da2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability assessment should be enabled on your SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit Azure SQL servers which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/servers/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n                \"equals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy requirements to audit Windows VMs that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"NotInstalledApplication\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[InstalledApplication]NotInstalledApplicationResource1;Name', '=', parameters('ApplicationName')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"NotInstalledApplication\"\r\n                    },\r\n                    \"ApplicationName\": {\r\n                      \"value\": \"[parameters('ApplicationName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ApplicationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[InstalledApplication]NotInstalledApplicationResource1;Name\",\r\n                                \"value\": \"[parameters('ApplicationName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f0633351-c7b2-41ff-9981-508fc08553c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Linux VMs that do not have the passwd file permissions set to 0644\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the passwd file permissions set to 0644. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"AzureDatabricks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"RHEL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"osa\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordPolicy_msid121\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"PasswordPolicy_msid121\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f19aa1c1-6b91-4c27-ae6a-970279f03db9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain all of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines in which the Administrators group does not contain all of the specified members. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"AdministratorsGroupMembersToInclude\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f3b44e5d-1456-475f-9c67-c66c4618e85a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsCertificateInTrustedRoot\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f3b9ad83-000d-4dc1-bff0-6d54533dd03f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Log Analytics Workspace for VM - Report Mismatch\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMs as non-compliant if they not logging to the LA workspace specified in the policy/initiative assignment.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalyticsWorkspaceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics Workspace Id that VMs should be configured for\",\r\n              \"description\": \"This is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured for.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/settings.workspaceId\",\r\n                \"notEquals\": \"[parameters('logAnalyticsWorkspaceId')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f47b5582-33ec-4c5c-87c0-b010a6b2e917\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Authorization rules on the Event Hub instance should be defined\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit existence of authorization rules on Event Hub entities to grant least-privileged access\",\r\n        \"metadata\": {\r\n          \"category\": \"Event Hub\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.EventHub/namespaces/eventhubs\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.EventHub/namespaces/eventHubs/authorizationRules\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f4826e5f-6a27-407c-ae3e-9582eb39891d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not have the password complexity setting enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Windows virtual machines that do not have the password complexity setting enabled. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"PasswordMustMeetComplexityRequirements\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f48b2913-1dc5-4834-8c72-ccc1dfd819bb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that have not restarted within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that have not restarted within the specified number of days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ]\r\n        },\r\n        \"parameters\": {\r\n          \"NumberOfDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Number of days\",\r\n              \"description\": \"The number of days without restart until the machine is considered non-compliant\"\r\n            },\r\n            \"defaultValue\": \"12\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MachineLastBootUpTime\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[MachineUpTime]MachineLastBootUpTime;NumberOfDays', '=', parameters('NumberOfDays')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MachineLastBootUpTime\"\r\n                    },\r\n                    \"NumberOfDays\": {\r\n                      \"value\": \"[parameters('NumberOfDays')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NumberOfDays\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[MachineUpTime]MachineLastBootUpTime;NumberOfDays\",\r\n                                \"value\": \"[parameters('NumberOfDays')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2015-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f4b245d4-46c9-42be-9b1a-49e2b5b94194\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Auditing on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures that Auditing is enabled on SQL Servers for enhanced security and compliance. It will automatically create a storage account in the same region as the SQL server to store audit records.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"The value in days of the retention period (0 indicates unlimited retention)\",\r\n              \"displayName\": \"Retention days (optional, 180 days if unspecified)\"\r\n            },\r\n            \"defaultValue\": \"180\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource group name for storage accounts\",\r\n              \"description\": \"Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"auditRetentionDays\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storageAccountsResourceGroup\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"retentionDays\": \"[int(parameters('auditRetentionDays'))]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), parameters('location'), parameters('storageAccountsResourceGroup'))]\",\r\n                      \"locationCode\": \"[substring(parameters('location'), 0, 3)]\",\r\n                      \"storageName\": \"[tolower(concat('sqlaudit', variables('locationCode'), variables('uniqueStorage')))]\",\r\n                      \"createStorageAccountDeploymentName\": \"[concat('sqlServerAuditingStorageAccount-', uniqueString(variables('locationCode'), parameters('serverName')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[variables('createStorageAccountDeploymentName')]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('storageAccountsResourceGroup')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storageName\": {\r\n                              \"value\": \"[variables('storageName')]\"\r\n                            }\r\n                          },\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"storageEndpoint\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountEndPoint.value]\",\r\n                          \"storageAccountAccessKey\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountKey.value]\",\r\n                          \"retentionDays\": \"[variables('retentionDays')]\",\r\n                          \"auditActionsAndGroups\": null,\r\n                          \"storageAccountSubscriptionId\": \"[subscription().subscriptionId]\",\r\n                          \"isStorageSecondaryKeyInUse\": false\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"auditRetentionDays\": {\r\n                      \"value\": \"[parameters('retentionDays')]\"\r\n                    },\r\n                    \"storageAccountsResourceGroup\": {\r\n                      \"value\": \"[parameters('storageAccountsResourceGroup')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f4c68484-132f-41f9-9b6d-3e4b1cb55036\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Virtual machines should be associated with a Network Security Group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Protect your VM from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your VM from other instances, in or outside the same subnet.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"networkSecurityGroupsOnVirtualMachines\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"Monitored\",\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"External accounts with owner permissions should be removed from your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"External accounts with owner permissions should be removed from your subscription in order to prevent unmonitored access.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"RemoveExternalAccountsWithOwnerPermissions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f8456c1c-aa66-4dfb-861a-25d127b775c9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Service Bus should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Service Bus\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f8d36e2f-389b-4ee4-898d-21aeb69a0f45\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Azure Stream Analytics should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"category\": \"Stream Analytics\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.StreamAnalytics/streamingJobs\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                        \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                          \"equals\": \"true\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                        \"equals\": \"true\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f9be5368-9bf5-4b84-9e0a-7850da98bb46\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Kubernetes Services should be upgraded to a non-vulnerable Kubernetes version\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Upgrade your Kubernetes service cluster to a later Kubernetes version to protect against known vulnerabilities in your current Kubernetes version. Vulnerability CVE-2019-9946 has been patched in Kubernetes versions 1.11.9+, 1.12.7+, 1.13.5+, and 1.14.0+\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"in\": [\r\n                      \"1.13.4\",\r\n                      \"1.13.3\",\r\n                      \"1.13.2\",\r\n                      \"1.13.1\",\r\n                      \"1.13.0\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"in\": [\r\n                      \"1.12.6\",\r\n                      \"1.12.5\",\r\n                      \"1.12.4\",\r\n                      \"1.12.3\",\r\n                      \"1.12.2\",\r\n                      \"1.12.1\",\r\n                      \"1.12.0\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"in\": [\r\n                      \"1.11.8\",\r\n                      \"1.11.7\",\r\n                      \"1.11.6\",\r\n                      \"1.11.5\",\r\n                      \"1.11.4\",\r\n                      \"1.11.3\",\r\n                      \"1.11.2\",\r\n                      \"1.11.1\",\r\n                      \"1.11.0\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.10.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.9.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.8.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.7.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.6.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.5.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.4.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.3.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.2.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.1.*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                    \"like\": \"1.0.*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/fb893a29-21bb-418c-a157-e99480ec364c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fb893a29-21bb-418c-a157-e99480ec364c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Linux VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits Linux virtual machines that do not have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"installed_application_linux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"notEquals\": \"Compliant\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fee5cb2b-9d9b-410e-afe3-2902d90d0004\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerabilities on your SQL databases should be remediated\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Monitor Vulnerability Assessment scan results and recommendations for how to remediate database vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/managedinstances/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"sqlVulnerabilityAssessment\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"feedbf84-6b99-488c-acc2-71c829aa5ffc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Ensure containers listen only on allowed ports in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy enforces containers to listen only on allowed ports in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedContainerPortsRegex\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed container ports regex\",\r\n              \"description\": \"Regex representing container ports allowed in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"ContainerAllowedPorts\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-ports/limited-preview/gatekeeperpolicy.rego\",\r\n              \"policyParameters\": {\r\n                \"allowedContainerPortsRegex\": \"[parameters('allowedContainerPortsRegex')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f636243-1b1c-4d50-880f-310f6199f2cb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f636243-1b1c-4d50-880f-310f6199f2cb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Enforce labels on pods in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy enforces the specified labels are provided for pods in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"commaSeparatedListOfLabels\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Comma-separated list of labels\",\r\n              \"description\": \"A comma-separated list of labels to be specified on Pods in Kubernetes cluster. E.g. test1,test2\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"PodEnforceLabels\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/pod-enforce-labels/limited-preview/gatekeeperpolicy.rego\",\r\n              \"policyParameters\": {\r\n                \"commaSeparatedListOfLabels\": \"[parameters('commaSeparatedListOfLabels')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16c6ca72-89d2-4798-b87e-496f9de7fcb7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16c6ca72-89d2-4798-b87e-496f9de7fcb7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Ensure services listen only on allowed ports in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy enforces services to listen only on allowed ports in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedServicePortsRegex\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed service ports regex\",\r\n              \"description\": \"Regex representing service ports allowed in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"ServiceAllowedPorts\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/service-allowed-ports/limited-preview/gatekeeperpolicy.rego\",\r\n              \"policyParameters\": {\r\n                \"allowedServicePortsRegex\": \"[parameters('allowedServicePortsRegex')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25dee3db-6ce0-4c02-ab5d-245887b24077\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25dee3db-6ce0-4c02-ab5d-245887b24077\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Enforce HTTPS ingress in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy enforces HTTPS ingress in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"HttpsIngressOnly\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-https-only/limited-preview/gatekeeperpolicy.rego\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fbff515-eecc-4b7e-9b63-fcc7138b7dc3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2fbff515-eecc-4b7e-9b63-fcc7138b7dc3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Ensure only allowed container images in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy ensures only allowed container images are running in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedContainerImagesRegex\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed container images regex\",\r\n              \"description\": \"Regex representing container images allowed in Kubernetes cluster. E.g. Regex of azure container registry images is ^.+azurecr.io/.+$\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"ContainerAllowedImages\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-images/limited-preview/gatekeeperpolicy.rego\",\r\n              \"policyParameters\": {\r\n                \"allowedContainerImagesRegex\": \"[parameters('allowedContainerImagesRegex')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5f86cb6e-c4da-441b-807c-44bd0cc14e66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5f86cb6e-c4da-441b-807c-44bd0cc14e66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Do not allow privileged containers in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy does not allow privileged containers creation in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"ContainerNoPrivilege\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-no-privilege/limited-preview/gatekeeperpolicy.rego\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7ce7ac02-a5c6-45d6-8d1b-844feb1c1531\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7ce7ac02-a5c6-45d6-8d1b-844feb1c1531\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Ensure CPU and memory resource limits defined on containers in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy ensures CPU and memory resource limits are defined on containers in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"ContainerResourceLimits\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-resource-limits/limited-preview/gatekeeperpolicy.rego\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a2d3ed81-8d11-4079-80a5-1faadc0024f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a2d3ed81-8d11-4079-80a5-1faadc0024f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Enforce internal load balancers in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy enforces load balancers do not have public IPs in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"LoadBalancersInternal\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/loadbalancer-no-publicips/limited-preview/gatekeeperpolicy.rego\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a74d8f00-2fd9-4ce4-968e-0ee1eb821698\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a74d8f00-2fd9-4ce4-968e-0ee1eb821698\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Limited Preview]: Enforce unique ingress hostnames across namespaces in AKS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Microsoft.ContainerService.Data\",\r\n        \"description\": \"This policy enforces unique ingress hostnames across namespaces in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"category\": \"Kubernetes service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"EnforceRegoPolicy\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"EnforceRegoPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"policyId\": \"UniqueIngressHostnames\",\r\n              \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-hostnames-conflict/limited-preview/gatekeeperpolicy.rego\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d011d9f7-ba32-4005-b727-b3d09371ca60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d011d9f7-ba32-4005-b727-b3d09371ca60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim single allowed location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed location\",\r\n              \"description\": \"The location that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"global\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"notEquals\": \"Microsoft.AzureActiveDirectory/b2cDirectories\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policyDefinitions/14bee682-2231-4113-bb3a-c067a49c6035\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"14bee682-2231-4113-bb3a-c067a49c6035\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"69108416-6ac7-4a4f-ac13-fee20ff1ee02\",\r\n          \"createdOn\": \"2019-06-28T00:42:23.9594435Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policyDefinitions/8a333d4f-45e8-4adf-b777-0f3be1fc4663\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8a333d4f-45e8-4adf-b777-0f3be1fc4663\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VMs with no Managed Disk\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deny all VMs with no Managed Disk\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.compute/virtualmachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.dataDisks[*].managedDisk.id\",\r\n                \"notlike\": \"*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policyDefinitions/95696b24-404f-4376-a9a6-7fa8ba91e4d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"95696b24-404f-4376-a9a6-7fa8ba91e4d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rohitbh def [2]\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"createdBy\": \"22ac4b8c-9194-4feb-b6c6-0e7a995fca2e\",\r\n          \"createdOn\": \"2019-04-30T23:58:47.6628901Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovTest5/providers/Microsoft.Authorization/policyDefinitions/5786a43d-b79a-4f5d-a7b8-b43925a693e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5786a43d-b79a-4f5d-a7b8-b43925a693e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure KeyVault Allowed Locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure KeyVault Allowed Locations\",\r\n        \"metadata\": {\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"in\": \"[parameters('allowedLocations')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovTest5/providers/Microsoft.Authorization/policyDefinitions/e1d7de9f-42f0-4af1-9ee0-0187bfce08d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e1d7de9f-42f0-4af1-9ee0-0187bfce08d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testDisplay\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Microsoft.KeyVault.Data\",\r\n        \"description\": \"Updated Unit test junk: sorry for littering. Please delete me!\",\r\n        \"metadata\": {\r\n          \"testName\": \"testValue\",\r\n          \"createdBy\": \"5549abd9-7aae-41fa-a276-5060abe448d5\",\r\n          \"createdOn\": \"2019-07-15T20:36:45.266863Z\",\r\n          \"updatedBy\": \"5549abd9-7aae-41fa-a276-5060abe448d5\",\r\n          \"updatedOn\": \"2019-07-15T20:36:46.9168436Z\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"Microsoft.KeyVault.Data/vaults/certificates/keyProperties/keyType\",\r\n            \"equals\": \"RSA\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policyDefinitions/ps4472\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps4472\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Microsoft.KeyVault.Data\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"5549abd9-7aae-41fa-a276-5060abe448d5\",\r\n          \"createdOn\": \"2019-07-15T20:15:59.703567Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"Microsoft.KeyVault.Data/vaults/certificates/keyProperties/keyType\",\r\n            \"equals\": \"RSA\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policyDefinitions/ps7414\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps7414\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Microsoft.KeyVault.Data\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"5549abd9-7aae-41fa-a276-5060abe448d5\",\r\n          \"createdOn\": \"2019-07-15T20:19:56.533839Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"Microsoft.KeyVault.Data/vaults/certificates/keyProperties/keyType\",\r\n            \"equals\": \"RSA\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policyDefinitions/ps8243\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps8243\"\r\n    }\r\n  ]\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wMDE1ZWE0ZC01MWZmLTRjZTMtOGQ4Yy1mM2Y4ZjAxNzlhNTY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9307ccbe-8c63-4fa7-b024-6992a2009103"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "90e8cd12-934f-4ada-8624-f08d052ce286"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205234Z:90e8cd12-934f-4ada-8624-f08d052ce286"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wMDE1ZWE0ZC01MWZmLTRjZTMtOGQ4Yy1mM2Y4ZjAxNzlhNTY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:555b2ed3-c1f7-43ee-aa6f-83cf19e6af0c"
        ],
        "x-ms-correlation-request-id": [
          "d5f12898-83c4-432d-8c81-dad185e4e9ce"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205234Z:d5f12898-83c4-432d-8c81-dad185e4e9ce"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:34 GMT"
        ],
        "Content-Length": [
          "796"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit virtual machines without disaster recovery configured\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"auditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Resources/links\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"name\",\r\n            \"like\": \"ASR-Protect-*\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wMDE4MDJkMS00OTY5LTRjODItYTcwMC1jMjljNmM2ZjliYmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d5506219-145c-43ff-a2f9-9be1657edefb"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "69b75a5b-bf2c-476c-abc2-19053cb6e1ed"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205234Z:69b75a5b-bf2c-476c-abc2-19053cb6e1ed"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:33 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '001802d1-4969-4c82-a700-c29c6c6f9bbd' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wMDE4MDJkMS00OTY5LTRjODItYTcwMC1jMjljNmM2ZjliYmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:bc7eed08-5be6-4dda-b4a9-364ec3a9b276"
        ],
        "x-ms-correlation-request-id": [
          "9bb5a813-adb7-436e-8ffb-14c905836bd8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205234Z:9bb5a813-adb7-436e-8ffb-14c905836bd8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:34 GMT"
        ],
        "Content-Length": [
          "1287"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Sockets state for a Function App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an Function app must be carefully reviewed.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"DisableWebSockets\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"001802d1-4969-4c82-a700-c29c6c6f9bbd\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/048248b0-55cd-46da-b1ff-39efd52db260?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNDgyNDhiMC01NWNkLTQ2ZGEtYjFmZi0zOWVmZDUyZGIyNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d79ba76e-febb-411b-a43a-7e7a3b92034c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "bbd5babf-8ff4-4274-a7ce-5de82ee56044"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:bbd5babf-8ff4-4274-a7ce-5de82ee56044"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '048248b0-55cd-46da-b1ff-39efd52db260' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/048248b0-55cd-46da-b1ff-39efd52db260?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNDgyNDhiMC01NWNkLTQ2ZGEtYjFmZi0zOWVmZDUyZGIyNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "732092eb-2eb2-495b-bd76-a5e7da4b1bcb"
        ],
        "x-ms-request-id": [
          "westus:9e3925e8-c5dc-4d16-a9ec-3904ba9dd0c3"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:732092eb-2eb2-495b-bd76-a5e7da4b1bcb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:34 GMT"
        ],
        "Content-Length": [
          "1341"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"SQL managed instance TDE protector should be encrypted with your own key\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Transparent Data Encryption (TDE) with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/managedInstances\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/managedInstances/encryptionProtector\",\r\n          \"name\": \"current\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType\",\r\n                \"equals\": \"AzureKeyVault\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                \"notEquals\": \"\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"048248b0-55cd-46da-b1ff-39efd52db260\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/053d3325-282c-4e5c-b944-24faffd30d77?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNTNkMzMyNS0yODJjLTRlNWMtYjk0NC0yNGZhZmZkMzBkNzc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:10bdc0c4-297f-4985-b398-249b4c384225"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "80f7a1e2-cf69-4a71-99af-142cd5784947"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:80f7a1e2-cf69-4a71-99af-142cd5784947"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '053d3325-282c-4e5c-b944-24faffd30d77' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/053d3325-282c-4e5c-b944-24faffd30d77?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNTNkMzMyNS0yODJjLTRlNWMtYjk0NC0yNGZhZmZkMzBkNzc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:12111d68-ed6a-4d25-96a2-e164d0761b57"
        ],
        "x-ms-correlation-request-id": [
          "9c19d439-2ed0-4e6c-9725-95136cbf1e39"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:9c19d439-2ed0-4e6c-9725-95136cbf1e39"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "4955"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Linux VMs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Log Analytics Agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\",\r\n          \"assignPermissions\": true\r\n        }\r\n      },\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"RHEL\",\r\n                      \"RHEL-SAP-HANA\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"SUSE\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"SLES\",\r\n                      \"SLES-HPC\",\r\n                      \"SLES-HPC-Priority\",\r\n                      \"SLES-SAP\",\r\n                      \"SLES-SAP-BYOS\",\r\n                      \"SLES-Priority\",\r\n                      \"SLES-BYOS\",\r\n                      \"SLES-SAPCAL\",\r\n                      \"SLES-Standard\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"12*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"14.04*LTS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"16.04*LTS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"18.04*LTS\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Oracle\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Oracle-Linux\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7.*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"CentOS\",\r\n                      \"Centos-LVM\",\r\n                      \"CentOS-SRIOV\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"like\": \"7*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"OmsAgentForLinux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                \"equals\": \"Succeeded\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logAnalytics\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"MMAExtension\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                  \"vmExtensionType\": \"OmsAgentForLinux\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"1.7\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {\r\n                        \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                        \"stopOnMultipleConnections\": \"true\"\r\n                      },\r\n                      \"protectedSettings\": {\r\n                        \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                      }\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"logAnalytics\": {\r\n                  \"value\": \"[parameters('logAnalytics')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"053d3325-282c-4e5c-b944-24faffd30d77\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNTdlZjI3ZS02NjVlLTQzMjgtOGVhMy0wNGIzMTIyYmQ5ZmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:af4e9410-cf81-4533-a3a2-df35a2e6fbf0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "f99f226b-6387-4a0b-b44d-9b06e4102f05"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:f99f226b-6387-4a0b-b44d-9b06e4102f05"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '057ef27e-665e-4328-8ea3-04b3122bd9fb' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNTdlZjI3ZS02NjVlLTQzMjgtOGVhMy0wNGIzMTIyYmQ5ZmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:0f3d9ff8-210f-4c58-b657-de6be731c88b"
        ],
        "x-ms-correlation-request-id": [
          "c4e2d39d-c606-4df1-a42f-3dc95d2a2e27"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:c4e2d39d-c606-4df1-a42f-3dc95d2a2e27"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "1693"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Azure Data Lake Store should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Data Lake\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"057ef27e-665e-4328-8ea3-04b3122bd9fb\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/06a78e20-9358-41c9-923c-fb736d382a12?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNmE3OGUyMC05MzU4LTQxYzktOTIzYy1mYjczNmQzODJhMTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f5408066-df2c-469d-b2a4-1f86ad729c8a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "6ae06f41-8b72-4b07-b043-f624f43f9358"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205235Z:6ae06f41-8b72-4b07-b043-f624f43f9358"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '06a78e20-9358-41c9-923c-fb736d382a12' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/06a78e20-9358-41c9-923c-fb736d382a12?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNmE3OGUyMC05MzU4LTQxYzktOTIzYy1mYjczNmQzODJhMTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:5b7c99d6-6dfd-4f30-8141-ea62ceeffe7e"
        ],
        "x-ms-correlation-request-id": [
          "79295dec-19c0-4b67-a9b2-d6dcd95a8480"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:79295dec-19c0-4b67-a9b2-d6dcd95a8480"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "902"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit SQL DB Level Audit Setting\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit DB level audit setting for SQL databases\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"setting\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Audit Setting\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"enabled\",\r\n          \"disabled\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"notEquals\": \"master\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"AuditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"[parameters('setting')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNmE3OGUyMC05MzU4LTQxYzktOTIzYy1mYjczNmQzODJhNGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:643f0f09-2d00-42ec-b060-c78d459b0c53"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "5876162e-0606-4b1e-aa9a-f8925ba7f9d4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:5876162e-0606-4b1e-aa9a-f8925ba7f9d4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '06a78e20-9358-41c9-923c-fb736d382a4d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/06a78e20-9358-41c9-923c-fb736d382a4d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wNmE3OGUyMC05MzU4LTQxYzktOTIzYy1mYjczNmQzODJhNGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:cba3d704-bbf1-4883-98b7-aa07bd0965f6"
        ],
        "x-ms-correlation-request-id": [
          "66fc9e21-bf3c-494c-9aef-6841778ca243"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:66fc9e21-bf3c-494c-9aef-6841778ca243"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "897"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit VMs that do not use managed disks\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits VMs that do not use managed disks\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"anyOf\": [\r\n          {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                \"exists\": \"True\"\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                    \"exists\": \"True\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wODIwYjdiOS0yM2FhLTQ3MjUtYTFjZS1hZTQ1NThmNzE4ZTU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5ce4ed4b-4ad4-424e-9ec9-a02a3297aefd"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "baa7a6b3-ab7c-45e6-ab16-138bf730fcb5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:baa7a6b3-ab7c-45e6-ab16-138bf730fcb5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:35 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0820b7b9-23aa-4725-a1ce-ae4558f718e5' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wODIwYjdiOS0yM2FhLTQ3MjUtYTFjZS1hZTQ1NThmNzE4ZTU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:de430f47-df36-4184-9909-078f24915abc"
        ],
        "x-ms-correlation-request-id": [
          "6f06189b-10b9-4975-a379-683d8fec679f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:6f06189b-10b9-4975-a379-683d8fec679f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:36 GMT"
        ],
        "Content-Length": [
          "1273"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CORS should not allow every resource to access your Function App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Cross origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"CorsRestrictionsForFunctionApp\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0820b7b9-23aa-4725-a1ce-ae4558f718e5\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wODY4NDYyZS02NDZjLTRmZTMtOWNlZC1hNzMzNTM0YjZhMmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6c7f491e-8abe-48f0-9f4b-905eaf3ac915"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "d89b3879-d7ac-4e5e-a626-0735ae08ddc1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:d89b3879-d7ac-4e5e-a626-0735ae08ddc1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:36 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0868462e-646c-4fe3-9ced-a733534b6a2c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wODY4NDYyZS02NDZjLTRmZTMtOWNlZC1hNzMzNTM0YjZhMmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:ec00d791-c179-4699-88a1-4e737c3b5a11"
        ],
        "x-ms-correlation-request-id": [
          "9d5f414e-1932-47b8-81ce-890cd02e378e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:9d5f414e-1932-47b8-81ce-890cd02e378e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:36 GMT"
        ],
        "Content-Length": [
          "5940"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Windows VMs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Log Analytics Agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\",\r\n          \"assignPermissions\": true\r\n        }\r\n      },\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"2008-R2-SP1\",\r\n                      \"2008-R2-SP1-smalldisk\",\r\n                      \"2012-Datacenter\",\r\n                      \"2012-Datacenter-smalldisk\",\r\n                      \"2012-R2-Datacenter\",\r\n                      \"2012-R2-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter\",\r\n                      \"2016-Datacenter-Server-Core\",\r\n                      \"2016-Datacenter-Server-Core-smalldisk\",\r\n                      \"2016-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter-with-Containers\",\r\n                      \"2016-Datacenter-with-RDSH\",\r\n                      \"2019-Datacenter\",\r\n                      \"2019-Datacenter-Core\",\r\n                      \"2019-Datacenter-Core-smalldisk\",\r\n                      \"2019-Datacenter-Core-with-Containers\",\r\n                      \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-smalldisk\",\r\n                      \"2019-Datacenter-with-Containers\",\r\n                      \"2019-Datacenter-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-zhcn\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerSemiAnnual\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"Datacenter-Core-1709-smalldisk\",\r\n                      \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                      \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerHPCPack\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016-BYOL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2-BYOL\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftRServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"MLServer-WS2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftVisualStudio\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"VisualStudio\",\r\n                      \"Windows\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftDynamicsAX\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Dynamics\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"windows-data-science-vm\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsDesktop\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Windows-10\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"MicrosoftMonitoringAgent\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                \"equals\": \"Succeeded\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logAnalytics\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"MMAExtension\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                  \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {\r\n                        \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                        \"stopOnMultipleConnections\": \"true\"\r\n                      },\r\n                      \"protectedSettings\": {\r\n                        \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                      }\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"logAnalytics\": {\r\n                  \"value\": \"[parameters('logAnalytics')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/08b17839-76c6-4015-90e0-33d9d54d219c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOGIxNzgzOS03NmM2LTQwMTUtOTBlMC0zM2Q5ZDU0ZDIxOWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:659989a7-a09b-4d7d-a929-0dd36d5b5b71"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "9b782bf7-4ad2-4d66-8815-ccf4aa88ca1f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205236Z:9b782bf7-4ad2-4d66-8815-ccf4aa88ca1f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:36 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '08b17839-76c6-4015-90e0-33d9d54d219c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/08b17839-76c6-4015-90e0-33d9d54d219c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOGIxNzgzOS03NmM2LTQwMTUtOTBlMC0zM2Q5ZDU0ZDIxOWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:813cd115-3dcc-4344-9f64-de07508a609f"
        ],
        "x-ms-correlation-request-id": [
          "44957095-2f6b-45d7-8ee5-b1f0e8214b59"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205237Z:44957095-2f6b-45d7-8ee5-b1f0e8214b59"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:36 GMT"
        ],
        "Content-Length": [
          "1312"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported PHP Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestPHP\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"08b17839-76c6-4015-90e0-33d9d54d219c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOGU2YWYyZC1kYjcwLTQ2MGEtYmZlOS1kNWJkNDc0YmE5ZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1690fb64-eee2-44f1-8b60-ab801243dc9e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "3c84e36a-5a0b-44a2-9dbc-2e7769bf751f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205237Z:3c84e36a-5a0b-44a2-9dbc-2e7769bf751f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '08e6af2d-db70-460a-bfe9-d5bd474ba9d6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOGU2YWYyZC1kYjcwLTQ2MGEtYmZlOS1kNWJkNDc0YmE5ZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:7725759d-1ef1-45f8-8e1c-b9a3300f4e09"
        ],
        "x-ms-correlation-request-id": [
          "b853b30c-1e92-43c4-800d-13caff4d205d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205237Z:b853b30c-1e92-43c4-800d-13caff4d205d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:36 GMT"
        ],
        "Content-Length": [
          "1167"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Network Security Group Rules for Internet facing virtual machines should be hardened\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Azure Security Center analyzes the traffic patterns of Internet facing virtual machines and provides Network Security Group rule recommendations that reduce the potential attack surface\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"adaptiveNetworkHardenings\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"08e6af2d-db70-460a-bfe9-d5bd474ba9d6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOTAyNGNjYy0wYzVmLTQ3NWUtOTQ1Ny1iN2MwZDllZDQ4N2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a23c6908-7251-4b4c-9e2f-1db53b6a3cf7"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "89018727-fd01-4038-91a6-f657d96b91a9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205237Z:89018727-fd01-4038-91a6-f657d96b91a9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '09024ccc-0c5f-475e-9457-b7c0d9ed487b' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOTAyNGNjYy0wYzVmLTQ3NWUtOTQ1Ny1iN2MwZDllZDQ4N2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:c5002abb-5bb9-4396-8968-a466c20b1b65"
        ],
        "x-ms-correlation-request-id": [
          "43035731-1c87-4eee-a790-67d85c801f60"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205237Z:43035731-1c87-4eee-a790-67d85c801f60"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "1072"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"There should be more than one owner assigned to your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"It is recommended to designate more than one subscription owner in order to have administrator access redundancy.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"DesignateMoreThanOneOwner\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"09024ccc-0c5f-475e-9457-b7c0d9ed487b\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0961003e-5a0a-4549-abde-af6a37f2724d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOTYxMDAzZS01YTBhLTQ1NDktYWJkZS1hZjZhMzdmMjcyNGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ef96212e-d01e-4da5-af30-9ca9cfbd39af"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "148aaeae-a53d-48e6-8d99-e8a28b571e58"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205237Z:148aaeae-a53d-48e6-8d99-e8a28b571e58"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0961003e-5a0a-4549-abde-af6a37f2724d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0961003e-5a0a-4549-abde-af6a37f2724d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wOTYxMDAzZS01YTBhLTQ1NDktYWJkZS1hZjZhMzdmMjcyNGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:49611c96-1281-464c-b78a-ccbb5f5ec4ac"
        ],
        "x-ms-correlation-request-id": [
          "418a1df7-1d01-440f-95fe-4ab2735a5744"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205238Z:418a1df7-1d01-440f-95fe-4ab2735a5744"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "1032"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Disk encryption should be applied on virtual machines\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"VMs without an enabled disk encryption will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"encryption\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0a914e76-4921-4c19-b460-a2d36003525a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wYTkxNGU3Ni00OTIxLTRjMTktYjQ2MC1hMmQzNjAwMzUyNWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9499bd10-89ae-4d92-affa-7d71e7e964fc"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "9dd8170b-a85e-44db-9bfd-56ad0253e728"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205238Z:9dd8170b-a85e-44db-9bfd-56ad0253e728"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0a914e76-4921-4c19-b460-a2d36003525a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0a914e76-4921-4c19-b460-a2d36003525a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wYTkxNGU3Ni00OTIxLTRjMTktYjQ2MC1hMmQzNjAwMzUyNWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "64865fdc-2989-48e2-b14b-8e65bf8d9fe7"
        ],
        "x-ms-request-id": [
          "westus:af159558-a9f5-4f86-8b90-6ea3e08bb339"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205238Z:64865fdc-2989-48e2-b14b-8e65bf8d9fe7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "556"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit resource location matches resource group location\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit that the resource location matches its resource group location\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"location\",\r\n        \"notIn\": [\r\n          \"[resourcegroup().location]\",\r\n          \"global\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZDEzNGRmOC1kYjgzLTQ2ZmItYWQ3Mi1mZTBjOTQyOGM4ZGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:58fcdb83-9710-484b-9191-d01808d9b3c4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "609effeb-6000-4e89-9490-feb4d19141a8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205238Z:609effeb-6000-4e89-9490-feb4d19141a8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0d134df8-db83-46fb-ad72-fe0c9428c8dd' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZDEzNGRmOC1kYjgzLTQ2ZmItYWQ3Mi1mZTBjOTQyOGM4ZGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:5818ceaa-e978-4c23-ba1d-f6ec2f19f149"
        ],
        "x-ms-correlation-request-id": [
          "9f536932-1136-4409-8801-c909ddd64748"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205238Z:9f536932-1136-4409-8801-c909ddd64748"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:37 GMT"
        ],
        "Content-Length": [
          "1286"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"SQL server TDE protector should be encrypted with your own key\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Transparent Data Encryption (TDE) with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/encryptionProtector\",\r\n          \"name\": \"current\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/servers/encryptionProtector/serverKeyType\",\r\n                \"equals\": \"AzureKeyVault\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                \"notEquals\": \"\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0d134df8-db83-46fb-ad72-fe0c9428c8dd\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZDliNDVmZi05ZGRkLTQzZmMtYmY1OS1mYmQxYzg0MjMwNTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7df5ac27-96a5-44ab-84f3-1b8e5578fed6"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "6ab6939a-5635-4b91-a888-a6d7e3556831"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205238Z:6ab6939a-5635-4b91-a888-a6d7e3556831"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0d9b45ff-9ddd-43fc-bf59-fbd1c8423053' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZDliNDVmZi05ZGRkLTQzZmMtYmY1OS1mYmQxYzg0MjMwNTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:e1e4d0a7-f868-4921-a6c8-60f89afaf1a1"
        ],
        "x-ms-correlation-request-id": [
          "688264a9-de45-4329-b0de-30e630067730"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205239Z:688264a9-de45-4329-b0de-30e630067730"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:38 GMT"
        ],
        "Content-Length": [
          "2587"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines on which Windows Defender Exploit Guard is not enabled. This policy should only be used along with its corresponding deploy policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"auditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"WindowsDefenderExploitGuard\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZTI0NmJjZi01ZjZmLTRmODctYmM2Zi03NzVkNDcxMmM3ZWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ddcabffc-cf11-4ad9-859f-c4b55f6ff19e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "b7eb3163-8218-471b-a271-35b56844e9f5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205239Z:b7eb3163-8218-471b-a271-35b56844e9f5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0e246bcf-5f6f-4f87-bc6f-775d4712c7ea' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZTI0NmJjZi01ZjZmLTRmODctYmM2Zi03NzVkNDcxMmM3ZWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:b2ce1c8c-0830-4502-a4cb-6bd8b472d097"
        ],
        "x-ms-correlation-request-id": [
          "b40ff32d-73a1-4976-b315-a260b21c285e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205239Z:b40ff32d-73a1-4976-b315-a260b21c285e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "1112"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Authorized IP ranges should be defined on Kubernetes Services\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAuthorizedIPRanges\",\r\n            \"exists\": \"false\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZTYwYjg5NS0zNzg2LTQ1ZGEtODM3Ny05YzZiNGI2YWM1Zjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:357688be-fa36-4b2e-b472-dfac4e679f4c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "02a76153-3fe0-44de-be97-a17ca97df51a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205239Z:02a76153-3fe0-44de-be97-a17ca97df51a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0e60b895-3786-45da-8377-9c6b4b6ac5f9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZTYwYjg5NS0zNzg2LTQ1ZGEtODM3Ny05YzZiNGI2YWM1Zjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:2dfba349-d93c-45ee-96ba-57a92c82fc9e"
        ],
        "x-ms-correlation-request-id": [
          "97a11c1b-70c7-42af-bfec-83e68251327d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205239Z:97a11c1b-70c7-42af-bfec-83e68251327d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "1216"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Remote debugging should be turned off for Function App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Remote debugging requires inbound ports to be opened on an function app.  Remote debugging should be turned off.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoteDebuggingForFunctionApp\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0e60b895-3786-45da-8377-9c6b4b6ac5f9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xMDZjY2JlNC1hNzkxLTRmMzMtYTQ0YS0wNjc5Njk0NGI4ZDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:54d518b5-c803-4521-9b75-f12185cb6208"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "7612db81-bee5-4bcb-bb96-3ef26450579a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205239Z:7612db81-bee5-4bcb-bb96-3ef26450579a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '106ccbe4-a791-4f33-a44a-06796944b8d5' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xMDZjY2JlNC1hNzkxLTRmMzMtYTQ0YS0wNjc5Njk0NGI4ZDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:737b78cc-e083-4c49-89ba-6464a6bab722"
        ],
        "x-ms-correlation-request-id": [
          "13bf77cc-bc1a-42d5-b245-3043675e9b21"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:13bf77cc-bc1a-42d5-b245-3043675e9b21"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "5235"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"CertificateThumbprints\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate thumbprints\",\r\n          \"description\": \"A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsCertificateInTrustedRoot\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprints')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsCertificateInTrustedRoot\"\r\n                },\r\n                \"CertificateThumbprints\": {\r\n                  \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"CertificateThumbprints\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                            \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"106ccbe4-a791-4f33-a44a-06796944b8d5\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xMWFjNzhlMy0zMWJjLTRmMGMtODQzNC0zN2FiOTYzY2VhMDc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:176e67fa-6af9-4bea-be02-a1fdfeeec371"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "24b48cee-1a64-4b3b-9b5a-dc7820a08238"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:24b48cee-1a64-4b3b-9b5a-dc7820a08238"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '11ac78e3-31bc-4f0c-8434-37ab963cea07' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xMWFjNzhlMy0zMWJjLTRmMGMtODQzNC0zN2FiOTYzY2VhMDc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:ac7dbe0f-d77c-41f7-84ed-de5a0cd70a67"
        ],
        "x-ms-correlation-request-id": [
          "d111e346-fcd5-4ea9-ba4d-f2157b9d8d2a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:d111e346-fcd5-4ea9-ba4d-f2157b9d8d2a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "5737"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Dependency Agent Deployment - VM Image (OS) unlisted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude_windows\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      },\r\n      \"listOfImageIdToInclude_linux\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"anyOf\": [\r\n                {\r\n                  \"field\": \"Microsoft.Compute/imageId\",\r\n                  \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                },\r\n                {\r\n                  \"field\": \"Microsoft.Compute/imageId\",\r\n                  \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                },\r\n                {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"2008-R2-SP1\",\r\n                            \"2008-R2-SP1-smalldisk\",\r\n                            \"2012-Datacenter\",\r\n                            \"2012-Datacenter-smalldisk\",\r\n                            \"2012-R2-Datacenter\",\r\n                            \"2012-R2-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter\",\r\n                            \"2016-Datacenter-Server-Core\",\r\n                            \"2016-Datacenter-Server-Core-smalldisk\",\r\n                            \"2016-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter-with-Containers\",\r\n                            \"2016-Datacenter-with-RDSH\",\r\n                            \"2019-Datacenter\",\r\n                            \"2019-Datacenter-Core\",\r\n                            \"2019-Datacenter-Core-smalldisk\",\r\n                            \"2019-Datacenter-Core-with-Containers\",\r\n                            \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-smalldisk\",\r\n                            \"2019-Datacenter-with-Containers\",\r\n                            \"2019-Datacenter-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-zhcn\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerSemiAnnual\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"Datacenter-Core-1709-smalldisk\",\r\n                            \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                            \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerHPCPack\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftSQLServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016-BYOL\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2-BYOL\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftRServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"MLServer-WS2016\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftVisualStudio\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"VisualStudio\",\r\n                            \"Windows\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftDynamicsAX\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Dynamics\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"microsoft-ads\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"windows-data-science-vm\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsDesktop\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Windows-10\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"RedHat\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"RHEL\",\r\n                        \"RHEL-SAP-HANA\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"SUSE\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"SLES\",\r\n                        \"SLES-HPC\",\r\n                        \"SLES-HPC-Priority\",\r\n                        \"SLES-SAP\",\r\n                        \"SLES-SAP-BYOS\",\r\n                        \"SLES-Priority\",\r\n                        \"SLES-BYOS\",\r\n                        \"SLES-SAPCAL\",\r\n                        \"SLES-Standard\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"12-SP2\",\r\n                            \"12-SP3\",\r\n                            \"12-SP4\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Canonical\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"UbuntuServer\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"14.04.0-LTS\",\r\n                            \"14.04.1-LTS\",\r\n                            \"14.04.5-LTS\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"16.04-LTS\",\r\n                            \"16.04.0-LTS\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"18.04-LTS\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"OpenLogic\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"Centos\",\r\n                        \"Centos-LVM\",\r\n                        \"CentOS-SRIOV\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"cloudera\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"cloudera-centos-os\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSKU\",\r\n                      \"like\": \"7*\"\r\n                    }\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"auditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n            \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"11ac78e3-31bc-4f0c-8434-37ab963cea07\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xMmY3ZTVkMC00MmE3LTQ2MzAtODBkOC01NGZiN2NmZjliZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a397b4b4-87dd-4ce6-9431-c9f71319f57b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "fd10f31e-dbc2-4d9a-a5d2-2bbc87f1cbd7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:fd10f31e-dbc2-4d9a-a5d2-2bbc87f1cbd7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:40 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '12f7e5d0-42a7-4630-80d8-54fb7cff9bd6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xMmY3ZTVkMC00MmE3LTQ2MzAtODBkOC01NGZiN2NmZjliZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:5eacccf0-9ab0-4282-8196-68af1ff3a7bb"
        ],
        "x-ms-correlation-request-id": [
          "515fece3-b55c-4703-b04c-e7b099e4544c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:515fece3-b55c-4703-b04c-e7b099e4544c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:39 GMT"
        ],
        "Content-Length": [
          "5154"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs that do not have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"installedApplication\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names (supports wildcards)\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WhitelistedApplication\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[InstalledApplication]bwhitelistedapp;Name', '=', parameters('installedApplication')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WhitelistedApplication\"\r\n                },\r\n                \"installedApplication\": {\r\n                  \"value\": \"[parameters('installedApplication')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"installedApplication\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[InstalledApplication]bwhitelistedapp;Name\",\r\n                            \"value\": \"[parameters('installedApplication')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/144f1397-32f9-4598-8c88-118decc3ccba?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNDRmMTM5Ny0zMmY5LTQ1OTgtOGM4OC0xMThkZWNjM2NjYmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d3035774-0d63-4e6a-a353-e4a91a870762"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "8ccc6d79-c2b1-432f-9c04-846866e5b8fc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:8ccc6d79-c2b1-432f-9c04-846866e5b8fc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:40 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '144f1397-32f9-4598-8c88-118decc3ccba' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/144f1397-32f9-4598-8c88-118decc3ccba?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNDRmMTM5Ny0zMmY5LTQ1OTgtOGM4OC0xMThkZWNjM2NjYmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "6e2288cd-84d4-40f7-b880-c1a007fc58e1"
        ],
        "x-ms-request-id": [
          "westus:001ecc08-7139-4aa8-8c06-14116d8a1ab2"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205240Z:6e2288cd-84d4-40f7-b880-c1a007fc58e1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:40 GMT"
        ],
        "Content-Length": [
          "5058"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs in which the Administrators group contains any of the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group contains any of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"MembersToExclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Members to exclude\",\r\n          \"description\": \"A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"AdministratorsGroupMembersToExclude\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToExclude', '=', parameters('MembersToExclude')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"AdministratorsGroupMembersToExclude\"\r\n                },\r\n                \"MembersToExclude\": {\r\n                  \"value\": \"[parameters('MembersToExclude')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"MembersToExclude\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[LocalGroup]AdministratorsGroup;MembersToExclude\",\r\n                            \"value\": \"[parameters('MembersToExclude')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"144f1397-32f9-4598-8c88-118decc3ccba\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/16390df4-2f73-4b42-af13-c801066763df?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNjM5MGRmNC0yZjczLTRiNDItYWYxMy1jODAxMDY2NzYzZGY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:46a760bf-e704-4fbf-914d-57adb601837c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "5fd732f7-ee7b-43b6-9e37-e2d38fdf1d38"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:5fd732f7-ee7b-43b6-9e37-e2d38fdf1d38"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '16390df4-2f73-4b42-af13-c801066763df' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/16390df4-2f73-4b42-af13-c801066763df?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNjM5MGRmNC0yZjczLTRiNDItYWYxMy1jODAxMDY2NzYzZGY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:3173bbe9-6db6-4db7-9f9b-9bde0339439e"
        ],
        "x-ms-correlation-request-id": [
          "f6119764-9d38-40dd-a6e7-94e80f8efde1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:f6119764-9d38-40dd-a6e7-94e80f8efde1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "4286"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not have a minimum password age of 1 day\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a minimum password age of 1 day. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"MinimumPasswordAge\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"MinimumPasswordAge\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"16390df4-2f73-4b42-af13-c801066763df\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNmY5YjM3Yy00NDA4LTRjMzAtYmMxNy0yNTQ5NThmMmUyZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:160de500-b928-48fb-9f6d-2043142a2baa"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "686b9e06-5351-4655-b86f-a05fdb7ae96d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:686b9e06-5351-4655-b86f-a05fdb7ae96d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:40 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '16f9b37c-4408-4c30-bc17-254958f2e2d6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNmY5YjM3Yy00NDA4LTRjMzAtYmMxNy0yNTQ5NThmMmUyZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:8571eca4-92f9-45c8-83fd-d3b460e16090"
        ],
        "x-ms-correlation-request-id": [
          "4adc59f1-a225-489d-a2ca-efeb8839cbfb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:4adc59f1-a225-489d-a2ca-efeb8839cbfb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:40 GMT"
        ],
        "Content-Length": [
          "1014"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not have the specified Windows PowerShell modules installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsPowerShellModules\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"16f9b37c-4408-4c30-bc17-254958f2e2d6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/17k78e20-9358-41c9-923c-fb736d382a12?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xN2s3OGUyMC05MzU4LTQxYzktOTIzYy1mYjczNmQzODJhMTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c2a473cc-df2f-476f-b1d3-ac671422773f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "4ea6474d-8384-44ab-9e3f-7443817f9fa1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:4ea6474d-8384-44ab-9e3f-7443817f9fa1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '17k78e20-9358-41c9-923c-fb736d382a12' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/17k78e20-9358-41c9-923c-fb736d382a12?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xN2s3OGUyMC05MzU4LTQxYzktOTIzYy1mYjczNmQzODJhMTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:e8221596-c65b-4576-83c5-a5ec12d5c2ca"
        ],
        "x-ms-correlation-request-id": [
          "0f136edb-868b-4367-b283-8dd5c7f8e011"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:0f136edb-868b-4367-b283-8dd5c7f8e011"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "1036"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Transparent Data Encryption on SQL databases should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit transparent data encryption status for SQL databases\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"notEquals\": \"master\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n          \"name\": \"current\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"equals\": \"enabled\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xYTgzM2ZmMS1kMjk3LTRhMGYtOTk0NC04ODg0MjhmOGUwZmY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9b38c592-1cab-4faf-b470-4b47698e604a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "e96e5bea-0e32-4756-8f82-bb451105787a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:e96e5bea-0e32-4756-8f82-bb451105787a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1a833ff1-d297-4a0f-9944-888428f8e0ff' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xYTgzM2ZmMS1kMjk3LTRhMGYtOTk0NC04ODg0MjhmOGUwZmY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:6ae85bdc-e73b-4041-a374-4424267e426b"
        ],
        "x-ms-correlation-request-id": [
          "b5e9e01d-c23a-478c-8a45-6b9b5b18d864"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205241Z:b5e9e01d-c23a-478c-8a45-6b9b5b18d864"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "1141"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Access to App Services should be restricted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Azure security center has discovered that the networking configuration of some of your app services are overly permissive and allow inbound traffic from ranges that are too broad\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Web/sites\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"restrictAccessToAppServices\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1a833ff1-d297-4a0f-9944-888428f8e0ff\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xYjdhYTI0My0zMGU0LTRjOWUtYmNhOC1kMGQzMDIyYjYzNGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5cda42a4-86ac-4d56-a78e-0028508edb89"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "07c417c0-2847-469d-94c1-181b2ace20fb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205242Z:07c417c0-2847-469d-94c1-181b2ace20fb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1b7aa243-30e4-4c9e-bca8-d0d3022b634a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xYjdhYTI0My0zMGU0LTRjOWUtYmNhOC1kMGQzMDIyYjYzNGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:f89520d4-3607-4ab3-9c59-97cfe91168fb"
        ],
        "x-ms-correlation-request-id": [
          "cb009e2c-5fb1-46c1-9dfd-5bb42043f5bf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205242Z:cb009e2c-5fb1-46c1-9dfd-5bb42043f5bf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "1154"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Vulnerability assessment should be enabled on your SQL managed instances\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit SQL managed instances which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/managedInstances\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n            \"equals\": \"True\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1b7aa243-30e4-4c9e-bca8-d0d3022b634a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1c210e94-a481-4beb-95fa-1571b434fb04?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xYzIxMGU5NC1hNDgxLTRiZWItOTVmYS0xNTcxYjQzNGZiMDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:82bd5c4e-2e2b-472d-875f-97d72556a357"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "cb6ea089-3d5d-4a4a-bfee-a3fdb2dd502f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205242Z:cb6ea089-3d5d-4a4a-bfee-a3fdb2dd502f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1c210e94-a481-4beb-95fa-1571b434fb04' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1c210e94-a481-4beb-95fa-1571b434fb04?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xYzIxMGU5NC1hNDgxLTRiZWItOTVmYS0xNTcxYjQzNGZiMDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:bc842dca-da86-4f5e-bb3c-bbb497af75d7"
        ],
        "x-ms-correlation-request-id": [
          "214a6bed-d353-493e-9cdf-06c512112d14"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205242Z:214a6bed-d353-493e-9cdf-06c512112d14"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:41 GMT"
        ],
        "Content-Length": [
          "5233"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Dependency Agent for Windows VMs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Dependency Agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"2008-R2-SP1\",\r\n                      \"2008-R2-SP1-smalldisk\",\r\n                      \"2012-Datacenter\",\r\n                      \"2012-Datacenter-smalldisk\",\r\n                      \"2012-R2-Datacenter\",\r\n                      \"2012-R2-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter\",\r\n                      \"2016-Datacenter-Server-Core\",\r\n                      \"2016-Datacenter-Server-Core-smalldisk\",\r\n                      \"2016-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter-with-Containers\",\r\n                      \"2016-Datacenter-with-RDSH\",\r\n                      \"2019-Datacenter\",\r\n                      \"2019-Datacenter-Core\",\r\n                      \"2019-Datacenter-Core-smalldisk\",\r\n                      \"2019-Datacenter-Core-with-Containers\",\r\n                      \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-smalldisk\",\r\n                      \"2019-Datacenter-with-Containers\",\r\n                      \"2019-Datacenter-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-zhcn\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerSemiAnnual\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"Datacenter-Core-1709-smalldisk\",\r\n                      \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                      \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerHPCPack\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016-BYOL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2-BYOL\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftRServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"MLServer-WS2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftVisualStudio\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"VisualStudio\",\r\n                      \"Windows\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftDynamicsAX\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Dynamics\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"windows-data-science-vm\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsDesktop\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Windows-10\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"DependencyAgentWindows\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                \"equals\": \"Succeeded\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"DependencyAgent\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                  \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"9.6\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1c210e94-a481-4beb-95fa-1571b434fb04\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZDg0ZDVmYi0wMWY2LTRkMTItYmE0Zi00YTI2MDgxZDQwM2Q/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:463e5893-2a73-428f-b9d7-8ac3aee72af2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "31539dc8-2398-4637-8181-e8128f5a46d0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205242Z:31539dc8-2398-4637-8181-e8128f5a46d0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:42 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1d84d5fb-01f6-4d12-ba4f-4a26081d403d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZDg0ZDVmYi0wMWY2LTRkMTItYmE0Zi00YTI2MDgxZDQwM2Q/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:056c88b5-736b-449c-bf61-1980818d9063"
        ],
        "x-ms-correlation-request-id": [
          "ca3129e4-e2e9-4df4-a25f-14007212243a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205242Z:ca3129e4-e2e9-4df4-a25f-14007212243a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:42 GMT"
        ],
        "Content-Length": [
          "1070"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Virtual machines should be migrated to new Azure Resource Manager resources\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, ARM-based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.classicCompute/virtualMachines\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1d84d5fb-01f6-4d12-ba4f-4a26081d403d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZGU3YjExZC0xODcwLTQxYTUtODE4MS01MDdlN2M2NjNjZmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c1dbcf98-4bcb-467e-a9e0-c4ed4c1571a4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "bdfa6cfa-f0c2-44f2-836a-e937f9c80b31"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:bdfa6cfa-f0c2-44f2-836a-e937f9c80b31"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:42 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1de7b11d-1870-41a5-8181-507e7c663cfb' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZGU3YjExZC0xODcwLTQxYTUtODE4MS01MDdlN2M2NjNjZmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:e0db2f55-3c77-4021-8170-e5109917361e"
        ],
        "x-ms-correlation-request-id": [
          "d67866d5-9044-4829-a48a-3f6e1cb27947"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:d67866d5-9044-4829-a48a-3f6e1cb27947"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:42 GMT"
        ],
        "Content-Length": [
          "1241"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported .NET Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestDotNet\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1de7b11d-1870-41a5-8181-507e7c663cfb\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZTMwMTEwYS01Y2ViLTQ2MGMtYTIwNC1jMWMzOTY5YzZkNjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:2ff97303-1809-4880-a62f-938097d10911"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "16985758-8da9-4fa6-a2f3-342a742c3c6f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:16985758-8da9-4fa6-a2f3-342a742c3c6f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:43 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1e30110a-5ceb-460c-a204-c1c3969c6d62' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZTMwMTEwYS01Y2ViLTQ2MGMtYTIwNC1jMWMzOTY5YzZkNjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:8dca014e-d2a5-4411-ba78-ec1982c5980d"
        ],
        "x-ms-correlation-request-id": [
          "f40d5b0e-7972-42e6-93e2-aa61f4cce2b1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:f40d5b0e-7972-42e6-93e2-aa61f4cce2b1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:42 GMT"
        ],
        "Content-Length": [
          "822"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require tag and its value\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      },\r\n      \"tagValue\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Value\",\r\n          \"description\": \"Value of the tag, such as 'production'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n          \"equals\": \"[parameters('tagValue')]\"\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZjMxNDc2NC1jYjczLTRmYzktYjg2My04ZWNhOThhYzM2ZTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:b5f78908-f618-46da-99a6-267822ace590"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "dcd13de0-171e-46b5-af0b-6583890c9308"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:dcd13de0-171e-46b5-af0b-6583890c9308"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:42 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '1f314764-cb73-4fc9-b863-8eca98ac36e9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xZjMxNDc2NC1jYjczLTRmYzktYjg2My04ZWNhOThhYzM2ZTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:5ed93509-be8b-40ee-a34a-8a14b358657a"
        ],
        "x-ms-correlation-request-id": [
          "a9282392-0c64-4c9a-bf69-9d8ff13707dc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:a9282392-0c64-4c9a-bf69-9d8ff13707dc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:43 GMT"
        ],
        "Content-Length": [
          "1048"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"An Azure Active Directory administrator should be provisioned for SQL servers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/administrators\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"1f314764-cb73-4fc9-b863-8eca98ac36e9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMDFlYTU4Ny03YzkwLTQxYzMtOTEwZi1jMjgwYWUwMWNmZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e03b43bb-383c-45df-8551-3582c50b9521"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "6f746382-4942-4af6-b612-6ed7e93b8322"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205243Z:6f746382-4942-4af6-b612-6ed7e93b8322"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:43 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '201ea587-7c90-41c3-910f-c280ae01cfd6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMDFlYTU4Ny03YzkwLTQxYzMtOTEwZi1jMjgwYWUwMWNmZDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:2ba16cf7-2b54-4238-984b-30f324b4e04e"
        ],
        "x-ms-correlation-request-id": [
          "fe71429b-2cd5-4f6c-8db0-36f9cdd385a6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:fe71429b-2cd5-4f6c-8db0-36f9cdd385a6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:43 GMT"
        ],
        "Content-Length": [
          "1212"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"The NSGs rules for web applications on IaaS should be hardened\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Azure security center has discovered that some of your virtual machines are running web applications, and the NSGs associated to these virtual machines are overly permissive with regards to the web application ports\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"unprotectedWebApplication\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMjRkYTlmZS0wZDM4LTRlNzktYWRiMy0wYTZlMmFmOTQyYWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:84cdfd0f-0e25-4230-a1b5-a619ab429080"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "630e0c44-1f01-4521-a90a-32c57ebaaf20"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:630e0c44-1f01-4521-a90a-32c57ebaaf20"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:43 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '224da9fe-0d38-4e79-adb3-0a6e2af942ac' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMjRkYTlmZS0wZDM4LTRlNzktYWRiMy0wYTZlMmFmOTQyYWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:58ffa669-41fd-4567-b1ba-de525d860a52"
        ],
        "x-ms-correlation-request-id": [
          "56b37b1a-1750-4fe8-921e-5c4e0d41a40c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:56b37b1a-1750-4fe8-921e-5c4e0d41a40c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:43 GMT"
        ],
        "Content-Length": [
          "1178"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit API Apps that are not using custom domains\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use of custom domains protects a API app from common attacks such as phishing and other DNS-related attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UsedCustomDomains\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"224da9fe-0d38-4e79-adb3-0a6e2af942ac\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/22730e10-96f6-4aac-ad84-9383d35b5917?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMjczMGUxMC05NmY2LTRhYWMtYWQ4NC05MzgzZDM1YjU5MTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:0fb05273-5bd2-471d-853c-a5dda0788dd6"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "c99f474e-c4fb-4206-b732-36b49490f06b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:c99f474e-c4fb-4206-b732-36b49490f06b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '22730e10-96f6-4aac-ad84-9383d35b5917' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/22730e10-96f6-4aac-ad84-9383d35b5917?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMjczMGUxMC05NmY2LTRhYWMtYWQ4NC05MzgzZDM1YjU5MTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:45856c58-8acb-4c6b-b334-64e8eedc3fb4"
        ],
        "x-ms-correlation-request-id": [
          "d7a855b0-304c-462e-a8e4-0485fa77cf2a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:d7a855b0-304c-462e-a8e4-0485fa77cf2a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "1199"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Management ports should be closed on your virtual machines\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"restrictAccessToManagementPorts\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"22730e10-96f6-4aac-ad84-9383d35b5917\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMmJlZTIwMi1hODJmLTQzMDUtOWEyYS02ZDdmNDRkNGRlZGI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:25ac62a5-a0e0-4669-a4de-19d285aa7a2a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "1fe06e08-8a02-4d7a-b5e2-5cf437f2d65a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:1fe06e08-8a02-4d7a-b5e2-5cf437f2d65a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '22bee202-a82f-4305-9a2a-6d7f44d4dedb' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMmJlZTIwMi1hODJmLTQzMDUtOWEyYS02ZDdmNDRkNGRlZGI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:ce9f9613-d787-4b3b-a164-9576e68e27ae"
        ],
        "x-ms-correlation-request-id": [
          "94c640bf-a7a5-440e-b341-4db8b7aa16a7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205244Z:94c640bf-a7a5-440e-b341-4db8b7aa16a7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "1027"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Only secure connections to your Redis Cache should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit enabling of only connections via SSL to Redis Cache. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n    \"metadata\": {\r\n      \"category\": \"Cache\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Cache/redis\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\r\n            \"equals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"22bee202-a82f-4305-9a2a-6d7f44d4dedb\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/23020aa6-1135-4be2-bae2-149982b06eca?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMzAyMGFhNi0xMTM1LTRiZTItYmFlMi0xNDk5ODJiMDZlY2E/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:359ac977-4290-427e-8b13-08ff30d3674c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "eb25ce13-dd0b-4b00-ba9b-ce40c2ea436a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205245Z:eb25ce13-dd0b-4b00-ba9b-ce40c2ea436a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '23020aa6-1135-4be2-bae2-149982b06eca' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/23020aa6-1135-4be2-bae2-149982b06eca?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yMzAyMGFhNi0xMTM1LTRiZTItYmFlMi0xNDk5ODJiMDZlY2E/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:7563ae73-1440-475e-9a3a-0d3f056ef156"
        ],
        "x-ms-correlation-request-id": [
          "1596b33d-63ea-4a86-bc12-5304684273b3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205245Z:1596b33d-63ea-4a86-bc12-5304684273b3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "4326"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not restrict the minimum password length to 14 characters. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"MinimumPasswordLength\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"MinimumPasswordLength\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"23020aa6-1135-4be2-bae2-149982b06eca\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNGRkZTk2ZC1mMGIxLTQyNWUtODg0Zi00YTE0MjFlMmRjZGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7722db1f-2f89-4ce8-b2d7-cadbd741761b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "04a86f4c-a95a-4299-b847-598df488c10d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205245Z:04a86f4c-a95a-4299-b847-598df488c10d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '24dde96d-f0b1-425e-884f-4a1421e2dcdc' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNGRkZTk2ZC1mMGIxLTQyNWUtODg0Zi00YTE0MjFlMmRjZGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:b0528742-d2a9-4fdf-baac-26c986b7abdb"
        ],
        "x-ms-correlation-request-id": [
          "e6db404d-c194-4677-8550-1f82650ac134"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205245Z:e6db404d-c194-4677-8550-1f82650ac134"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "985"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not have a maximum password age of 70 days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not have a maximum password age of 70 days. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"MaximumPasswordAge\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"24dde96d-f0b1-425e-884f-4a1421e2dcdc\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNmE4MjhlMS1lODhmLTQ2NGUtYmJiMy1jMTM0YTI4MmI5ZGU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c250a692-d40a-4a05-94a2-234783983805"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "c4da3d75-3653-49e8-81fd-4150caca5c21"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205245Z:c4da3d75-3653-49e8-81fd-4150caca5c21"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:44 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '26a828e1-e88f-464e-bbb3-c134a282b9de' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNmE4MjhlMS1lODhmLTQ2NGUtYmJiMy1jMTM0YTI4MmI5ZGU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:5428bc6f-7663-40f8-ab4c-770fd3165a72"
        ],
        "x-ms-correlation-request-id": [
          "9d7532c7-4ecf-4fe6-818a-4758243b9a53"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:9d7532c7-4ecf-4fe6-818a-4758243b9a53"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "1129"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Endpoint protection solution should be installed on virtual machine scale sets\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit the existence and health of an endpoint protection solution on your virtual machines scale sets, to protect them from threats and vulnerabilities.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"EndpointProtection\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"26a828e1-e88f-464e-bbb3-c134a282b9de\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNmVlNjdhMi1mODFhLTRiYTgtYjljZS04NTUwYmQ1ZWUxYTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8c07d60b-96b7-4874-b0fb-28b402d8816b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "d38eee82-4736-4e01-8fef-0b00e4ab8ece"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:d38eee82-4736-4e01-8fef-0b00e4ab8ece"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNmVlNjdhMi1mODFhLTRiYTgtYjljZS04NTUwYmQ1ZWUxYTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:c580b741-127a-4c71-b11b-127aa05bca88"
        ],
        "x-ms-correlation-request-id": [
          "1b0b86cf-f1ab-4a25-b14a-f1706f095258"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:1b0b86cf-f1ab-4a25-b14a-f1706f095258"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "1489"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Metric alert rules should be configured on Batch accounts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit configuration of metric alert rules on Batch account to enable the required metric\",\r\n    \"metadata\": {\r\n      \"category\": \"Batch\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"metricName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Metric name\",\r\n          \"description\": \"The metric name that an alert rule must be enabled on\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/alertRules\",\r\n          \"existenceScope\": \"Subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/alertRules/isEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.metricName\",\r\n                \"equals\": \"[parameters('metricName')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.resourceUri\",\r\n                \"equals\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourcegroups/', resourceGroup().name, '/providers/Microsoft.Batch/batchAccounts/', field('name'))]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/2835b622-407b-4114-9198-6f7064cbe0dc?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yODM1YjYyMi00MDdiLTQxMTQtOTE5OC02ZjcwNjRjYmUwZGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:2d6a24b4-ae47-420c-aef0-9376ae76180e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "0f3938b3-5563-451c-a9da-8b5466ad6afc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:0f3938b3-5563-451c-a9da-8b5466ad6afc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '2835b622-407b-4114-9198-6f7064cbe0dc' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/2835b622-407b-4114-9198-6f7064cbe0dc?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yODM1YjYyMi00MDdiLTQxMTQtOTE5OC02ZjcwNjRjYmUwZGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:686e6510-b7bf-417e-9464-97ee6147624d"
        ],
        "x-ms-correlation-request-id": [
          "1da04599-71d1-4fe7-8515-1c4b9ec92793"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:1da04599-71d1-4fe7-8515-1c4b9ec92793"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:46 GMT"
        ],
        "Content-Length": [
          "4556"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n            \"equals\": \"MicrosoftWindowsServer\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/imageOffer\",\r\n            \"equals\": \"WindowsServer\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/imageSKU\",\r\n            \"in\": [\r\n              \"2008-R2-SP1\",\r\n              \"2008-R2-SP1-smalldisk\",\r\n              \"2012-Datacenter\",\r\n              \"2012-Datacenter-smalldisk\",\r\n              \"2012-R2-Datacenter\",\r\n              \"2012-R2-Datacenter-smalldisk\",\r\n              \"2016-Datacenter\",\r\n              \"2016-Datacenter-Server-Core\",\r\n              \"2016-Datacenter-Server-Core-smalldisk\",\r\n              \"2016-Datacenter-smalldisk\",\r\n              \"2016-Datacenter-with-Containers\",\r\n              \"2016-Datacenter-with-RDSH\",\r\n              \"2019-Datacenter\",\r\n              \"2019-Datacenter-Core\",\r\n              \"2019-Datacenter-Core-smalldisk\",\r\n              \"2019-Datacenter-Core-with-Containers\",\r\n              \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n              \"2019-Datacenter-smalldisk\",\r\n              \"2019-Datacenter-with-Containers\",\r\n              \"2019-Datacenter-with-Containers-smalldisk\"\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"IaaSAntimalware\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Security\"\r\n              }\r\n            ]\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ExclusionsPaths\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                    }\r\n                  },\r\n                  \"ExclusionsExtensions\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                    }\r\n                  },\r\n                  \"ExclusionsProcesses\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                    }\r\n                  },\r\n                  \"RealtimeProtectionEnabled\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"true\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                    }\r\n                  },\r\n                  \"ScheduledScanSettingsIsEnabled\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"false\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                    }\r\n                  },\r\n                  \"ScheduledScanSettingsScanType\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"Quick\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                    }\r\n                  },\r\n                  \"ScheduledScanSettingsDay\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"7\",\r\n                    \"metadata\": {\r\n                      \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                    }\r\n                  },\r\n                  \"ScheduledScanSettingsTime\": {\r\n                    \"type\": \"string\",\r\n                    \"defaultValue\": \"120\",\r\n                    \"metadata\": {\r\n                      \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                    }\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"apiVersion\": \"2017-12-01\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.Azure.Security\",\r\n                      \"type\": \"IaaSAntimalware\",\r\n                      \"typeHandlerVersion\": \"1.3\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {\r\n                        \"AntimalwareEnabled\": true,\r\n                        \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                        \"ScheduledScanSettings\": {\r\n                          \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                          \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                          \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                          \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                        },\r\n                        \"Exclusions\": {\r\n                          \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                          \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                          \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"RealtimeProtectionEnabled\": {\r\n                  \"value\": \"true\"\r\n                },\r\n                \"ScheduledScanSettingsIsEnabled\": {\r\n                  \"value\": \"true\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yYTBlMTRhNi1iMGE2LTRmYWItOTkxYS0xODdhNGY4MWM0OTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8276b64a-7dfd-426a-8a3d-4354d1892c91"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "57d7742a-5a87-4b3a-9007-4d4cb5ab23eb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:57d7742a-5a87-4b3a-9007-4d4cb5ab23eb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:46 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '2a0e14a6-b0a6-4fab-991a-187a4f81c498' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yYTBlMTRhNi1iMGE2LTRmYWItOTkxYS0xODdhNGY4MWM0OTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:514c3b5e-fbbc-4af6-9519-a1a1d0ec9092"
        ],
        "x-ms-correlation-request-id": [
          "6ccbf322-9b97-453f-bea9-237fbd2a51f8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205246Z:6ccbf322-9b97-453f-bea9-237fbd2a51f8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:45 GMT"
        ],
        "Content-Length": [
          "1085"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Append tag and its default value\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Appends the specified tag and value when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed. Does not apply to resource groups.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      },\r\n      \"tagValue\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Value\",\r\n          \"description\": \"Value of the tag, such as 'production'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n        \"exists\": \"false\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"append\",\r\n        \"details\": [\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"value\": \"[parameters('tagValue')]\"\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZDYwZDNiNy1hYTEwLTQ1NGMtODhhOC1kZTM5ZDk5ZDE3YzY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5bbb9a9f-0195-4e4a-8a1c-06867aeb4c16"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "870b376c-f352-454e-aefc-34d03432f067"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:870b376c-f352-454e-aefc-34d03432f067"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:46 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '2d60d3b7-aa10-454c-88a8-de39d99d17c6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZDYwZDNiNy1hYTEwLTQ1NGMtODhhOC1kZTM5ZDk5ZDE3YzY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "a2186741-82fc-4d73-8df0-d0deb7be0fd5"
        ],
        "x-ms-request-id": [
          "westus:dd2f9383-efa6-4bab-b055-2802841099f1"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:a2186741-82fc-4d73-8df0-d0deb7be0fd5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:46 GMT"
        ],
        "Content-Length": [
          "1016"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not store passwords using reversible encryption\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not store passwords using reversible encryption. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"StorePasswordsUsingReversibleEncryption\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"2d60d3b7-aa10-454c-88a8-de39d99d17c6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZDY3MjIyZC0wNWZkLTQ1MjYtYTE3MS0yZWUxMzJhZDllODM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5ffde265-a3ac-4d28-959c-2552ea556ac1"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "97b6d719-4a5a-422b-8ef1-e2fd759d3f69"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:97b6d719-4a5a-422b-8ef1-e2fd759d3f69"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:46 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '2d67222d-05fd-4526-a171-2ee132ad9e83' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZDY3MjIyZC0wNWZkLTQ1MjYtYTE3MS0yZWUxMzJhZDllODM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:d2244018-9434-4135-bf1a-97f9bef22bbc"
        ],
        "x-ms-correlation-request-id": [
          "b8c92f9b-93ad-4690-864d-1f967d048a12"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:b8c92f9b-93ad-4690-864d-1f967d048a12"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:47 GMT"
        ],
        "Content-Length": [
          "1007"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Linux VMs that allow remote connections from accounts without passwords\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Linux virtual machines that allow remote connections from accounts without passwords. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"PasswordPolicy_msid110\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"2d67222d-05fd-4526-a171-2ee132ad9e83\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZmRlOGE5OC02ODkyLTQyNmEtODNiYS0wNTBlNjQwYzBjZTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5543d3af-c35d-495c-90f9-26058b9f2284"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "d727a3b5-e142-498e-9e24-67692b7fab17"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:d727a3b5-e142-498e-9e24-67692b7fab17"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:47 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '2fde8a98-6892-426a-83ba-050e640c0ce0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZmRlOGE5OC02ODkyLTQyNmEtODNiYS0wNTBlNjQwYzBjZTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:e49694f8-f784-4c4f-9a72-f9e28926fe81"
        ],
        "x-ms-correlation-request-id": [
          "05f63f79-f940-4ec6-9438-81938ff1625f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:05f63f79-f940-4ec6-9438-81938ff1625f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:47 GMT"
        ],
        "Content-Length": [
          "1231"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Web Application should only be accessible over HTTPS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"OnlyHttpsForWebApplication\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"2fde8a98-6892-426a-83ba-050e640c0ce0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/315c850a-272d-4502-8935-b79010405970?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zMTVjODUwYS0yNzJkLTQ1MDItODkzNS1iNzkwMTA0MDU5NzA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c09ed61a-c37a-479e-b123-b29747cbcc13"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "0e90ca28-d461-4853-bd85-6c23eb710f0c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205247Z:0e90ca28-d461-4853-bd85-6c23eb710f0c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:47 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '315c850a-272d-4502-8935-b79010405970' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/315c850a-272d-4502-8935-b79010405970?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zMTVjODUwYS0yNzJkLTQ1MDItODkzNS1iNzkwMTA0MDU5NzA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:7a68f619-1ca3-4d5a-9952-a718eb099378"
        ],
        "x-ms-correlation-request-id": [
          "0bdc0f37-2412-4c57-bc9d-07e5cc436c05"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205248Z:0bdc0f37-2412-4c57-bc9d-07e5cc436c05"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:47 GMT"
        ],
        "Content-Length": [
          "4897"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs that are not joined to the specified domain\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not joined to the specified domain. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"DomainName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Domain Name (FQDN)\",\r\n          \"description\": \"The fully qualified domain name (FQDN) that the Windows VMs should be joined to\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsDomainMembership\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[DomainMembership]WindowsDomainMembership;DomainName', '=', parameters('DomainName')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsDomainMembership\"\r\n                },\r\n                \"DomainName\": {\r\n                  \"value\": \"[parameters('DomainName')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"DomainName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[DomainMembership]WindowsDomainMembership;DomainName\",\r\n                            \"value\": \"[parameters('DomainName')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"315c850a-272d-4502-8935-b79010405970\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/32133ab0-ee4b-4b44-98d6-042180979d50?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zMjEzM2FiMC1lZTRiLTRiNDQtOThkNi0wNDIxODA5NzlkNTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:28343a5c-7cc2-427a-854e-0b81910d608d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "6d2ebb02-781a-4d4b-8698-6fb6db52affa"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205248Z:6d2ebb02-781a-4d4b-8698-6fb6db52affa"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '32133ab0-ee4b-4b44-98d6-042180979d50' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/32133ab0-ee4b-4b44-98d6-042180979d50?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zMjEzM2FiMC1lZTRiLTRiNDQtOThkNi0wNDIxODA5NzlkNTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:bfbfcb4f-4da4-4153-a51d-0e7c62c83197"
        ],
        "x-ms-correlation-request-id": [
          "b6d13190-dd58-49df-97f5-fd0e13cbfd0c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205248Z:b6d13190-dd58-49df-97f5-fd0e13cbfd0c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "5925"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude_windows\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      },\r\n      \"listOfImageIdToInclude_linux\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"anyOf\": [\r\n                {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"2008-R2-SP1\",\r\n                            \"2008-R2-SP1-smalldisk\",\r\n                            \"2012-Datacenter\",\r\n                            \"2012-Datacenter-smalldisk\",\r\n                            \"2012-R2-Datacenter\",\r\n                            \"2012-R2-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter\",\r\n                            \"2016-Datacenter-Server-Core\",\r\n                            \"2016-Datacenter-Server-Core-smalldisk\",\r\n                            \"2016-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter-with-Containers\",\r\n                            \"2016-Datacenter-with-RDSH\",\r\n                            \"2019-Datacenter\",\r\n                            \"2019-Datacenter-Core\",\r\n                            \"2019-Datacenter-Core-smalldisk\",\r\n                            \"2019-Datacenter-Core-with-Containers\",\r\n                            \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-smalldisk\",\r\n                            \"2019-Datacenter-with-Containers\",\r\n                            \"2019-Datacenter-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-zhcn\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerSemiAnnual\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"Datacenter-Core-1709-smalldisk\",\r\n                            \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                            \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerHPCPack\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftSQLServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016-BYOL\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2-BYOL\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftRServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"MLServer-WS2016\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftVisualStudio\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"VisualStudio\",\r\n                            \"Windows\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftDynamicsAX\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Dynamics\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"microsoft-ads\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"windows-data-science-vm\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsDesktop\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Windows-10\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"RedHat\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"RHEL\",\r\n                        \"RHEL-SAP-HANA\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"SUSE\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"SLES\",\r\n                        \"SLES-HPC\",\r\n                        \"SLES-HPC-Priority\",\r\n                        \"SLES-SAP\",\r\n                        \"SLES-SAP-BYOS\",\r\n                        \"SLES-Priority\",\r\n                        \"SLES-BYOS\",\r\n                        \"SLES-SAPCAL\",\r\n                        \"SLES-Standard\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"12*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Canonical\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"UbuntuServer\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"14.04*LTS\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"16.04*LTS\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"18.04*LTS\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Oracle\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"Oracle-Linux\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7.*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"OpenLogic\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"CentOS\",\r\n                        \"Centos-LVM\",\r\n                        \"CentOS-SRIOV\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"cloudera\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"cloudera-centos-os\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSKU\",\r\n                      \"like\": \"7*\"\r\n                    }\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"auditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n            \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"32133ab0-ee4b-4b44-98d6-042180979d50\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zMmIxZTRkNC02Y2Q1LTQ3YjQtYTkzNS0xNjlkYThhNWMyNjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:b3e9dcb8-f6b4-4f35-a00c-e88d7ee2f350"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "83116df8-97f7-45cd-a8e6-e14c1f527f31"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205248Z:83116df8-97f7-45cd-a8e6-e14c1f527f31"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '32b1e4d4-6cd5-47b4-a935-169da8a5c262' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zMmIxZTRkNC02Y2Q1LTQ3YjQtYTkzNS0xNjlkYThhNWMyNjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:c32f03ac-917b-47b3-9fe4-abfea609a5ce"
        ],
        "x-ms-correlation-request-id": [
          "297b5615-672e-4df6-9106-ac7a9bcda978"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205248Z:297b5615-672e-4df6-9106-ac7a9bcda978"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "4992"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the specified services are not installed and 'Running'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"ServiceName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service names (supports wildcards)\",\r\n          \"description\": \"A semicolon-separated list of the names of the services that should be installed and 'Running'. e.g. 'WinRm;Wi*'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsServiceStatus\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[WindowsServiceStatus]WindowsServiceStatus1;ServiceName', '=', parameters('ServiceName')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsServiceStatus\"\r\n                },\r\n                \"ServiceName\": {\r\n                  \"value\": \"[parameters('ServiceName')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ServiceName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\",\r\n                            \"value\": \"[parameters('ServiceName')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"32b1e4d4-6cd5-47b4-a935-169da8a5c262\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3470477a-b35a-49db-aca5-1073d04524fe?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNDcwNDc3YS1iMzVhLTQ5ZGItYWNhNS0xMDczZDA0NTI0ZmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:be7610e5-aa5b-48b8-9edb-706342f981ea"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "87d2144a-e77b-4818-b1d3-7a7b65b3d94c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205248Z:87d2144a-e77b-4818-b1d3-7a7b65b3d94c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3470477a-b35a-49db-aca5-1073d04524fe' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3470477a-b35a-49db-aca5-1073d04524fe?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNDcwNDc3YS1iMzVhLTQ5ZGItYWNhNS0xMDczZDA0NTI0ZmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:94852a39-5887-403c-8bf7-cd7b871059cd"
        ],
        "x-ms-correlation-request-id": [
          "b920ac08-7118-46ec-a8db-764831af56d2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205249Z:b920ac08-7118-46ec-a8db-764831af56d2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "4671"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Linux VMs that have accounts without passwords\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that have accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"microsoft-aks\",\r\n                  \"AzureDatabricks\",\r\n                  \"qubole-inc\",\r\n                  \"datastax\",\r\n                  \"couchbase\",\r\n                  \"scalegrid\",\r\n                  \"checkpoint\",\r\n                  \"paloaltonetworks\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"CentOS*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"RHEL\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"osa\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"credativ\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Debian\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"7*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Suse\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"SLES*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"11*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"12*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"linux-data-science-vm-ubuntu\",\r\n                      \"azureml\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-altus-centos-os\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"PasswordPolicy_msid232\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"PasswordPolicy_msid232\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforLinux\",\r\n                      \"typeHandlerVersion\": \"1.0\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3470477a-b35a-49db-aca5-1073d04524fe\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNGM4NzdhZC01MDdlLTRjODItOTkzZS0zNDUyYTZlMGFkM2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:22685543-ca71-4189-993e-bdeae7e70b8f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "3b0b2290-7da7-4565-b2e8-a347871dacbf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205249Z:3b0b2290-7da7-4565-b2e8-a347871dacbf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:48 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '34c877ad-507e-4c82-993e-3452a6e0ad3c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNGM4NzdhZC01MDdlLTRjODItOTkzZS0zNDUyYTZlMGFkM2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:1c6d02ec-92ce-4fad-8d99-9162bb993a88"
        ],
        "x-ms-correlation-request-id": [
          "b93425c3-26c1-4e4d-a535-03db987f4f48"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205249Z:b93425c3-26c1-4e4d-a535-03db987f4f48"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:49 GMT"
        ],
        "Content-Length": [
          "1158"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit unrestricted network access to storage accounts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit unrestricted network access in your storage account firewall settings. Instead, configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premise clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges\",\r\n    \"metadata\": {\r\n      \"category\": \"Storage\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\r\n            \"equals\": \"Allow\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"34c877ad-507e-4c82-993e-3452a6e0ad3c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/34f95f76-5386-4de7-b824-0d8478470c9d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNGY5NWY3Ni01Mzg2LTRkZTctYjgyNC0wZDg0Nzg0NzBjOWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:bc8bd4fa-410b-4a62-9772-b51b5ae58e83"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "a20c9d0e-e975-4554-b153-90eaae7f188b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205249Z:a20c9d0e-e975-4554-b153-90eaae7f188b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:49 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '34f95f76-5386-4de7-b824-0d8478470c9d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/34f95f76-5386-4de7-b824-0d8478470c9d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNGY5NWY3Ni01Mzg2LTRkZTctYjgyNC0wZDg0Nzg0NzBjOWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:e4aa8673-9689-4dc7-a133-30de3a1913d5"
        ],
        "x-ms-correlation-request-id": [
          "f2dc8ff2-045d-4487-8f77-e0d1d15b4518"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205249Z:f2dc8ff2-045d-4487-8f77-e0d1d15b4518"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:49 GMT"
        ],
        "Content-Length": [
          "1676"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Logic Apps should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Logic Apps\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Logic/workflows\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"34f95f76-5386-4de7-b824-0d8478470c9d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/356a906e-05e5-4625-8729-90771e0ee934?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNTZhOTA2ZS0wNWU1LTQ2MjUtODcyOS05MDc3MWUwZWU5MzQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e1a3e084-5ffc-4531-9f97-4ab2bcf24a07"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "f2a63b52-aa83-4a5b-b45f-4bf9ccd5b499"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:f2a63b52-aa83-4a5b-b45f-4bf9ccd5b499"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:49 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '356a906e-05e5-4625-8729-90771e0ee934' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/356a906e-05e5-4625-8729-90771e0ee934?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNTZhOTA2ZS0wNWU1LTQ2MjUtODcyOS05MDc3MWUwZWU5MzQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:ca314b89-1515-4675-900b-7f3a5313c509"
        ],
        "x-ms-correlation-request-id": [
          "1ae1b7ce-6178-490e-94ac-55bb88d97665"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:1ae1b7ce-6178-490e-94ac-55bb88d97665"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:49 GMT"
        ],
        "Content-Length": [
          "4290"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not have a maximum password age of 70 days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a maximum password age of 70 days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"MaximumPasswordAge\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"MaximumPasswordAge\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"356a906e-05e5-4625-8729-90771e0ee934\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNThjMjBhNi0zZjllLTRmMGUtOTdmZi1jNmNlNDg1ZTJhYWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f025d663-4a59-4180-882d-45533d501ff4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "ac50db74-56ed-407f-be41-3bbf8e19b4bc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:ac50db74-56ed-407f-be41-3bbf8e19b4bc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '358c20a6-3f9e-4f0e-97ff-c6ce485e2aac' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNThjMjBhNi0zZjllLTRmMGUtOTdmZi1jNmNlNDg1ZTJhYWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:9ca1316c-d4ec-4909-87ca-7a3d0bc6aba3"
        ],
        "x-ms-correlation-request-id": [
          "c00f8005-d1f1-4ced-811b-08f129e38782"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:c00f8005-d1f1-4ced-811b-08f129e38782"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:49 GMT"
        ],
        "Content-Length": [
          "1178"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CORS should not allow every resource to access your API App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Cross origin Resource Sharing (CORS) should not allow all domains to access your API app. Allow only required domains to interact with your API app.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"CorsRestrictionsForApiApp\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNjFjMjA3NC0zNTk1LTRlNWQtOGNhYi00ZjIxZGZmYzgzNWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e9d9fb4b-20a4-49dc-beb2-2c778abf154b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "164bf0a4-1be8-438c-b5c3-c8e27122d967"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:164bf0a4-1be8-438c-b5c3-c8e27122d967"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '361c2074-3595-4e5d-8cab-4f21dffc835c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNjFjMjA3NC0zNTk1LTRlNWQtOGNhYi00ZjIxZGZmYzgzNWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:99e4a6dc-54d4-474b-90cf-8dba773d81b3"
        ],
        "x-ms-correlation-request-id": [
          "f659ced9-042f-4f0a-bf02-ff1385e049a3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:f659ced9-042f-4f0a-bf02-ff1385e049a3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "1651"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Advanced Threat Protection on Storage Accounts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy enables Advanced Threat Protection on Storage Accounts.\",\r\n    \"metadata\": {\r\n      \"category\": \"Storage\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"DeployIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"DeployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/advancedThreatProtectionSettings\",\r\n          \"name\": \"current\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/advancedThreatProtectionSettings/isEnabled\",\r\n            \"equals\": \"true\"\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"storageAccountName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2017-08-01-preview\",\r\n                    \"type\": \"Microsoft.Storage/storageAccounts/providers/advancedThreatProtectionSettings\",\r\n                    \"name\": \"[concat(parameters('storageAccountName'), '/Microsoft.Security/current')]\",\r\n                    \"properties\": {\r\n                      \"isEnabled\": true\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"storageAccountName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"361c2074-3595-4e5d-8cab-4f21dffc835c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNjU3ZjVhMC03NzBlLTQ0YTMtYjQ0ZS05NDMxYmExZTk3MzU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:0455ddc6-ce80-464a-b685-88f5f6ba9d37"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "ae1707a0-862c-4e58-8c09-81c7f0218e08"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205250Z:ae1707a0-862c-4e58-8c09-81c7f0218e08"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3657f5a0-770e-44a3-b44e-9431ba1e9735' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNjU3ZjVhMC03NzBlLTQ0YTMtYjQ0ZS05NDMxYmExZTk3MzU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:91b15eae-6735-4896-8121-c0ce9c850da9"
        ],
        "x-ms-correlation-request-id": [
          "0c6eb1df-bf34-4875-812c-3eb657d2fb83"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:0c6eb1df-bf34-4875-812c-3eb657d2fb83"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "913"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Automation account variables should be encrypted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"It is important to enable encryption of Automation account variable assets when storing sensitive data\",\r\n    \"metadata\": {\r\n      \"category\": \"Automation\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Automation/automationAccounts/variables\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Automation/automationAccounts/variables/isEncrypted\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3657f5a0-770e-44a3-b44e-9431ba1e9735\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNmQ0OWU4Ny00OGM0LTRmMmUtYmVlZC1iYTRlZDAyYjcxZjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ca6e84a4-6572-42dc-908e-620e62ea8b6b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "42922b24-e3bf-42d1-a423-306a90b42953"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:42922b24-e3bf-42d1-a423-306a90b42953"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '36d49e87-48c4-4f2e-beed-ba4ed02b71f5' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zNmQ0OWU4Ny00OGM0LTRmMmUtYmVlZC1iYTRlZDAyYjcxZjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:0ff5c5a8-3c71-4de3-b112-fe1aaf764763"
        ],
        "x-ms-correlation-request-id": [
          "dcc178f9-243e-47b5-8cee-b8b15ba0937c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:dcc178f9-243e-47b5-8cee-b8b15ba0937c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:50 GMT"
        ],
        "Content-Length": [
          "1349"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Threat Detection on SQL servers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy ensures that Threat Detection is enabled on SQL Servers.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"DeployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n          \"name\": \"Default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/securityAlertPolicies.state\",\r\n            \"equals\": \"Enabled\"\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"serverName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                    \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n                    \"apiVersion\": \"2017-03-01-preview\",\r\n                    \"properties\": {\r\n                      \"state\": \"Enabled\",\r\n                      \"emailAccountAdmins\": true\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"serverName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"36d49e87-48c4-4f2e-beed-ba4ed02b71f5\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zN2UwZDJmZS0yOGE1LTQzZDYtYTI3My02N2QzN2QxZjU2MDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:0356a632-21a4-4dca-a44b-e125f4aca2e9"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "37c78461-223d-4f9e-b2d4-02111513c7e4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:37c78461-223d-4f9e-b2d4-02111513c7e4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:51 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '37e0d2fe-28a5-43d6-a273-67d37d1f5606' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zN2UwZDJmZS0yOGE1LTQzZDYtYTI3My02N2QzN2QxZjU2MDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:ae48ced1-748d-4fb7-bb69-a538c9e8ca12"
        ],
        "x-ms-correlation-request-id": [
          "01bf7be8-1944-42b4-91f4-14a7a2ef13d3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:01bf7be8-1944-42b4-91f4-14a7a2ef13d3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:51 GMT"
        ],
        "Content-Length": [
          "1089"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Storage accounts should be migrated to new Azure Resource Manager resources\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use new Azure Resource Manager for your storage accounts to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n    \"metadata\": {\r\n      \"category\": \"Storage\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.classicStorage/storageAccounts\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"37e0d2fe-28a5-43d6-a273-67d37d1f5606\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zODM4NTZmOC1kZTdmLTQ0YTItODFmYy1lNTEzNWI1YzJhYTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:901118f4-4ffa-46d7-9bc7-ec3fe0a11310"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "7142a6bb-c776-4ced-aaa2-69220eb0f103"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:7142a6bb-c776-4ced-aaa2-69220eb0f103"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:51 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '383856f8-de7f-44a2-81fc-e5135b5c2aa4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zODM4NTZmOC1kZTdmLTQ0YTItODFmYy1lNTEzNWI1YzJhYTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:2afe92e8-e9d5-4417-8444-ff06374f662f"
        ],
        "x-ms-correlation-request-id": [
          "63e73ede-f11d-413b-abd2-31cf808d3bc2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205251Z:63e73ede-f11d-413b-abd2-31cf808d3bc2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:51 GMT"
        ],
        "Content-Length": [
          "1681"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in IoT Hub should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Internet of Things\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Devices/IotHubs\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"383856f8-de7f-44a2-81fc-e5135b5c2aa4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zOTY1YzQzZC1iNWY0LTQ4MmUtYjc0YS1kODllZTBlMGIzYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e3340965-b029-4763-a8b5-659801a20642"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "0171826c-d271-4541-89bf-cb845320616a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205252Z:0171826c-d271-4541-89bf-cb845320616a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3965c43d-b5f4-482e-b74a-d89ee0e0b3a8' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zOTY1YzQzZC1iNWY0LTQ4MmUtYjc0YS1kODllZTBlMGIzYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:36e0ebb0-74d3-4221-bcb7-aeb1076f5dea"
        ],
        "x-ms-correlation-request-id": [
          "7cbe20ce-38bb-4831-8961-917ee37520a2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205252Z:7cbe20ce-38bb-4831-8961-917ee37520a2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:51 GMT"
        ],
        "Content-Length": [
          "1325"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Advanced data security settings for SQL managed instance should contain an email address to receive security alerts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Ensure that an email address is provided for the 'Send alerts to' field in the Advanced Data Security server settings. This email address receives alert notifications when anomalous activities are detected on SQL managed instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/managedInstances\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\",\r\n                \"notEquals\": \"\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYWJlYjk0NC0yNmFmLTQzZWUtYjgzZC0zMmFhZjA2MGZiOTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f7d48e11-9736-4b1c-ad9f-18c7bc126855"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "af273351-932f-4b27-a22a-431314f6c4a1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205252Z:af273351-932f-4b27-a22a-431314f6c4a1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3abeb944-26af-43ee-b83d-32aaf060fb94' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYWJlYjk0NC0yNmFmLTQzZWUtYjgzZC0zMmFhZjA2MGZiOTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:7792f797-9727-4b13-85a6-5dbf9dea3a24"
        ],
        "x-ms-correlation-request-id": [
          "50e3b8cc-5a54-4f86-abea-871a46cb4d33"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205252Z:50e3b8cc-5a54-4f86-abea-871a46cb4d33"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "1199"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Pod Security Policies should be defined on Kubernetes Services\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Define Pod Security Policies to reduce the attack vector by removing unnecessary application privileges. It is recommended to configure Pod Security Policies to only allow pods to access the resources which they have permissions to access.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3abeb944-26af-43ee-b83d-32aaf060fb94\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYmUyMmUzYi1kOTE5LTQ3YWEtODA1ZS04OTg1ZGJlYjBhZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:09f17be3-cb6e-4055-96c0-d473f19292ff"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "2e92d743-2fd8-47e6-9147-94c841bcfca2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205252Z:2e92d743-2fd8-47e6-9147-94c841bcfca2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3be22e3b-d919-47aa-805e-8985dbeb0ad9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYmUyMmUzYi1kOTE5LTQ3YWEtODA1ZS04OTg1ZGJlYjBhZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:4bcc1301-1c70-4757-9754-24ec8ccb839c"
        ],
        "x-ms-correlation-request-id": [
          "73babf55-bc90-4edb-82ce-8db55bc1f25f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:73babf55-bc90-4edb-82ce-8db55bc1f25f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "5386"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Dependency Agent for Windows VM Scale Sets (VMSS)\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Dependency Agent for Windows VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"2008-R2-SP1\",\r\n                      \"2008-R2-SP1-smalldisk\",\r\n                      \"2012-Datacenter\",\r\n                      \"2012-Datacenter-smalldisk\",\r\n                      \"2012-R2-Datacenter\",\r\n                      \"2012-R2-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter\",\r\n                      \"2016-Datacenter-Server-Core\",\r\n                      \"2016-Datacenter-Server-Core-smalldisk\",\r\n                      \"2016-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter-with-Containers\",\r\n                      \"2016-Datacenter-with-RDSH\",\r\n                      \"2019-Datacenter\",\r\n                      \"2019-Datacenter-Core\",\r\n                      \"2019-Datacenter-Core-smalldisk\",\r\n                      \"2019-Datacenter-Core-with-Containers\",\r\n                      \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-smalldisk\",\r\n                      \"2019-Datacenter-with-Containers\",\r\n                      \"2019-Datacenter-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-zhcn\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerSemiAnnual\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"Datacenter-Core-1709-smalldisk\",\r\n                      \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                      \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerHPCPack\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016-BYOL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2-BYOL\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftRServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"MLServer-WS2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftVisualStudio\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"VisualStudio\",\r\n                      \"Windows\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftDynamicsAX\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Dynamics\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"windows-data-science-vm\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsDesktop\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Windows-10\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"DependencyAgentWindows\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"DependencyAgent\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                  \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"9.7\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3be22e3b-d919-47aa-805e-8985dbeb0ad9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYzFiMzYyOS1jOGY4LTRiZjYtODYyYy0wMzdjYjkwOTQwMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:faea3915-820e-4d88-abdb-70c2f2192d0e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "f243f2fb-9474-42d5-858b-47d0be5e6d9a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:f243f2fb-9474-42d5-858b-47d0be5e6d9a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3c1b3629-c8f8-4bf6-862c-037cb9094038' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYzFiMzYyOS1jOGY4LTRiZjYtODYyYy0wMzdjYjkwOTQwMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:9530547f-f509-44d7-bdc7-39c7d193fe5d"
        ],
        "x-ms-correlation-request-id": [
          "31b6f07c-eac8-4702-8262-8f31d2fc269e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:31b6f07c-eac8-4702-8262-8f31d2fc269e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "6182"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Windows VM Scale Sets (VMSS)\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Log Analytics Agent for Windows VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\",\r\n          \"assignPermissions\": true\r\n        }\r\n      },\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"2008-R2-SP1\",\r\n                      \"2008-R2-SP1-smalldisk\",\r\n                      \"2012-Datacenter\",\r\n                      \"2012-Datacenter-smalldisk\",\r\n                      \"2012-R2-Datacenter\",\r\n                      \"2012-R2-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter\",\r\n                      \"2016-Datacenter-Server-Core\",\r\n                      \"2016-Datacenter-Server-Core-smalldisk\",\r\n                      \"2016-Datacenter-smalldisk\",\r\n                      \"2016-Datacenter-with-Containers\",\r\n                      \"2016-Datacenter-with-RDSH\",\r\n                      \"2019-Datacenter\",\r\n                      \"2019-Datacenter-Core\",\r\n                      \"2019-Datacenter-Core-smalldisk\",\r\n                      \"2019-Datacenter-Core-with-Containers\",\r\n                      \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-smalldisk\",\r\n                      \"2019-Datacenter-with-Containers\",\r\n                      \"2019-Datacenter-with-Containers-smalldisk\",\r\n                      \"2019-Datacenter-zhcn\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerSemiAnnual\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"in\": [\r\n                      \"Datacenter-Core-1709-smalldisk\",\r\n                      \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                      \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"WindowsServerHPCPack\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2016-BYOL\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"*-WS2012R2-BYOL\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftRServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"MLServer-WS2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftVisualStudio\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"VisualStudio\",\r\n                      \"Windows\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftDynamicsAX\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Dynamics\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"windows-data-science-vm\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsDesktop\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Windows-10\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\r\n            \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"MicrosoftMonitoringAgent\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logAnalytics\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"MMAExtension\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                  \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {\r\n                        \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                        \"stopOnMultipleConnections\": \"true\"\r\n                      },\r\n                      \"protectedSettings\": {\r\n                        \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                      }\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"logAnalytics\": {\r\n                  \"value\": \"[parameters('logAnalytics')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3c1b3629-c8f8-4bf6-862c-037cb9094038\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYzczNWQ4YS1hNGJhLTRhM2EtYjdjZi1kYjc3NTRjZjU3ZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:86d51171-6b1d-409a-a358-69e1db9bc356"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "c9f63516-6d18-4ded-81f1-f40b41030191"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:c9f63516-6d18-4ded-81f1-f40b41030191"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:52 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zYzczNWQ4YS1hNGJhLTRhM2EtYjdjZi1kYjc3NTRjZjU3ZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:291acbb7-7ebc-4d1d-84cd-93b3747783cf"
        ],
        "x-ms-correlation-request-id": [
          "f75665b0-58f6-4446-b120-382f4f7c4dd4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:f75665b0-58f6-4446-b120-382f4f7c4dd4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "1088"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit the OS vulnerabilities on your virtual machine scale sets to protect them from attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"OsVulnerabilities\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zZDg2NDBmYy02M2Y2LTQ3MzQtOGRjYi1jZmQzZDhjNzhmMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:35ca1e10-1e50-488c-9ea2-0dbaa55e7219"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "469acad7-64dd-4189-9979-6eaed7d45268"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:469acad7-64dd-4189-9979-6eaed7d45268"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3d8640fc-63f6-4734-8dcb-cfd3d8c78f38' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zZDg2NDBmYy02M2Y2LTQ3MzQtOGRjYi1jZmQzZDhjNzhmMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:4a8f913d-3b2b-4dd1-b5d1-d0ec77f83758"
        ],
        "x-ms-correlation-request-id": [
          "71f119cd-e3ce-45bb-b990-2ee4eba2b72a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205253Z:71f119cd-e3ce-45bb-b990-2ee4eba2b72a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "2759"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy default Log Analytics Agent for Ubuntu VMs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the selected Log Analytics workspace\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n            \"equals\": \"Canonical\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/imageOffer\",\r\n            \"equals\": \"UbuntuServer\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/imageSKU\",\r\n            \"in\": [\r\n              \"18.04-LTS\",\r\n              \"16.04-LTS\",\r\n              \"16.04.0-LTS\",\r\n              \"14.04.2-LTS\",\r\n              \"12.04.5-LTS\"\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"OmsAgentForLinux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              }\r\n            ]\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logAnalytics\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"apiVersion\": \"2017-12-01\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"type\": \"OmsAgentForLinux\",\r\n                      \"typeHandlerVersion\": \"1.4\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {\r\n                        \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                      },\r\n                      \"protectedSettings\": {\r\n                        \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                      }\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled monitoring for Linux VM', ': ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"logAnalytics\": {\r\n                  \"value\": \"[parameters('logAnalytics')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zZmUzNzAwMi01ZDAwLTRiMzctYTMwMS1kYTA5ZTNhMGNhNjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d211b4a8-4c62-4973-b2dc-7fa5b853f8eb"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "75577b04-c58a-4e83-84e3-1bbaba944edd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:75577b04-c58a-4e83-84e3-1bbaba944edd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '3fe37002-5d00-4b37-a301-da09e3a0ca66' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8zZmUzNzAwMi01ZDAwLTRiMzctYTMwMS1kYTA5ZTNhMGNhNjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:bace453c-17c6-494f-bbef-9dada50a5ef8"
        ],
        "x-ms-correlation-request-id": [
          "a175b5cd-0e50-4cd1-af7e-4d90438020e2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:a175b5cd-0e50-4cd1-af7e-4d90438020e2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "1226"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported PHP Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestPHP\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"3fe37002-5d00-4b37-a301-da09e3a0ca66\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80MDRjMzA4MS1hODU0LTQ0NTctYWUzMC0yNmE5M2VmNjQzZjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9e1ea2e5-3f0f-44ff-919c-f6a577594e60"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "e6d178d9-7ffc-4065-b55f-bc32690403e6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:e6d178d9-7ffc-4065-b55f-bc32690403e6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '404c3081-a854-4457-ae30-26a93ef643f9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/404c3081-a854-4457-ae30-26a93ef643f9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80MDRjMzA4MS1hODU0LTQ0NTctYWUzMC0yNmE5M2VmNjQzZjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:2786168a-1798-4f12-8719-7a3760f8c836"
        ],
        "x-ms-correlation-request-id": [
          "c5f2d798-5fd0-4d36-b37d-0679872bbc36"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:c5f2d798-5fd0-4d36-b37d-0679872bbc36"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "1173"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Secure transfer to storage accounts should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit requirment of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n    \"metadata\": {\r\n      \"category\": \"Storage\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n              \"equals\": \"True\"\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"404c3081-a854-4457-ae30-26a93ef643f9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/428256e6-1fac-4f48-a757-df34c2b3336d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80MjgyNTZlNi0xZmFjLTRmNDgtYTc1Ny1kZjM0YzJiMzMzNmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6c97667a-b480-4004-8b69-738916de2412"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "70433015-443c-477c-b7a8-6f177279d8f7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:70433015-443c-477c-b7a8-6f177279d8f7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:53 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '428256e6-1fac-4f48-a757-df34c2b3336d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/428256e6-1fac-4f48-a757-df34c2b3336d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80MjgyNTZlNi0xZmFjLTRmNDgtYTc1Ny1kZjM0YzJiMzMzNmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:964e81bf-0a58-4fc6-9807-76136f09bd7b"
        ],
        "x-ms-correlation-request-id": [
          "df13a696-5509-4adf-beb8-48ca98423a40"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:df13a696-5509-4adf-beb8-48ca98423a40"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "1679"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Batch accounts should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Batch\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"428256e6-1fac-4f48-a757-df34c2b3336d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NDQ1MjQ4Mi01MjRmLTRiZjQtYjg1Mi0wYmZmN2NjNGEzZWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c759ec9c-4c5d-4c57-ae5b-e5c5e20a3038"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "f4a000ab-0361-4cc3-b25b-c77910fbb731"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:f4a000ab-0361-4cc3-b25b-c77910fbb731"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '44452482-524f-4bf4-b852-0bff7cc4a3ed' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NDQ1MjQ4Mi01MjRmLTRiZjQtYjg1Mi0wYmZmN2NjNGEzZWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:27c0c4ab-d8c8-489f-97a9-c5c3573c8e1d"
        ],
        "x-ms-correlation-request-id": [
          "c87e0edc-cb72-43e0-b263-ced1692da1e3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205254Z:c87e0edc-cb72-43e0-b263-ced1692da1e3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "1146"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Monitor permissive network access in Azure Security Center\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"permissiveNetworkAccess\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"44452482-524f-4bf4-b852-0bff7cc4a3ed\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NjRkYmI4NS0zZDVmLTRhMWQtYmIwOS05NWE5YjVkZDE5Y2Y/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f43ac78a-4e0b-4bc7-abe5-d85680e80a73"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "a768ad52-4f70-41cb-97b5-18bd5335a892"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:a768ad52-4f70-41cb-97b5-18bd5335a892"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NjRkYmI4NS0zZDVmLTRhMWQtYmIwOS05NWE5YjVkZDE5Y2Y/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:af3dcda3-e6b2-4ec5-8faf-5af5b240a57d"
        ],
        "x-ms-correlation-request-id": [
          "30090eef-d2e8-415a-8b29-0e322b091c82"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:30090eef-d2e8-415a-8b29-0e322b091c82"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "586"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require SQL Server version 12.0\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy ensures all SQL servers use version 12.0\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"field\": \"Microsoft.Sql/servers/version\",\r\n              \"equals\": \"12.0\"\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NjU0NGQ3Yi0xZjBkLTQ2ZjUtODFkYS01YzEzNTFkZTFiMDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1f816e54-7dfe-4177-8846-f8f578843607"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "8d6876cb-df27-4586-8d52-7c7d3afc9778"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:8d6876cb-df27-4586-8d52-7c7d3afc9778"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '46544d7b-1f0d-46f5-81da-5c1351de1b06' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NjU0NGQ3Yi0xZjBkLTQ2ZjUtODFkYS01YzEzNTFkZTFiMDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:be8638f6-25c3-4c1e-9dbf-ade13a85fb83"
        ],
        "x-ms-correlation-request-id": [
          "13a8115c-2b7d-4f68-9f03-33ef5076aa51"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:13a8115c-2b7d-4f68-9f03-33ef5076aa51"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:54 GMT"
        ],
        "Content-Length": [
          "1235"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Python Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestPython\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"46544d7b-1f0d-46f5-81da-5c1351de1b06\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NjVmMDE2MS0wMDg3LTQ5MGEtOWFkOS1hZDYyMTdmNGY0M2E/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8ec49817-e78c-44a6-9311-5fbba92e72cf"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "a8814312-ffdd-404f-87ef-2701f9b06aaa"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:a8814312-ffdd-404f-87ef-2701f9b06aaa"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '465f0161-0087-490a-9ad9-ad6217f4f43a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80NjVmMDE2MS0wMDg3LTQ5MGEtOWFkOS1hZDYyMTdmNGY0M2E/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:75d53343-a5d6-457c-aa21-9f0c5019e81d"
        ],
        "x-ms-correlation-request-id": [
          "a25cb03c-f817-4d80-849d-84dd439adf6d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:a25cb03c-f817-4d80-849d-84dd439adf6d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "947"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require automatic OS image patching on Virtual Machine Scale Sets\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgradePolicy.enableAutomaticOSUpgrade\",\r\n            \"notEquals\": \"True\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\",\r\n            \"notEquals\": \"True\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"465f0161-0087-490a-9ad9-ad6217f4f43a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80N2E2YjYwNi01MWFhLTQ0OTYtOGJiNy02NGIxMWNmNjZhZGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ed98dbdd-8a42-41eb-a18d-04f055d43749"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "1a59628b-402e-40a0-b1f3-8812704f3187"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205255Z:1a59628b-402e-40a0-b1f3-8812704f3187"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '47a6b606-51aa-4496-8bb7-64b11cf66adc' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80N2E2YjYwNi01MWFhLTQ0OTYtOGJiNy02NGIxMWNmNjZhZGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:40cdaee1-bb07-4c78-ac34-37e12319bcea"
        ],
        "x-ms-correlation-request-id": [
          "def25771-9c35-4149-b710-bf1d58ec608b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:def25771-9c35-4149-b710-bf1d58ec608b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "1087"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Adaptive Application Controls should be enabled on virtual machines\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Possible Application Whitelist configuration will be monitored by Azure Security Center\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"applicationWhitelisting\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"47a6b606-51aa-4496-8bb7-64b11cf66adc\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ODg5M2I4NC1hMmM4LTRkOWEtYmFkZi04MzVkNWQxYjdkNTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5057c2d6-e58f-4bd4-89a3-ab90ad0212c0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "9a10ceb0-6401-483c-9126-2ccbd6d3353e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:9a10ceb0-6401-483c-9126-2ccbd6d3353e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '48893b84-a2c8-4d9a-badf-835d5d1b7d53' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ODg5M2I4NC1hMmM4LTRkOWEtYmFkZi04MzVkNWQxYjdkNTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:f8ee55ae-19b9-4241-82d0-57599bde195c"
        ],
        "x-ms-correlation-request-id": [
          "f36391f2-8645-4b54-8627-4c90edb5998a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:f36391f2-8645-4b54-8627-4c90edb5998a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "1237"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for an API App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects an API app from common attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"ConfigureIPRestrictions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"48893b84-a2c8-4d9a-badf-835d5d1b7d53\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80OWM4OGZjOC02ZmQxLTQ2ZmQtYTY3Ni1mMTJkMWQzYTRjNzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:adf5b5db-6b1b-4a14-aed8-c87d80488ddc"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "4a1c448b-20c6-40a2-9f1d-a855c24bd804"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:4a1c448b-20c6-40a2-9f1d-a855c24bd804"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '49c88fc8-6fd1-46fd-a676-f12d1d3a4c71' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80OWM4OGZjOC02ZmQxLTQ2ZmQtYTY3Ni1mMTJkMWQzYTRjNzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:6f114a4e-bf65-4d2a-a130-93408fb10480"
        ],
        "x-ms-correlation-request-id": [
          "71464b44-4e19-4795-929f-0d7d6faad557"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:71464b44-4e19-4795-929f-0d7d6faad557"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "1172"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Append tag and its default value to resource groups\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Appends the specified tag and value when any resource group which is missing this tag is created or updated. Does not modify the tags of resource groups created before this policy was applied until those resource groups are changed.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      },\r\n      \"tagValue\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Value\",\r\n          \"description\": \"Value of the tag, such as 'production'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"append\",\r\n        \"details\": [\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"value\": \"[parameters('tagValue')]\"\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/4d1c04de-2172-403f-901b-90608c35c721?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ZDFjMDRkZS0yMTcyLTQwM2YtOTAxYi05MDYwOGMzNWM3MjE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7f29b509-7870-487c-97d0-1f9cedb41be0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "f2b7a170-249a-4f10-a5bd-9877b0c6c6e8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:f2b7a170-249a-4f10-a5bd-9877b0c6c6e8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '4d1c04de-2172-403f-901b-90608c35c721' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/4d1c04de-2172-403f-901b-90608c35c721?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ZDFjMDRkZS0yMTcyLTQwM2YtOTAxYi05MDYwOGMzNWM3MjE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:a7d59718-8eaf-40c9-bec6-37374e123da3"
        ],
        "x-ms-correlation-request-id": [
          "29c478d1-b2e0-44a4-8245-3607746abd21"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205256Z:29c478d1-b2e0-44a4-8245-3607746abd21"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:55 GMT"
        ],
        "Content-Length": [
          "5511"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Linux VMs that do not have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"ApplicationName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"microsoft-aks\",\r\n                  \"AzureDatabricks\",\r\n                  \"qubole-inc\",\r\n                  \"datastax\",\r\n                  \"couchbase\",\r\n                  \"scalegrid\",\r\n                  \"checkpoint\",\r\n                  \"paloaltonetworks\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"CentOS*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"RHEL\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"osa\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"credativ\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Debian\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"7*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Suse\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"SLES*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"11*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"12*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"linux-data-science-vm-ubuntu\",\r\n                      \"azureml\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-altus-centos-os\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"installed_application_linux\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent', '=', concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"installed_application_linux\"\r\n                },\r\n                \"ApplicationName\": {\r\n                  \"value\": \"[parameters('ApplicationName')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ApplicationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\",\r\n                            \"value\": \"[concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforLinux\",\r\n                      \"typeHandlerVersion\": \"1.0\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"4d1c04de-2172-403f-901b-90608c35c721\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ZGEyMTcxMC1jZTZmLTRlMDYtOGNkYi01Y2M0YzkzZmZiZWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:bba8f0db-a871-474b-bb6c-2e277a6299b0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "d4693422-2dfb-42b1-be19-740b3f4c51c6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:d4693422-2dfb-42b1-be19-740b3f4c51c6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '4da21710-ce6f-4e06-8cdb-5cc4c93ffbee' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ZGEyMTcxMC1jZTZmLTRlMDYtOGNkYi01Y2M0YzkzZmZiZWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:9aa8b9aa-fe73-4f39-aeff-8da4da8c0520"
        ],
        "x-ms-correlation-request-id": [
          "8d720dd6-20d5-4344-9218-94199bb0efd1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:8d720dd6-20d5-4344-9218-94199bb0efd1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "4070"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Dependency Agent for Linux VMs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Dependency Agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"14.04.0-LTS\",\r\n                          \"14.04.1-LTS\",\r\n                          \"14.04.5-LTS\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"16.04-LTS\",\r\n                          \"16.04.0-LTS\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"18.04-LTS\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"RHEL\",\r\n                      \"RHEL-SAP-HANA\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"SUSE\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"SLES\",\r\n                      \"SLES-HPC\",\r\n                      \"SLES-HPC-Priority\",\r\n                      \"SLES-SAP\",\r\n                      \"SLES-SAP-BYOS\",\r\n                      \"SLES-Priority\",\r\n                      \"SLES-BYOS\",\r\n                      \"SLES-SAPCAL\",\r\n                      \"SLES-Standard\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"12-SP2\",\r\n                          \"12-SP3\",\r\n                          \"12-SP4\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"CentOS\",\r\n                      \"Centos-LVM\",\r\n                      \"CentOS-SRIOV\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"like\": \"7*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"DependencyAgentLinux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                \"equals\": \"Succeeded\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"DependencyAgent\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                  \"vmExtensionType\": \"DependencyAgentLinux\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"9.6\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ZjExYjU1My1kNDJlLTRlM2EtODliZS0zMmNhMzY0Y2FkNGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:385a0429-2431-4faa-815a-d2223402ecd2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "06cdbabe-6fe8-492e-9968-52e1fc46c4a9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:06cdbabe-6fe8-492e-9968-52e1fc46c4a9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '4f11b553-d42e-4e3a-89be-32ca364cad4c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy80ZjExYjU1My1kNDJlLTRlM2EtODliZS0zMmNhMzY0Y2FkNGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:70555648-7982-40d5-9624-192f08fe3dae"
        ],
        "x-ms-correlation-request-id": [
          "905567aa-5bb7-4143-a790-44457fcbcf6b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:905567aa-5bb7-4143-a790-44457fcbcf6b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "1083"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"A maximum of 3 owners should be designated for your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"It is recommended to designate up to 3 subscription owners in order to reduce the potential for breach by a compromised owner.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"DesignateLessThanXOwners\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"4f11b553-d42e-4e3a-89be-32ca364cad4c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81NzQ0NzEwZS1jYzJmLTRlZTgtODgwOS0zYjExZTg5ZjRiYzk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7e8d106a-8927-4bff-b5de-c94049f5522c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "d090ae10-27b3-4933-994a-28bb0baa132d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:d090ae10-27b3-4933-994a-28bb0baa132d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:56 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5744710e-cc2f-4ee8-8809-3b11e89f4bc9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81NzQ0NzEwZS1jYzJmLTRlZTgtODgwOS0zYjExZTg5ZjRiYzk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:6920737e-3288-492f-87f6-3c2c4a947d08"
        ],
        "x-ms-correlation-request-id": [
          "e7c370a4-eb2a-42e1-9062-05b06cb37e4e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:e7c370a4-eb2a-42e1-9062-05b06cb37e4e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:57 GMT"
        ],
        "Content-Length": [
          "1288"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CORS should not allow every resource to access your Web Application\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Cross origin Resource Sharing (CORS) should not allow all domains to access your web application. Allow only required domains to interact with your web app.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"CorsRestrictionsForWebApplication\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5744710e-cc2f-4ee8-8809-3b11e89f4bc9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YWExMWJiYy01Yzc2LTQzMDItODBlNS1hYmE0NmE0MjgyZTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:0c853e14-f590-403b-ad08-a678a7eee8ff"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "3d76b888-57d7-489c-9793-c87f4ba7de52"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205257Z:3d76b888-57d7-489c-9793-c87f4ba7de52"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:57 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5aa11bbc-5c76-4302-80e5-aba46a4282e7' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YWExMWJiYy01Yzc2LTQzMDItODBlNS1hYmE0NmE0MjgyZTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:3ba2188d-ea8a-4410-af05-f942cfcddfae"
        ],
        "x-ms-correlation-request-id": [
          "b1479599-ffe5-44d4-bbf9-e96fd9c90c38"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:b1479599-ffe5-44d4-bbf9-e96fd9c90c38"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:57 GMT"
        ],
        "Content-Length": [
          "981"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not have a minimum password age of 1 day\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not have a minimum password age of 1 day. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"MinimumPasswordAge\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5aa11bbc-5c76-4302-80e5-aba46a4282e7\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YWViYzhkMS0wMjBkLTQwMzctODlhMC0wMjA0M2E3NTI0ZWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1946e751-625d-4ada-925b-bde2458a7bad"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11991"
        ],
        "x-ms-correlation-request-id": [
          "e63a4a25-c026-4820-9296-bc55837052df"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:e63a4a25-c026-4820-9296-bc55837052df"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5aebc8d1-020d-4037-89a0-02043a7524ec' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YWViYzhkMS0wMjBkLTQwMzctODlhMC0wMjA0M2E3NTI0ZWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:af6a317e-3395-4ad0-a5cf-f52bd70fece8"
        ],
        "x-ms-correlation-request-id": [
          "d1890b5a-7507-4e5e-a8da-35648b95730f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:d1890b5a-7507-4e5e-a8da-35648b95730f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:57 GMT"
        ],
        "Content-Length": [
          "1018"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not restrict the minimum password length to 14 characters. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"MinimumPasswordLength\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5aebc8d1-020d-4037-89a0-02043a7524ec\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81Yjg0MmFjYi0wZmU3LTQxYjAtOWY0MC04ODBlYzRhZDg0ZDg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1a13cffc-f7f7-4ad6-b3f9-89b97c4aacb4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "02be7985-11cb-4ac3-8bae-81595f77078d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:02be7985-11cb-4ac3-8bae-81595f77078d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5b842acb-0fe7-41b0-9f40-880ec4ad84d8' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81Yjg0MmFjYi0wZmU3LTQxYjAtOWY0MC04ODBlYzRhZDg0ZDg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:e227aac9-7a73-4a6b-9608-974ae5cae5c8"
        ],
        "x-ms-correlation-request-id": [
          "b528960c-5508-459f-8fed-e36c56b1bcb8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:b528960c-5508-459f-8fed-e36c56b1bcb8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:57 GMT"
        ],
        "Content-Length": [
          "975"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Linux VMs that have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Linux virtual machines that have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"not_installed_application_linux\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5b842acb-0fe7-41b0-9f40-880ec4ad84d8\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YzNiYzdiOC1hNjRjLTRlMDgtYTljZC03ZmYwZjMxZTExMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c238c331-3a90-43f3-82d7-35850dc843ed"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "9a529b25-e8bb-40d5-be99-6fc44e32124d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:9a529b25-e8bb-40d5-be99-6fc44e32124d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YzNiYzdiOC1hNjRjLTRlMDgtYTljZC03ZmYwZjMxZTExMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:95c164b7-32ae-4bad-85b1-ee1ae95b7f3d"
        ],
        "x-ms-correlation-request-id": [
          "127854c6-b7bc-4057-94c3-b956eb0cb1e2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205258Z:127854c6-b7bc-4057-94c3-b956eb0cb1e2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "5958"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Log Analytics Agent Deployment in VMSS - VM Image (OS) unlisted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Reports VMSS as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude_windows\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      },\r\n      \"listOfImageIdToInclude_linux\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"anyOf\": [\r\n                {\r\n                  \"field\": \"Microsoft.Compute/imageId\",\r\n                  \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                },\r\n                {\r\n                  \"field\": \"Microsoft.Compute/imageId\",\r\n                  \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                },\r\n                {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"2008-R2-SP1\",\r\n                            \"2008-R2-SP1-smalldisk\",\r\n                            \"2012-Datacenter\",\r\n                            \"2012-Datacenter-smalldisk\",\r\n                            \"2012-R2-Datacenter\",\r\n                            \"2012-R2-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter\",\r\n                            \"2016-Datacenter-Server-Core\",\r\n                            \"2016-Datacenter-Server-Core-smalldisk\",\r\n                            \"2016-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter-with-Containers\",\r\n                            \"2016-Datacenter-with-RDSH\",\r\n                            \"2019-Datacenter\",\r\n                            \"2019-Datacenter-Core\",\r\n                            \"2019-Datacenter-Core-smalldisk\",\r\n                            \"2019-Datacenter-Core-with-Containers\",\r\n                            \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-smalldisk\",\r\n                            \"2019-Datacenter-with-Containers\",\r\n                            \"2019-Datacenter-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-zhcn\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerSemiAnnual\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"Datacenter-Core-1709-smalldisk\",\r\n                            \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                            \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerHPCPack\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftSQLServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016-BYOL\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2-BYOL\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftRServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"MLServer-WS2016\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftVisualStudio\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"VisualStudio\",\r\n                            \"Windows\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftDynamicsAX\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Dynamics\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"microsoft-ads\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"windows-data-science-vm\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsDesktop\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Windows-10\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"RedHat\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"RHEL\",\r\n                        \"RHEL-SAP-HANA\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"SUSE\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"SLES\",\r\n                        \"SLES-HPC\",\r\n                        \"SLES-HPC-Priority\",\r\n                        \"SLES-SAP\",\r\n                        \"SLES-SAP-BYOS\",\r\n                        \"SLES-Priority\",\r\n                        \"SLES-BYOS\",\r\n                        \"SLES-SAPCAL\",\r\n                        \"SLES-Standard\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"12*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Canonical\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"UbuntuServer\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"14.04*LTS\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"16.04*LTS\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"18.04*LTS\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Oracle\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"Oracle-Linux\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7.*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"OpenLogic\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"CentOS\",\r\n                        \"Centos-LVM\",\r\n                        \"CentOS-SRIOV\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"cloudera\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"cloudera-centos-os\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSKU\",\r\n                      \"like\": \"7*\"\r\n                    }\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"auditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n            \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YzYwN2EyZS1jNzAwLTQ3NDQtODI1NC1kNzdlN2M5ZWI1ZTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:13b27b9d-eb01-4685-98a4-cca53bbc4662"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "510920a1-5913-4339-b319-b348fa000b9d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:510920a1-5913-4339-b319-b348fa000b9d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5c607a2e-c700-4744-8254-d77e7c9eb5e4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81YzYwN2EyZS1jNzAwLTQ3NDQtODI1NC1kNzdlN2M5ZWI1ZTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:8bd68d1b-fd93-409f-854d-398b5f14ced7"
        ],
        "x-ms-correlation-request-id": [
          "84de4579-181f-4b9e-b980-271317d8de93"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:84de4579-181f-4b9e-b980-271317d8de93"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "1112"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"External accounts with write permissions should be removed from your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"External accounts with write privileges should be removed from your subscription in order to prevent unmonitored access.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoveExternalAccountsWithWritePermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5c607a2e-c700-4744-8254-d77e7c9eb5e4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZGY4MmY0Zi03NzNhLTRhMmQtOTdhMi00MjJhODA2ZjFhNTU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:05682a6e-d00e-4dbd-8732-afabc6638bd0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "9c91ddf6-809a-45c5-bc23-3bbc4ab78040"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:9c91ddf6-809a-45c5-bc23-3bbc4ab78040"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5df82f4f-773a-4a2d-97a2-422a806f1a55' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZGY4MmY0Zi03NzNhLTRhMmQtOTdhMi00MjJhODA2ZjFhNTU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:cdd8370f-7738-4d94-bfc6-708ff4194dff"
        ],
        "x-ms-correlation-request-id": [
          "49189a5e-333b-4372-ab86-3760cb41d834"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:49189a5e-333b-4372-ab86-3760cb41d834"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "1214"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Function App should only be accessible over HTTPS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"OnlyHttpsForFunctionApp\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5df82f4f-773a-4a2d-97a2-422a806f1a55\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZTMzMTVlMC1hNDE0LTRlZmItYTRkMi1jN2JkMmIwNDQzZDI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:bbf12336-5aa0-499c-abd1-ee5329fe8acb"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "c81a17b7-2ae0-41ab-a6c9-83528f52fd09"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:c81a17b7-2ae0-41ab-a6c9-83528f52fd09"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5e3315e0-a414-4efb-a4d2-c7bd2b0443d2' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZTMzMTVlMC1hNDE0LTRlZmItYTRkMi1jN2JkMmIwNDQzZDI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:e66f5277-db7c-4df8-a6b7-ea68ca513942"
        ],
        "x-ms-correlation-request-id": [
          "0d79ab60-754e-4ff8-8b11-a6bb03eacda8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:0d79ab60-754e-4ff8-8b11-a6bb03eacda8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "1327"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported .NET Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestDotNet\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5e3315e0-a414-4efb-a4d2-c7bd2b0443d2\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZTM5Mzc5OS1lM2NhLTRlNDMtYTlhNS0wZWM0NjQ4YTU3ZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d1844b09-244e-4f02-a425-a8f030d051c1"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "e45cf68b-75f1-4f50-bf3d-2ca56aeacdb6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:e45cf68b-75f1-4f50-bf3d-2ca56aeacdb6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5e393799-e3ca-4e43-a9a5-0ec4648a57d9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZTM5Mzc5OS1lM2NhLTRlNDMtYTlhNS0wZWM0NjQ4YTU3ZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:5f7aeb4b-74b2-426a-8c76-c49325c870c6"
        ],
        "x-ms-correlation-request-id": [
          "b3e5a331-5a51-457f-8051-c12243e3b993"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205259Z:b3e5a331-5a51-457f-8051-c12243e3b993"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:58 GMT"
        ],
        "Content-Length": [
          "984"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that do not have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WhitelistedApplication\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5e393799-e3ca-4e43-a9a5-0ec4648a57d9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZWU4NWNlNS1lN2ViLTQ0ZDYtYjRhMi0zMmEyNGJlMWNhNTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f08ef35e-de62-4e33-a120-8faa3b6c4ac0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "6b088708-b2aa-4c1d-9bf1-836eab6b3c82"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:6b088708-b2aa-4c1d-9bf1-836eab6b3c82"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZWU4NWNlNS1lN2ViLTQ0ZDYtYjRhMi0zMmEyNGJlMWNhNTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:a662543a-b552-4348-85fe-6c455acf52b7"
        ],
        "x-ms-correlation-request-id": [
          "0449b64a-92ba-4c63-8d89-a2df25fc1f45"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:0449b64a-92ba-4c63-8d89-a2df25fc1f45"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "619"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation only in India data centers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation in the following locations only: West India, South India, Central India\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"location\",\r\n          \"in\": [\r\n            \"westindia\",\r\n            \"southindia\",\r\n            \"centralindia\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZWU5ZTllZC0wYjQyLTQxYjctOGM5Yy0zY2ZiMmZiZTIwNjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c87ccd35-20bf-435a-a84e-ae3b23ea6c20"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "29f8f7dc-2b9f-4827-9a1f-865326d09cc4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:29f8f7dc-2b9f-4827-9a1f-865326d09cc4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81ZWU5ZTllZC0wYjQyLTQxYjctOGM5Yy0zY2ZiMmZiZTIwNjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:3c6fcbba-91d7-4b9b-8257-fb7589531b19"
        ],
        "x-ms-correlation-request-id": [
          "447936e1-c3cf-46fb-a5df-ac1e5f0724ba"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:447936e1-c3cf-46fb-a5df-ac1e5f0724ba"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "5198"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Log Analytics Agent for Linux VM Scale Sets (VMSS)\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Log Analytics Agent for Linux VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\",\r\n          \"assignPermissions\": true\r\n        }\r\n      },\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"RHEL\",\r\n                      \"RHEL-SAP-HANA\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"SUSE\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"SLES\",\r\n                      \"SLES-HPC\",\r\n                      \"SLES-HPC-Priority\",\r\n                      \"SLES-SAP\",\r\n                      \"SLES-SAP-BYOS\",\r\n                      \"SLES-Priority\",\r\n                      \"SLES-BYOS\",\r\n                      \"SLES-SAPCAL\",\r\n                      \"SLES-Standard\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"12*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"14.04*LTS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"16.04*LTS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"18.04*LTS\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Oracle\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Oracle-Linux\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7.*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"CentOS\",\r\n                      \"Centos-LVM\",\r\n                      \"CentOS-SRIOV\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"like\": \"7*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\r\n            \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"OmsAgentForLinux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logAnalytics\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"MMAExtension\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                  \"vmExtensionType\": \"OmsAgentForLinux\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"1.7\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {\r\n                        \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                        \"stopOnMultipleConnections\": \"true\"\r\n                      },\r\n                      \"protectedSettings\": {\r\n                        \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                      }\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"logAnalytics\": {\r\n                  \"value\": \"[parameters('logAnalytics')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81Zjc2Y2Y4OS1mYmYyLTQ3ZmQtYTNmNC1iODkxZmE3ODBiNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8d22cb13-a4a1-4333-8200-23a5ee1106a5"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "a506dee7-6bce-4f78-9a50-64b7677fb03e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:a506dee7-6bce-4f78-9a50-64b7677fb03e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5f76cf89-fbf2-47fd-a3f4-b891fa780b60' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81Zjc2Y2Y4OS1mYmYyLTQ3ZmQtYTNmNC1iODkxZmE3ODBiNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:8d572322-cf8b-495a-ab70-28febfeca408"
        ],
        "x-ms-correlation-request-id": [
          "e057dcec-8990-4964-ab44-befff381d670"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:e057dcec-8990-4964-ab44-befff381d670"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "1109"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"External accounts with read permissions should be removed from your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"External accounts with read privileges should be removed from your subscription in order to prevent unmonitored access.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoveExternalAccountsWithReadPermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5f76cf89-fbf2-47fd-a3f4-b891fa780b60\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82MGZmZTNlMi00NjA0LTQ0NjAtOGYyMi0wZjFkYTA1ODI2NmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:fd349d39-a83f-4764-82d5-cce99a050cb8"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "72f380bc-4fd7-4670-8340-d067d5542522"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:72f380bc-4fd7-4670-8340-d067d5542522"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '60ffe3e2-4604-4460-8f22-0f1da058266c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82MGZmZTNlMi00NjA0LTQ0NjAtOGYyMi0wZjFkYTA1ODI2NmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:5f4957b0-65d1-4140-be9f-4f1029278fc6"
        ],
        "x-ms-correlation-request-id": [
          "31936375-407f-46d1-90a4-60a3f27e2848"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:31936375-407f-46d1-90a4-60a3f27e2848"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:52:59 GMT"
        ],
        "Content-Length": [
          "997"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows web servers that are not using secure communication protocols\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"AuditSecureProtocol\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"60ffe3e2-4604-4460-8f22-0f1da058266c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/6134c3db-786f-471e-87bc-8f479dc890f6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82MTM0YzNkYi03ODZmLTQ3MWUtODdiYy04ZjQ3OWRjODkwZjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:576b211b-47dd-4859-a309-e78ccb99f7a1"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "4b3eaf6e-e4d1-4ea2-a0d5-eca287c872cd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205300Z:4b3eaf6e-e4d1-4ea2-a0d5-eca287c872cd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '6134c3db-786f-471e-87bc-8f479dc890f6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/6134c3db-786f-471e-87bc-8f479dc890f6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82MTM0YzNkYi03ODZmLTQ3MWUtODdiYy04ZjQ3OWRjODkwZjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:26b57d40-229b-4c00-b134-c9a01451c607"
        ],
        "x-ms-correlation-request-id": [
          "a7a54ace-6f62-4fa9-82c3-475fd1982f21"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:a7a54ace-6f62-4fa9-82c3-475fd1982f21"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "2972"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Advanced Data Security on SQL servers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy enables Advanced Data Security on SQL Servers. This includes turning on Threat Detection and Vulnerability Assessment. It will automatically create a storage account in the same region and resource group as the SQL server to store scan results, with a 'sqlva' prefix.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"DeployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n          \"name\": \"Default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/securityAlertPolicies.state\",\r\n            \"equals\": \"Enabled\"\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\r\n            \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"serverName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"serverResourceGroupName\": \"[resourceGroup().name]\",\r\n                  \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                  \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), variables('serverResourceGroupName'), parameters('location'))]\",\r\n                  \"storageName\": \"[tolower(concat('sqlva', variables('uniqueStorage')))]\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                    \"name\": \"[variables('storageName')]\",\r\n                    \"apiVersion\": \"2016-01-01\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"sku\": {\r\n                      \"name\": \"Standard_LRS\"\r\n                    },\r\n                    \"kind\": \"Storage\",\r\n                    \"properties\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                    \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n                    \"apiVersion\": \"2017-03-01-preview\",\r\n                    \"properties\": {\r\n                      \"state\": \"Enabled\",\r\n                      \"emailAccountAdmins\": true\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                    \"type\": \"Microsoft.Sql/servers/vulnerabilityAssessments\",\r\n                    \"apiVersion\": \"2018-06-01-preview\",\r\n                    \"properties\": {\r\n                      \"storageContainerPath\": \"[concat(reference(resourceId('Microsoft.Storage/storageAccounts', variables('storageName'))).primaryEndpoints.blob, 'vulnerability-assessment')]\",\r\n                      \"storageAccountAccessKey\": \"[listKeys(resourceId('Microsoft.Storage/storageAccounts', variables('storageName')), '2018-02-01').keys[0].value]\",\r\n                      \"recurringScans\": {\r\n                        \"isEnabled\": true,\r\n                        \"emailSubscriptionAdmins\": true,\r\n                        \"emails\": []\r\n                      }\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Storage/storageAccounts/', variables('storageName'))]\",\r\n                      \"[concat('Microsoft.Sql/servers/', parameters('serverName'), '/securityAlertPolicies/Default')]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"serverName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"6134c3db-786f-471e-87bc-8f479dc890f6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/617c02be-7f02-4efd-8836-3180d47b6c68?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82MTdjMDJiZS03ZjAyLTRlZmQtODgzNi0zMTgwZDQ3YjZjNjg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e1f79eab-7124-4e31-baa6-42ae9e6f101a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "9aa9692c-759a-4a14-8c89-f7303ad4f6cf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:9aa9692c-759a-4a14-8c89-f7303ad4f6cf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '617c02be-7f02-4efd-8836-3180d47b6c68' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/617c02be-7f02-4efd-8836-3180d47b6c68?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82MTdjMDJiZS03ZjAyLTRlZmQtODgzNi0zMTgwZDQ3YjZjNjg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:92a96b3c-e07b-4dda-a440-60fc3f0d3603"
        ],
        "x-ms-correlation-request-id": [
          "f30011d2-c2ed-41ac-a0d8-e989c00daa22"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:f30011d2-c2ed-41ac-a0d8-e989c00daa22"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "1339"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Service Fabric provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node communication using a primary cluster certificate. Set the protection level to ensure that all node-to-node messages are encrypted and digitally signed\",\r\n    \"metadata\": {\r\n      \"category\": \"Service Fabric\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceFabric/clusters\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.ServiceFabric/clusters/fabricSettings[*].name\",\r\n                \"notEquals\": \"Security\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name\",\r\n                \"notEquals\": \"ClusterProtectionLevel\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value\",\r\n                \"notEquals\": \"EncryptAndSign\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"617c02be-7f02-4efd-8836-3180d47b6c68\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/655cb504-bcee-4362-bd4c-402e6aa38759?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82NTVjYjUwNC1iY2VlLTQzNjItYmQ0Yy00MDJlNmFhMzg3NTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6f3f1b9f-5b40-47b6-8205-ae7711f97626"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "c79ba2ce-98be-41d5-b2ad-11df81a1ed65"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:c79ba2ce-98be-41d5-b2ad-11df81a1ed65"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:00 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '655cb504-bcee-4362-bd4c-402e6aa38759' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/655cb504-bcee-4362-bd4c-402e6aa38759?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82NTVjYjUwNC1iY2VlLTQzNjItYmQ0Yy00MDJlNmFhMzg3NTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:8c299a71-f95c-4a64-bf25-14fb6a5650da"
        ],
        "x-ms-correlation-request-id": [
          "021b76b2-3fda-43b3-ac84-b0372560309a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:021b76b2-3fda-43b3-ac84-b0372560309a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "946"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit missing blob encryption for storage accounts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy is no longer necessary because storage blob encryption is enabled by default and cannot be turned off.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n              \"equals\": \"True\"\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"655cb504-bcee-4362-bd4c-402e6aa38759\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/664346d9-be92-43fb-a219-d595eeb76a90?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82NjQzNDZkOS1iZTkyLTQzZmItYTIxOS1kNTk1ZWViNzZhOTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:519f5caa-84bd-4819-84c6-db6fd9ae0ce2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "6808b9fc-eb5b-4e40-93a2-0c5b039995e6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:6808b9fc-eb5b-4e40-93a2-0c5b039995e6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '664346d9-be92-43fb-a219-d595eeb76a90' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/664346d9-be92-43fb-a219-d595eeb76a90?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82NjQzNDZkOS1iZTkyLTQzZmItYTIxOS1kNTk1ZWViNzZhOTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:08202acf-ccb8-4c20-a6be-30fbb0fbaa39"
        ],
        "x-ms-correlation-request-id": [
          "a562b8e2-77b6-4000-9ad2-684ea56db51c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:a562b8e2-77b6-4000-9ad2-684ea56db51c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "1320"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for a Function App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects a Function app from common attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"ConfigureIPRestrictions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"664346d9-be92-43fb-a219-d595eeb76a90\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/68511db2-bd02-41c4-ae6b-1900a012968a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82ODUxMWRiMi1iZDAyLTQxYzQtYWU2Yi0xOTAwYTAxMjk2OGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:692fe63b-ef5e-47d0-8126-ff8f2770b01b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "9634444e-c455-4319-8d0c-55d4dae4641e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205301Z:9634444e-c455-4319-8d0c-55d4dae4641e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '68511db2-bd02-41c4-ae6b-1900a012968a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/68511db2-bd02-41c4-ae6b-1900a012968a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82ODUxMWRiMi1iZDAyLTQxYzQtYWU2Yi0xOTAwYTAxMjk2OGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:7917c5a9-c3ba-4beb-9a81-786b6578cff8"
        ],
        "x-ms-correlation-request-id": [
          "3ad6a450-7b89-4c3f-b7fb-fcc3277a04cd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:3ad6a450-7b89-4c3f-b7fb-fcc3277a04cd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "5030"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs on which the Log Analytics agent is not connected as expected\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"WorkspaceId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Connected workspace IDs\",\r\n          \"description\": \"A semicolon-separated list of the workspace IDs that the Log Analytics agent should be connected to\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsLogAnalyticsAgentConnection\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId', '=', parameters('WorkspaceId')))]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsLogAnalyticsAgentConnection\"\r\n                },\r\n                \"WorkspaceId\": {\r\n                  \"value\": \"[parameters('WorkspaceId')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"WorkspaceId\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId\",\r\n                            \"value\": \"[parameters('WorkspaceId')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/68511db2-bd02-41c4-ae6b-1900a012968a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"68511db2-bd02-41c4-ae6b-1900a012968a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YTdhMmJjZi1mOWJlLTRlMzUtOTczNC00Zjk2NTdhNzBmMWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:55ecb36d-7ee6-4c78-94a3-1b5cf2d78f80"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "67531b50-d30e-47bb-a2c3-99ab761ed01e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:67531b50-d30e-47bb-a2c3-99ab761ed01e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '6a7a2bcf-f9be-4e35-9734-4f9657a70f1d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YTdhMmJjZi1mOWJlLTRlMzUtOTczNC00Zjk2NTdhNzBmMWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:c19a387c-a308-49a2-b2e1-c24dea4ca905"
        ],
        "x-ms-correlation-request-id": [
          "9d434064-8c53-4932-9048-4f269e18314d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:9d434064-8c53-4932-9048-4f269e18314d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "5514"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which Windows Defender Exploit Guard is not enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"NotAvailableMachineState\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"State in which to show VMs on which Windows Defender Exploit Guard is not available\",\r\n          \"description\": \"Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to 'Non-Compliant' will make machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) non-compliant. Setting this value to 'Compliant' will make these machines compliant.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Compliant\",\r\n          \"Non-Compliant\"\r\n        ],\r\n        \"defaultValue\": \"Non-Compliant\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsDefenderExploitGuard\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState', '=', parameters('NotAvailableMachineState')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsDefenderExploitGuard\"\r\n                },\r\n                \"NotAvailableMachineState\": {\r\n                  \"value\": \"[parameters('NotAvailableMachineState')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"NotAvailableMachineState\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\",\r\n                            \"value\": \"[parameters('NotAvailableMachineState')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YTg0NTBlMi02YzYxLTQzYjQtYmU2NS02MmUzYTE5N2JmZmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8e94ae6c-c5c8-490a-8a46-aebd1a382f46"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "49e83b48-8574-4a84-bd0a-a9bae033d900"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:49e83b48-8574-4a84-bd0a-a9bae033d900"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '6a8450e2-6c61-43b4-be65-62e3a197bffe' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YTg0NTBlMi02YzYxLTQzYjQtYmU2NS02MmUzYTE5N2JmZmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:41f6d447-4fb6-4a22-880f-384da76b4a09"
        ],
        "x-ms-correlation-request-id": [
          "91540493-e0ad-4612-a9e5-9389de3717b3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:91540493-e0ad-4612-a9e5-9389de3717b3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "1337"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for a Web Application\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects a web application from common attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"ConfigureIPRestrictions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"6a8450e2-6c61-43b4-be65-62e3a197bffe\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YjFjYmY1NS1lOGI2LTQ0MmYtYmE0Yy03MjQ2YjYzODE0NzQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:48118afe-2463-4951-92cb-a81f998a7020"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "e8085f23-f88c-4ed5-bd88-8c9d2e088652"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:e8085f23-f88c-4ed5-bd88-8c9d2e088652"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:01 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '6b1cbf55-e8b6-442f-ba4c-7246b6381474' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YjFjYmY1NS1lOGI2LTQ0MmYtYmE0Yy03MjQ2YjYzODE0NzQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:cb39adb3-d9eb-4efd-ad78-ccd47ca794ca"
        ],
        "x-ms-correlation-request-id": [
          "b5fcbcfa-84d9-44f8-b202-1beec3121535"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:b5fcbcfa-84d9-44f8-b202-1beec3121535"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "1089"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deprecated accounts should be removed from your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Deprecated accounts should be removed from your subscriptions.  Deprecated accounts are accounts that have been blocked from signing in.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoveDeprecatedAccounts\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"6b1cbf55-e8b6-442f-ba4c-7246b6381474\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YzExMmQ0ZS01YmM3LTQ3YWUtYTA0MS1lYTJkOWRjY2Q3NDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:498d062b-31b8-4abc-beea-8f6629a60758"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "f44d44d6-66f0-4ab3-9b60-40c2e6ab1576"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:f44d44d6-66f0-4ab3-9b60-40c2e6ab1576"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '6c112d4e-5bc7-47ae-a041-ea2d9dccd749' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82YzExMmQ0ZS01YmM3LTQ3YWUtYTA0MS1lYTJkOWRjY2Q3NDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:60402f98-37f7-4e8d-b64a-d1f85ef575d3"
        ],
        "x-ms-correlation-request-id": [
          "93422776-8f58-47fe-957a-9fbefa58e722"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205302Z:93422776-8f58-47fe-957a-9fbefa58e722"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "763"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Not allowed resource types\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfResourceTypesNotAllowed\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"description\": \"The list of resource types that cannot be deployed.\",\r\n          \"displayName\": \"Not allowed resource types\",\r\n          \"strongType\": \"resourceTypes\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82ZmRiOTIwNS0zNDYyLTRjZmMtODdkOC0xNmM3ODYwYjUzZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:45e7657e-5f67-4d81-9230-f1b969960f4a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "b2e070a0-9514-434c-a97c-129fdd1e3ffd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205303Z:b2e070a0-9514-434c-a97c-129fdd1e3ffd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '6fdb9205-3462-4cfc-87d8-16c7860b53f4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy82ZmRiOTIwNS0zNDYyLTRjZmMtODdkOC0xNmM3ODYwYjUzZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:0a8bddb8-35fb-4431-bbc7-500d50341976"
        ],
        "x-ms-correlation-request-id": [
          "7625c51a-fe76-4f25-b40a-847ef2ebc55b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205303Z:7625c51a-fe76-4f25-b40a-847ef2ebc55b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:03 GMT"
        ],
        "Content-Length": [
          "587"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"location\",\r\n          \"in\": [\r\n            \"japaneast\",\r\n            \"japanwest\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"6fdb9205-3462-4cfc-87d8-16c7860b53f4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83MjI3ZWJlNS05ZmY3LTQ3YWItYjgyMy0xNzFjZDAyZmI5MGY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9152aa6a-e3f7-4209-9362-e7dc83553db9"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "66d929e5-e42d-4109-bc8c-f13c2a22ab16"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205303Z:66d929e5-e42d-4109-bc8c-f13c2a22ab16"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7227ebe5-9ff7-47ab-b823-171cd02fb90f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83MjI3ZWJlNS05ZmY3LTQ3YWItYjgyMy0xNzFjZDAyZmI5MGY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:f04ab899-8f03-42f4-b645-34400d1e2143"
        ],
        "x-ms-correlation-request-id": [
          "e76534d8-982a-47c6-a550-11632740ab57"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205303Z:e76534d8-982a-47c6-a550-11632740ab57"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:02 GMT"
        ],
        "Content-Length": [
          "1066"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs on which the DSC configuration is not compliant\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsDscConfiguration\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7227ebe5-9ff7-47ab-b823-171cd02fb90f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83MjY2NzFhYy1jNGRlLTQ5MDgtOGM3ZC02MDQzYWU2MmUzYjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e822734a-adff-4ac9-9a0c-525759a1ccc2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "810dc63a-358d-4409-94a3-e3b6a63076b5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:810dc63a-358d-4409-94a3-e3b6a63076b5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:03 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '726671ac-c4de-4908-8c7d-6043ae62e3b6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83MjY2NzFhYy1jNGRlLTQ5MDgtOGM3ZC02MDQzYWU2MmUzYjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "02805b97-b00c-4443-a432-82f262b5158e"
        ],
        "x-ms-request-id": [
          "westus:d8249e92-54af-4bef-86ad-80684780ba60"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:02805b97-b00c-4443-a432-82f262b5158e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:03 GMT"
        ],
        "Content-Length": [
          "4290"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that allow re-use of the previous 24 passwords\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that allow re-use of the previous 24 passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"EnforcePasswordHistory\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"EnforcePasswordHistory\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"726671ac-c4de-4908-8c7d-6043ae62e3b6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NDMzYzEwNy02ZGI0LTRhZDEtYjU3YS1hNzZkY2UwMTU0YTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:703f0477-8ea2-4a6d-b851-9130e2b3d0e5"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "4aa39e9d-4a72-4d39-b94a-77419e942621"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:4aa39e9d-4a72-4d39-b94a-77419e942621"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7433c107-6db4-4ad1-b57a-a76dce0154a1' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NDMzYzEwNy02ZGI0LTRhZDEtYjU3YS1hNzZkY2UwMTU0YTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:1d17f5ec-23e5-4aeb-9377-92bb9e6d3e26"
        ],
        "x-ms-correlation-request-id": [
          "3f6b99c3-531e-4377-b6ca-0264e484ff05"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:3f6b99c3-531e-4377-b6ca-0264e484ff05"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:03 GMT"
        ],
        "Content-Length": [
          "866"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allowed storage account SKUs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy enables you to specify a set of storage account SKUs that your organization can deploy.\",\r\n    \"metadata\": {\r\n      \"category\": \"Storage\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfAllowedSKUs\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n          \"displayName\": \"Allowed SKUs\",\r\n          \"strongType\": \"StorageSKUs\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n              \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7433c107-6db4-4ad1-b57a-a76dce0154a1\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/752c6934-9bcc-4749-b004-655e676ae2ac?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NTJjNjkzNC05YmNjLTQ3NDktYjAwNC02NTVlNjc2YWUyYWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6a632e91-7ba8-4fcd-b14c-9223e42c4c4a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "fa610b91-54ed-40f1-8d0f-1fd5951d5269"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:fa610b91-54ed-40f1-8d0f-1fd5951d5269"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '752c6934-9bcc-4749-b004-655e676ae2ac' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/752c6934-9bcc-4749-b004-655e676ae2ac?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NTJjNjkzNC05YmNjLTQ3NDktYjAwNC02NTVlNjc2YWUyYWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:956ef50c-79e2-481c-893e-a5103ca211e7"
        ],
        "x-ms-correlation-request-id": [
          "f81c3be0-7825-4405-b9ed-6def043fa851"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:f81c3be0-7825-4405-b9ed-6def043fa851"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "1209"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit enabling of diagnostic logs in App Services\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit enabling of diagnostic logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"App Service\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Web/sites/config\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"web\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/config/detailedErrorLoggingEnabled\",\r\n                \"notEquals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/config/httpLoggingEnabled\",\r\n                \"notEquals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/config/requestTracingEnabled\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"752c6934-9bcc-4749-b004-655e676ae2ac\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/760a85ff-6162-42b3-8d70-698e268f648c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NjBhODVmZi02MTYyLTQyYjMtOGQ3MC02OThlMjY4ZjY0OGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:3c88aa0c-5dbc-4cdc-9c05-d003036dc39c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "1687600f-2a39-4047-8359-333f0ffd6b46"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205304Z:1687600f-2a39-4047-8359-333f0ffd6b46"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '760a85ff-6162-42b3-8d70-698e268f648c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/760a85ff-6162-42b3-8d70-698e268f648c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NjBhODVmZi02MTYyLTQyYjMtOGQ3MC02OThlMjY4ZjY0OGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:1d85ec9d-4444-4bed-999a-06fdaa4d0e13"
        ],
        "x-ms-correlation-request-id": [
          "088e5e2f-6c28-4487-96f0-eb3a83bd332c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:088e5e2f-6c28-4487-96f0-eb3a83bd332c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "1175"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Vulnerabilities should be remediated by a Vulnerability Assessment solution\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Monitors vulnerabilities detected by Vulnerability Assessment solution and VMs without a Vulnerability Assessment solution in Azure Security Center as recommendations.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"vulnerabilityAssessment\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"760a85ff-6162-42b3-8d70-698e268f648c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NjUyNjZhYi1lNDBlLTRjNjEtYmNiMi01YTUyNzVkMGI3YzA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:b7d708e2-e1bc-4ee1-914c-22534735dbf6"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "ccb2f358-acb8-449c-a066-65b6de5a742d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:ccb2f358-acb8-449c-a066-65b6de5a742d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:05 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '765266ab-e40e-4c61-bcb2-5a5275d0b7c0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83NjUyNjZhYi1lNDBlLTRjNjEtYmNiMi01YTUyNzVkMGI3YzA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:4cd67486-4c84-42fc-8ca9-26ec35b66718"
        ],
        "x-ms-correlation-request-id": [
          "8fe97740-b6de-43dc-9915-1afb0e0af762"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:8fe97740-b6de-43dc-9915-1afb0e0af762"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "4223"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy Dependency Agent for Linux VM Scale Sets (VMSS)\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploy Dependency Agent for Linux VM Scale Sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageId\",\r\n                \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"14.04.0-LTS\",\r\n                          \"14.04.1-LTS\",\r\n                          \"14.04.5-LTS\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"16.04-LTS\",\r\n                          \"16.04.0-LTS\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"18.04-LTS\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"RHEL\",\r\n                      \"RHEL-SAP-HANA\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"SUSE\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"SLES\",\r\n                      \"SLES-HPC\",\r\n                      \"SLES-HPC-Priority\",\r\n                      \"SLES-SAP\",\r\n                      \"SLES-SAP-BYOS\",\r\n                      \"SLES-Priority\",\r\n                      \"SLES-BYOS\",\r\n                      \"SLES-SAPCAL\",\r\n                      \"SLES-Standard\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"12-SP2\",\r\n                          \"12-SP3\",\r\n                          \"12-SP4\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"CentOS\",\r\n                      \"Centos-LVM\",\r\n                      \"CentOS-SRIOV\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"6.*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"like\": \"7*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"DependencyAgentLinux\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"vmExtensionName\": \"DependencyAgent\",\r\n                  \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                  \"vmExtensionType\": \"DependencyAgentLinux\",\r\n                  \"vmExtensionTypeHandlerVersion\": \"9.7\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                    \"apiVersion\": \"2018-06-01\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                      \"type\": \"[variables('vmExtensionType')]\",\r\n                      \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"765266ab-e40e-4c61-bcb2-5a5275d0b7c0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7a031c68-d6ab-406e-a506-697a19c634b0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83YTAzMWM2OC1kNmFiLTQwNmUtYTUwNi02OTdhMTljNjM0YjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:191a543f-773b-480c-a146-2120c7399e7a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "a0c1787d-9dac-410c-b08c-1ba038e47025"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:a0c1787d-9dac-410c-b08c-1ba038e47025"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:04 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7a031c68-d6ab-406e-a506-697a19c634b0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7a031c68-d6ab-406e-a506-697a19c634b0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83YTAzMWM2OC1kNmFiLTQwNmUtYTUwNi02OTdhMTljNjM0YjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:3fcffcf7-52c6-48ca-bf44-43ab57bea841"
        ],
        "x-ms-correlation-request-id": [
          "e453115f-5366-48d0-8e52-3083d73d6358"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:e453115f-5366-48d0-8e52-3083d73d6358"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:05 GMT"
        ],
        "Content-Length": [
          "5738"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows Server VMs on which Windows Serial Console is not enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows Server virtual machines on which Windows Serial Console is not enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"EMSPortNumber\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"EMS Port Number\",\r\n          \"description\": \"An integer indicating the COM port to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"EMSBaudRate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"EMS Baud Rate\",\r\n          \"description\": \"An integer indicating the baud rate to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"9600\",\r\n          \"19200\",\r\n          \"38400\",\r\n          \"57600\",\r\n          \"115200\"\r\n        ],\r\n        \"defaultValue\": \"115200\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsSerialConsole\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber', '=', parameters('EMSPortNumber'), ',', '[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate', '=', parameters('EMSBaudRate')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsSerialConsole\"\r\n                },\r\n                \"EMSPortNumber\": {\r\n                  \"value\": \"[parameters('EMSPortNumber')]\"\r\n                },\r\n                \"EMSBaudRate\": {\r\n                  \"value\": \"[parameters('EMSBaudRate')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"EMSPortNumber\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"EMSBaudRate\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber\",\r\n                            \"value\": \"[parameters('EMSPortNumber')]\"\r\n                          },\r\n                          {\r\n                            \"name\": \"[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate\",\r\n                            \"value\": \"[parameters('EMSBaudRate')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7a031c68-d6ab-406e-a506-697a19c634b0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7a031c68-d6ab-406e-a506-697a19c634b0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83YzFiMTIxNC1mOTI3LTQ4YmYtODg4Mi04NGYwYWY2NTg4YjE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f10771e4-60d2-44e3-9e07-20a8c9a15b2f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "c007d1b3-5307-4b0d-9780-8b3d7424cf24"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:c007d1b3-5307-4b0d-9780-8b3d7424cf24"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:05 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7c1b1214-f927-48bf-8882-84f0af6588b1' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83YzFiMTIxNC1mOTI3LTQ4YmYtODg4Mi04NGYwYWY2NTg4YjE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:d90f9d4d-03df-4609-b469-07e20315eb5e"
        ],
        "x-ms-correlation-request-id": [
          "64774969-4668-4b29-9a5a-54798beb990a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:64774969-4668-4b29-9a5a-54798beb990a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:05 GMT"
        ],
        "Content-Length": [
          "1436"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Virtual Machine Scale Sets should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"It is recommended to enable Logs so that activity trail can be recreated when investigations are required in the event of an incident or a compromise.\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"IaaSDiagnostics\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Diagnostics\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"LinuxDiagnostic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.OSTCExtensions\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7c1b1214-f927-48bf-8882-84f0af6588b1\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83YzVhNzRiZi1hZTk0LTRhNzQtOGZjZi02NDRkMWUwZTZlNmY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:900952b0-db0c-4062-943e-fb1a73dde04f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "016fc389-2e7d-4c17-82fb-a448b69d43e0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205305Z:016fc389-2e7d-4c17-82fb-a448b69d43e0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:05 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83YzVhNzRiZi1hZTk0LTRhNzQtOGZjZi02NDRkMWUwZTZlNmY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:3bd406d2-24aa-41bd-90c8-1fc21e5b8cf1"
        ],
        "x-ms-correlation-request-id": [
          "561ab897-e4c9-46db-84f6-13045a51595a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205306Z:561ab897-e4c9-46db-84f6-13045a51595a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:05 GMT"
        ],
        "Content-Length": [
          "881"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Require blob encryption for storage accounts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy ensures blob encryption for storage accounts is turned on. It only applies to Microsoft.Storage resource types, not other storage providers. This policy is deprecated because storage blob encryption is now enabled by default, and can no longer be disabled.\",\r\n    \"metadata\": {\r\n      \"category\": \"Storage\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n            \"equals\": \"false\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7e56b49b-5990-4159-a734-511ea19b731c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZTU2YjQ5Yi01OTkwLTQxNTktYTczNC01MTFlYTE5YjczMWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e5ef4246-5a82-48fe-80e7-c0ce2614dc3c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "5a3e4568-8322-438b-bc07-f8af39c7dc65"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205306Z:5a3e4568-8322-438b-bc07-f8af39c7dc65"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7e56b49b-5990-4159-a734-511ea19b731c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7e56b49b-5990-4159-a734-511ea19b731c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZTU2YjQ5Yi01OTkwLTQxNTktYTczNC01MTFlYTE5YjczMWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:ced0c7c2-709c-4a29-94fc-adaa98acf23d"
        ],
        "x-ms-correlation-request-id": [
          "0dee9b86-9fee-4f61-b99b-dde43bf23b0d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205306Z:0dee9b86-9fee-4f61-b99b-dde43bf23b0d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "971"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"NotInstalledApplication\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7e56b49b-5990-4159-a734-511ea19b731c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZTg0YmE0NC02ZDAzLTQ2ZmQtOTUwZS01ZWZhNWExMTEyZmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8cbfe57e-89fb-4ad4-ac4c-52599fb48b01"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "305c1663-e352-4f52-b93b-ea7d9e9b5ebd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205306Z:305c1663-e352-4f52-b93b-ea7d9e9b5ebd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7e84ba44-6d03-46fd-950e-5efa5a1112fa' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZTg0YmE0NC02ZDAzLTQ2ZmQtOTUwZS01ZWZhNWExMTEyZmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:a807e758-c697-430f-977e-f03da109a205"
        ],
        "x-ms-correlation-request-id": [
          "97120f43-2cd5-4e93-a6ec-015dcf66d699"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:97120f43-2cd5-4e93-a6ec-015dcf66d699"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "1006"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that have not restarted within the specified number of days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that have not restarted within the specified number of days. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"MachineLastBootUpTime\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7e84ba44-6d03-46fd-950e-5efa5a1112fa\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZWQ0MDgwMS04YTBmLTRjZWItODVjMC05ZmQyNWMxZDYxYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:3b33c886-9c02-485f-9563-8baba3f76b3a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "c200de41-61ed-41db-a698-fbcf5ded4ff1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:c200de41-61ed-41db-a698-fbcf5ded4ff1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZWQ0MDgwMS04YTBmLTRjZWItODVjMC05ZmQyNWMxZDYxYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:57efab48-1d08-489b-b56c-2d5dee9458bc"
        ],
        "x-ms-correlation-request-id": [
          "126568fe-7221-4834-939b-eb60bfaddc6c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:126568fe-7221-4834-939b-eb60bfaddc6c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "4342"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not have the password complexity setting enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the password complexity setting enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"PasswordMustMeetComplexityRequirements\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"PasswordMustMeetComplexityRequirements\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7f89b1eb-583c-429a-8828-af049802c1d9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83Zjg5YjFlYi01ODNjLTQyOWEtODgyOC1hZjA0OTgwMmMxZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c3b305b6-aef3-4ddd-9d09-6912e6291d8d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "34486249-2e46-4b9f-a10a-a0754b6e2d1e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:34486249-2e46-4b9f-a10a-a0754b6e2d1e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7f89b1eb-583c-429a-8828-af049802c1d9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7f89b1eb-583c-429a-8828-af049802c1d9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83Zjg5YjFlYi01ODNjLTQyOWEtODgyOC1hZjA0OTgwMmMxZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:5d394d34-4216-474f-9ac5-e4f9ea319658"
        ],
        "x-ms-correlation-request-id": [
          "591de1c1-cfe5-448b-90b1-025bbc6134a2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:591de1c1-cfe5-448b-90b1-025bbc6134a2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:06 GMT"
        ],
        "Content-Length": [
          "890"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit diagnostic setting\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit diagnostic setting for selected resource types\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfResourceTypes\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Types\",\r\n          \"strongType\": \"resourceTypes\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": \"[parameters('listOfResourceTypes')]\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"AuditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7f89b1eb-583c-429a-8828-af049802c1d9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZmY0MjZlMi01MTVmLTQwNWEtOTFjOC00ZjIzMzM0NDJlYjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9e951fe6-2322-44b8-992e-b9525ee21c03"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "6dda3ccf-68dc-4c73-af3a-1def7bec9eed"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:6dda3ccf-68dc-4c73-af3a-1def7bec9eed"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7ff426e2-515f-405a-91c8-4f2333442eb5' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83ZmY0MjZlMi01MTVmLTQwNWEtOTFjOC00ZjIzMzM0NDJlYjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:2680e0a9-cc08-4bd4-a417-8ca8ab30dfb5"
        ],
        "x-ms-correlation-request-id": [
          "8fc264e0-6b9e-40d9-9213-adf615c4972a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:8fc264e0-6b9e-40d9-9213-adf615c4972a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "1508"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit SQL auditing settings at the server level for the Action-Groups and Actions\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"SQL auditing should be configured to capture certain Action-Groups and Actions. The AuditActionsAndGroups property should contain at least SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP FAILED_DATABASE_AUTHENTICATION_GROUP, BATCH_COMPLETED_GROUP to ensure a thorough audit logging\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\",\r\n                  \"notEquals\": \"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\"\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\",\r\n                  \"notEquals\": \"FAILED_DATABASE_AUTHENTICATION_GROUP\"\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\",\r\n                  \"notEquals\": \"BATCH_COMPLETED_GROUP\"\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7ff426e2-515f-405a-91c8-4f2333442eb5\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84M2EyMTRmNy1kMDFhLTQ4NGItOTFhOS1lZDU0NDcwYzlhNmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:173f7971-707e-469a-bab4-dce8d3e87279"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "ffda42ea-7b17-4650-8ee6-ffbdb51340f8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205307Z:ffda42ea-7b17-4650-8ee6-ffbdb51340f8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '83a214f7-d01a-484b-91a9-ed54470c9a6a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84M2EyMTRmNy1kMDFhLTQ4NGItOTFhOS1lZDU0NDcwYzlhNmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:0acfb6e1-37a2-4d34-a2bc-bb0c35f5ed76"
        ],
        "x-ms-correlation-request-id": [
          "e4734b6f-006f-450e-a1ef-def2d46d5eaf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:e4734b6f-006f-450e-a1ef-def2d46d5eaf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "1678"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Event Hub should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Event Hub\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.EventHub/namespaces\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"83a214f7-d01a-484b-91a9-ed54470c9a6a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84NmE5MTJmNi05YTA2LTRlMjYtYjQ0Ny0xMWIxNmJhODY1OWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7b0fa7b4-1501-464b-9baf-5d5323c013c4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "240fc6e3-b1e8-4e49-ab68-62560a424de5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:240fc6e3-b1e8-4e49-ab68-62560a424de5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '86a912f6-9a06-4e26-b447-11b16ba8659f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84NmE5MTJmNi05YTA2LTRlMjYtYjQ0Ny0xMWIxNmJhODY1OWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:33999e62-6877-4c8a-9261-70f6e0b1dd5c"
        ],
        "x-ms-correlation-request-id": [
          "78c99fd4-a069-4e40-92c3-63ccc23894d0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:78c99fd4-a069-4e40-92c3-63ccc23894d0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "1385"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Enables transparent data encryption on SQL databases\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"notEquals\": \"master\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"DeployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n          \"name\": \"current\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n            \"equals\": \"Enabled\"\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"fullDbName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"name\": \"[concat(parameters('fullDbName'), '/current')]\",\r\n                    \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n                    \"apiVersion\": \"2014-04-01\",\r\n                    \"properties\": {\r\n                      \"status\": \"Enabled\"\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"fullDbName\": {\r\n                  \"value\": \"[field('fullName')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"86a912f6-9a06-4e26-b447-11b16ba8659f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/86b3d65f-7626-441e-b690-81a8b71cff60?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84NmIzZDY1Zi03NjI2LTQ0MWUtYjY5MC04MWE4YjcxY2ZmNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9190d739-3c95-49da-b709-ec08cd1cb156"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "093e50f7-57f3-46a1-82ab-54ed30533cf7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:093e50f7-57f3-46a1-82ab-54ed30533cf7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:08 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '86b3d65f-7626-441e-b690-81a8b71cff60' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/86b3d65f-7626-441e-b690-81a8b71cff60?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84NmIzZDY1Zi03NjI2LTQ0MWUtYjY5MC04MWE4YjcxY2ZmNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:55968c74-ea8e-4918-b57e-f94f8221524d"
        ],
        "x-ms-correlation-request-id": [
          "931e388e-2ed8-4883-bc38-ffd319141105"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:931e388e-2ed8-4883-bc38-ffd319141105"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:07 GMT"
        ],
        "Content-Length": [
          "1083"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"System updates should be installed on your machines\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Missing security system updates on your servers will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"systemUpdates\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"86b3d65f-7626-441e-b690-81a8b71cff60\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/871b6d14-10aa-478d-b590-94f262ecfa99?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84NzFiNmQxNC0xMGFhLTQ3OGQtYjU5MC05NGYyNjJlY2ZhOTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a6f72f44-3b8b-4b63-bb76-a8f00ba2cf18"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "0ee27bf9-557d-43a0-b56f-ac81c83ce93a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:0ee27bf9-557d-43a0-b56f-ac81c83ce93a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:08 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '871b6d14-10aa-478d-b590-94f262ecfa99' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/871b6d14-10aa-478d-b590-94f262ecfa99?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84NzFiNmQxNC0xMGFhLTQ3OGQtYjU5MC05NGYyNjJlY2ZhOTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:ce49e42f-90e3-41b8-8eff-dd59ad7c10d9"
        ],
        "x-ms-correlation-request-id": [
          "26b451ba-5cb9-4da5-bf57-cf328c9adfb9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:26b451ba-5cb9-4da5-bf57-cf328c9adfb9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:08 GMT"
        ],
        "Content-Length": [
          "658"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require specified tag\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Enforces existence of a tag. Does not apply to resource groups.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n        \"exists\": \"false\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/871b6d14-10aa-478d-b590-94f262ecfa99\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"871b6d14-10aa-478d-b590-94f262ecfa99\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/884b209a-963b-4520-8006-d20cb3c213e0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84ODRiMjA5YS05NjNiLTQ1MjAtODAwNi1kMjBjYjNjMjEzZTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:917a2592-2a1b-4b9d-bed5-9244abd9255b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "574dc75b-592b-4b9b-9557-486fea359c35"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205308Z:574dc75b-592b-4b9b-9557-486fea359c35"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:08 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '884b209a-963b-4520-8006-d20cb3c213e0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/884b209a-963b-4520-8006-d20cb3c213e0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84ODRiMjA5YS05NjNiLTQ1MjAtODAwNi1kMjBjYjNjMjEzZTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:5d2546cb-e025-4e24-a3ac-f06f35c1ccb4"
        ],
        "x-ms-correlation-request-id": [
          "347e1d8a-7c75-4755-98a0-34fe36a9bcb8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205309Z:347e1d8a-7c75-4755-98a0-34fe36a9bcb8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:08 GMT"
        ],
        "Content-Length": [
          "5515"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Linux VMs that have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"ApplicationName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'python; powershell'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"microsoft-aks\",\r\n                  \"AzureDatabricks\",\r\n                  \"qubole-inc\",\r\n                  \"datastax\",\r\n                  \"couchbase\",\r\n                  \"scalegrid\",\r\n                  \"checkpoint\",\r\n                  \"paloaltonetworks\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"CentOS*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"RHEL\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"osa\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"credativ\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Debian\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"7*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Suse\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"SLES*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"11*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"12*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"linux-data-science-vm-ubuntu\",\r\n                      \"azureml\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-altus-centos-os\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"not_installed_application_linux\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent', '=', concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"not_installed_application_linux\"\r\n                },\r\n                \"ApplicationName\": {\r\n                  \"value\": \"[parameters('ApplicationName')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ApplicationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\",\r\n                            \"value\": \"[concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforLinux\",\r\n                      \"typeHandlerVersion\": \"1.0\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"884b209a-963b-4520-8006-d20cb3c213e0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/89099bee-89e0-4b26-a5f4-165451757743?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84OTA5OWJlZS04OWUwLTRiMjYtYTVmNC0xNjU0NTE3NTc3NDM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d34bbcd7-b100-4add-ae75-0a8a261e3422"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "dbf441f6-f8bc-4c19-851b-a129028d9d81"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205309Z:dbf441f6-f8bc-4c19-851b-a129028d9d81"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '89099bee-89e0-4b26-a5f4-165451757743' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/89099bee-89e0-4b26-a5f4-165451757743?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84OTA5OWJlZS04OWUwLTRiMjYtYTVmNC0xNjU0NTE3NTc3NDM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:e44836a5-da85-41e2-acbb-e93a9a1ce3eb"
        ],
        "x-ms-correlation-request-id": [
          "1e96543e-fc14-4c4a-b400-edfd131789ae"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205309Z:1e96543e-fc14-4c4a-b400-edfd131789ae"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "992"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"SQL servers should be configured with auditing retention days greater than 90 days.\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit SQL servers configured with an auditing retention period of less than 90 days.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/servers/auditingSettings/retentionDays\",\r\n            \"greater\": 90\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"89099bee-89e0-4b26-a5f4-165451757743\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84YjBkZTU3YS1mNTExLTRkNDUtYTI3Ny0xN2NiNzljYjE2M2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:cef77f51-8f50-49c6-90fa-a91ff3865ea6"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "b4dc58f2-24d9-4f3b-926f-7c9882118fd9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205309Z:b4dc58f2-24d9-4f3b-926f-7c9882118fd9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:08 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '8b0de57a-f511-4d45-a277-17cb79cb163b' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84YjBkZTU3YS1mNTExLTRkNDUtYTI3Ny0xN2NiNzljYjE2M2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:e53845f9-ddce-4c56-b1f3-4850d571a423"
        ],
        "x-ms-correlation-request-id": [
          "bdc1cb7d-bf17-4ae0-ad6e-2a6e3a6dd1c1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205309Z:bdc1cb7d-bf17-4ae0-ad6e-2a6e3a6dd1c1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "918"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs with a pending reboot\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines with a pending reboot. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsPendingReboot\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"8b0de57a-f511-4d45-a277-17cb79cb163b\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84Y2UzZGEyMy03MTU2LTQ5ZTQtYjE0NS0yNGY5NWY5ZGNiNDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7da888d0-d866-4ea2-8737-11a4d2b6b37d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "bb196098-d94d-47a5-9f45-fa32f11d93a8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205309Z:bb196098-d94d-47a5-9f45-fa32f11d93a8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '8ce3da23-7156-49e4-b145-24f95f9dcb46' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84Y2UzZGEyMy03MTU2LTQ5ZTQtYjE0NS0yNGY5NWY5ZGNiNDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:06d153a9-881f-4408-9002-731b21c9d87e"
        ],
        "x-ms-correlation-request-id": [
          "189597ad-2c0d-4e28-87b8-49c190404f73"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:189597ad-2c0d-4e28-87b8-49c190404f73"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "905"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require tag and its value on resource groups\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      },\r\n      \"tagValue\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Value\",\r\n          \"description\": \"Value of the tag, such as 'production'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"notEquals\": \"[parameters('tagValue')]\"\r\n          },\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"8ce3da23-7156-49e4-b145-24f95f9dcb46\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84ZmYwYjE4Yi0yNjJlLTQ1MTItODU3YS00OGFkMGFlYjlhNzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ceee87b9-39e7-4c30-8060-204a302cf7f7"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "d87559c8-572f-4fef-95b6-8f90af0b1843"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:d87559c8-572f-4fef-95b6-8f90af0b1843"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '8ff0b18b-262e-4512-857a-48ad0aeb9a78' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy84ZmYwYjE4Yi0yNjJlLTQ1MTItODU3YS00OGFkMGFlYjlhNzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:fa299f37-8947-4d13-8655-d586ac6a4386"
        ],
        "x-ms-correlation-request-id": [
          "79507b5a-b8b5-428b-83a7-fe010eaafb97"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:79507b5a-b8b5-428b-83a7-fe010eaafb97"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "4342"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that do not store passwords using reversible encryption\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not store passwords using reversible encryption. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"StorePasswordsUsingReversibleEncryption\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"StorePasswordsUsingReversibleEncryption\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"8ff0b18b-262e-4512-857a-48ad0aeb9a78\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85MGJhMmVlNy00Y2E4LTQ2NzMtODRkMS1jODUxYzUwZDNiYWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:591f8a73-5f73-4d20-9572-dee633f5a053"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "d018575c-19d2-4d1f-9f08-7a58645e5cd8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:d018575c-19d2-4d1f-9f08-7a58645e5cd8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '90ba2ee7-4ca8-4673-84d1-c851c50d3baf' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85MGJhMmVlNy00Y2E4LTQ2NzMtODRkMS1jODUxYzUwZDNiYWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:3e63a99d-3749-41a0-8cc6-f5c68a1375dd"
        ],
        "x-ms-correlation-request-id": [
          "2f299ee5-bed4-4221-bb86-52bd41b65475"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:2f299ee5-bed4-4221-bb86-52bd41b65475"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "5157"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified Windows PowerShell modules installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"Modules\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PowerShell Modules\",\r\n          \"description\": \"A semicolon-separated list of the names of the PowerShell modules that should be installed. You may also specify a specific version of a module that should be installed by including a comma after the module name, followed by the desired version. e.g. PSDscResources; SqlServerDsc, 12.0.0.0; ComputerManagementDsc, 6.1.0.0\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsPowerShellModules\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[PowerShellModules]PowerShellModules1;Modules', '=', parameters('Modules')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsPowerShellModules\"\r\n                },\r\n                \"Modules\": {\r\n                  \"value\": \"[parameters('Modules')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"Modules\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[PowerShellModules]PowerShellModules1;Modules\",\r\n                            \"value\": \"[parameters('Modules')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"90ba2ee7-4ca8-4673-84d1-c851c50d3baf\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85Mjk3YzIxZC0yZWQ2LTQ0NzQtYjQ4Zi0xNjNmNzU2NTRjZTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:31818f12-45e4-434d-bd82-f278b4f0fa4e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "3233c121-7689-447b-b489-886aa5ca5486"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:3233c121-7689-447b-b489-886aa5ca5486"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:09 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9297c21d-2ed6-4474-b48f-163f75654ce3' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85Mjk3YzIxZC0yZWQ2LTQ0NzQtYjQ4Zi0xNjNmNzU2NTRjZTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:41352571-68c3-42b7-b4c1-9219fdf90341"
        ],
        "x-ms-correlation-request-id": [
          "513c6f14-aef2-4c31-9d92-a34e477fb8b6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:513c6f14-aef2-4c31-9d92-a34e477fb8b6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "1120"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"MFA should be enabled accounts with write permissions on your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with write privileges to prevent a breach of accounts or resources.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"EnableMFAForWritePermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9297c21d-2ed6-4474-b48f-163f75654ce3\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9328f27e-611e-44a7-a244-39109d7d35ab?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85MzI4ZjI3ZS02MTFlLTQ0YTctYTI0NC0zOTEwOWQ3ZDM1YWI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e45c0ff8-7617-4477-ba59-8314eec6d2be"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "e054253e-0d08-4b05-8ed1-7dec32399814"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205310Z:e054253e-0d08-4b05-8ed1-7dec32399814"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9328f27e-611e-44a7-a244-39109d7d35ab' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9328f27e-611e-44a7-a244-39109d7d35ab?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85MzI4ZjI3ZS02MTFlLTQ0YTctYTI0NC0zOTEwOWQ3ZDM1YWI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:be927cce-a16e-49cc-86f4-6f7b647ede62"
        ],
        "x-ms-correlation-request-id": [
          "ca9ec964-239b-4c17-a408-1a8ff3f4dc03"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:ca9ec964-239b-4c17-a408-1a8ff3f4dc03"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "1028"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that contain certificates expiring within the specified number of days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that contain certificates expiring within the specified number of days. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"CertificateExpiration\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9328f27e-611e-44a7-a244-39109d7d35ab\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9328f27e-611e-44a7-a244-39109d7d35ab\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85MzUwN2E4MS0xMGE0LTRhZjAtOWVlMi0zNGNmMjVhOTZlOTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1cf72c2b-3aa6-4557-9824-66c25900a431"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "0f218884-2faa-4e0c-ad48-3bdd56647a2f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:0f218884-2faa-4e0c-ad48-3bdd56647a2f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '93507a81-10a4-4af0-9ee2-34cf25a96e98' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85MzUwN2E4MS0xMGE0LTRhZjAtOWVlMi0zNGNmMjVhOTZlOTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:1ac22e09-4e75-46c8-abe4-2b233ae120d2"
        ],
        "x-ms-correlation-request-id": [
          "358d9483-737b-4f87-b069-9333fe05ee5c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:358d9483-737b-4f87-b069-9333fe05ee5c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:11 GMT"
        ],
        "Content-Length": [
          "5074"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs in which the Administrators group does not contain all of the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group does not contain all of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"MembersToInclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Members to include\",\r\n          \"description\": \"A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"AdministratorsGroupMembersToInclude\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToInclude', '=', parameters('MembersToInclude')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"AdministratorsGroupMembersToInclude\"\r\n                },\r\n                \"MembersToInclude\": {\r\n                  \"value\": \"[parameters('MembersToInclude')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"MembersToInclude\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[LocalGroup]AdministratorsGroup;MembersToInclude\",\r\n                            \"value\": \"[parameters('MembersToInclude')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"93507a81-10a4-4af0-9ee2-34cf25a96e98\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85NGMxOWYxOS04MTkyLTQ4Y2QtYTExYi1lMzcwOTlkM2UzNmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8b706163-d8d2-48ca-a1ed-ff4148f92a20"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "2f150845-4ebd-444b-adce-7a9614f1cab2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:2f150845-4ebd-444b-adce-7a9614f1cab2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '94c19f19-8192-48cd-a11b-e37099d3e36b' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85NGMxOWYxOS04MTkyLTQ4Y2QtYTExYi1lMzcwOTlkM2UzNmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:7af0244e-17c7-490d-9f91-124219a72d9f"
        ],
        "x-ms-correlation-request-id": [
          "119a82e5-cc21-4970-9b6c-edbca1b6b2b6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:119a82e5-cc21-4970-9b6c-edbca1b6b2b6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "596"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation only in European data centers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation in the following locations only: North Europe, West Europe\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"location\",\r\n          \"in\": [\r\n            \"northeurope\",\r\n            \"westeurope\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"94c19f19-8192-48cd-a11b-e37099d3e36b\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85NjY3MGQwMS0wYTRkLTQ2NDktOWM4OS0yZDNhYmMwYTUwMjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a3dc4280-f2da-43b1-badf-dafec2ce3169"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "396dfd05-ca9e-4a1e-976f-b990e4680da6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:396dfd05-ca9e-4a1e-976f-b990e4680da6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:11 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '96670d01-0a4d-4649-9c89-2d3abc0a5025' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85NjY3MGQwMS0wYTRkLTQ2NDktOWM4OS0yZDNhYmMwYTUwMjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:8ae10166-81c5-40c7-a5c7-58401e5c064f"
        ],
        "x-ms-correlation-request-id": [
          "c571958d-9f63-49cf-903d-bb16627af318"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:c571958d-9f63-49cf-903d-bb16627af318"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:10 GMT"
        ],
        "Content-Length": [
          "746"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require specified tag on resource groups\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Enforces existence of a tag on resource groups.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"96670d01-0a4d-4649-9c89-2d3abc0a5025\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9677b740-f641-4f3c-b9c5-466005c85278?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85Njc3Yjc0MC1mNjQxLTRmM2MtYjljNS00NjYwMDVjODUyNzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:05fed3ec-2d98-4c17-9707-bde5efe97559"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "6a7277b3-89ce-4af5-9862-20191384919f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205311Z:6a7277b3-89ce-4af5-9862-20191384919f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:11 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9677b740-f641-4f3c-b9c5-466005c85278' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9677b740-f641-4f3c-b9c5-466005c85278?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85Njc3Yjc0MC1mNjQxLTRmM2MtYjljNS00NjYwMDVjODUyNzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:063646d4-aae3-48a2-828f-b1a8ac581310"
        ],
        "x-ms-correlation-request-id": [
          "8b4b90fd-508b-45da-929d-42a0637e9420"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:8b4b90fd-508b-45da-929d-42a0637e9420"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:11 GMT"
        ],
        "Content-Length": [
          "1143"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Ensure that 'Send alerts to' is set in SQL server Advanced Data Security settings\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Ensure that an email address is provided for the 'Send alerts to' field in the Advanced Data Security server settings. This email address receives alert notifications when anomalous activities are detected on SQL servers.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/servers/securityAlertPolicies/emailAddresses[*]\",\r\n            \"notEquals\": \"\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9677b740-f641-4f3c-b9c5-466005c85278\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9677b740-f641-4f3c-b9c5-466005c85278\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/983211ba-f348-4758-983b-21fa29294869?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ODMyMTFiYS1mMzQ4LTQ3NTgtOTgzYi0yMWZhMjkyOTQ4Njk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ce0388b2-08c3-4d05-afc7-a90ced1d2f29"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "d82bd225-ee1f-4cc0-8fea-23ddc4a1fb8a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:d82bd225-ee1f-4cc0-8fea-23ddc4a1fb8a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '983211ba-f348-4758-983b-21fa29294869' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/983211ba-f348-4758-983b-21fa29294869?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ODMyMTFiYS1mMzQ4LTQ3NTgtOTgzYi0yMWZhMjkyOTQ4Njk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:f0db93e7-bfff-4520-a27a-6f1cb082af00"
        ],
        "x-ms-correlation-request-id": [
          "41ad3ccc-bf64-4ef3-b5e7-3e38cfbba4a3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:41ad3ccc-bf64-4ef3-b5e7-3e38cfbba4a3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:11 GMT"
        ],
        "Content-Length": [
          "697"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation only in United States data centers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation in the following locations only: Central US, East US, East US2, North Central US, South Central US, West US\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"location\",\r\n          \"in\": [\r\n            \"centralus\",\r\n            \"eastus\",\r\n            \"eastus2\",\r\n            \"northcentralus\",\r\n            \"southcentralus\",\r\n            \"westus\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"983211ba-f348-4758-983b-21fa29294869\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9a7c7a7d-49e5-4213-bea8-6a502b6272e0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85YTdjN2E3ZC00OWU1LTQyMTMtYmVhOC02YTUwMmI2MjcyZTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c914de65-b335-4c59-bc10-ccfa82f71031"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "f3e27354-2aa2-42a2-bd7e-c82250bb1a42"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:f3e27354-2aa2-42a2-bd7e-c82250bb1a42"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9a7c7a7d-49e5-4213-bea8-6a502b6272e0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9a7c7a7d-49e5-4213-bea8-6a502b6272e0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85YTdjN2E3ZC00OWU1LTQyMTMtYmVhOC02YTUwMmI2MjcyZTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:e6193cb9-b0d7-491d-9061-50eb24b1b3d3"
        ],
        "x-ms-correlation-request-id": [
          "77060a17-f419-40f2-989f-dfe0abae335a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:77060a17-f419-40f2-989f-dfe0abae335a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "4307"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Diagnostic Settings for Azure SQL Database to Event Hub\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploys the diagnostic settings for Azure SQL Database to stream to a regional Event Hub on any Azure SQL Database which is missing this diagnostic settings is created or updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"profileName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Profile name\",\r\n          \"description\": \"The diagnostic settings profile name\"\r\n        },\r\n        \"defaultValue\": \"setbypolicy\"\r\n      },\r\n      \"eventHubRuleId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Event Hub Authorization Rule Id\",\r\n          \"description\": \"The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\",\r\n          \"strongType\": \"Microsoft.EventHub/Namespaces/AuthorizationRules\",\r\n          \"assignPermissions\": true\r\n        }\r\n      },\r\n      \"metricsEnabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Enable metrics\",\r\n          \"description\": \"Whether to enable metrics stream to the Event Hub - True or False\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"True\",\r\n          \"False\"\r\n        ],\r\n        \"defaultValue\": \"False\"\r\n      },\r\n      \"logsEnabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Enable logs\",\r\n          \"description\": \"Whether to enable logs stream to the Event Hub  - True or False\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"True\",\r\n          \"False\"\r\n        ],\r\n        \"defaultValue\": \"True\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers/databases\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"DeployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"name\": \"[parameters('profileName')]\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                \"equals\": \"[parameters('logsEnabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                \"equals\": \"[parameters('metricsEnabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"fullName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"eventHubRuleId\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"metricsEnabled\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logsEnabled\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"profileName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Sql/servers/databases/providers/diagnosticSettings\",\r\n                    \"apiVersion\": \"2017-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('fullName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"dependsOn\": [],\r\n                    \"properties\": {\r\n                      \"eventHubAuthorizationRuleId\": \"[parameters('eventHubRuleId')]\",\r\n                      \"metrics\": [\r\n                        {\r\n                          \"category\": \"AllMetrics\",\r\n                          \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                          \"retentionPolicy\": {\r\n                            \"enabled\": false,\r\n                            \"days\": 0\r\n                          }\r\n                        }\r\n                      ],\r\n                      \"logs\": [\r\n                        {\r\n                          \"category\": \"QueryStoreRuntimeStatistics\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"QueryStoreWaitStatistics\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"Errors\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"DatabaseWaitStatistics\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"Blocks\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"SQLInsights\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"Audit\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"SQLSecurityAuditEvents\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"Timeouts\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"AutomaticTuning\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        },\r\n                        {\r\n                          \"category\": \"Deadlocks\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled diagnostic settings for ', parameters('fullName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"fullName\": {\r\n                  \"value\": \"[field('fullName')]\"\r\n                },\r\n                \"eventHubRuleId\": {\r\n                  \"value\": \"[parameters('eventHubRuleId')]\"\r\n                },\r\n                \"metricsEnabled\": {\r\n                  \"value\": \"[parameters('metricsEnabled')]\"\r\n                },\r\n                \"logsEnabled\": {\r\n                  \"value\": \"[parameters('logsEnabled')]\"\r\n                },\r\n                \"profileName\": {\r\n                  \"value\": \"[parameters('profileName')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9a7c7a7d-49e5-4213-bea8-6a502b6272e0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9a7c7a7d-49e5-4213-bea8-6a502b6272e0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85YmZlMzcyNy0wYTE3LTQ3MWYtYTJmZS1lZGRkNmI2Njg3NDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:4ab6b722-222d-4868-acef-2b949c58a37f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "a3419b85-c00e-4730-8966-35f72f6d3df7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:a3419b85-c00e-4730-8966-35f72f6d3df7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9bfe3727-0a17-471f-a2fe-eddd6b668745' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85YmZlMzcyNy0wYTE3LTQ3MWYtYTJmZS1lZGRkNmI2Njg3NDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:5eaf56ef-6200-415d-869b-8eb044446024"
        ],
        "x-ms-correlation-request-id": [
          "a6c46425-8ec3-42dd-be67-b6fcc49a14a2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205312Z:a6c46425-8ec3-42dd-be67-b6fcc49a14a2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "1229"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported Java Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported Java version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestJava\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9bfe3727-0a17-471f-a2fe-eddd6b668745\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9daedab3-fb2d-461e-b861-71790eead4f6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ZGFlZGFiMy1mYjJkLTQ2MWUtYjg2MS03MTc5MGVlYWQ0ZjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:daf41a35-a23b-4cca-8011-eea442f695c7"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "0422abf1-32e0-4f42-bc48-89bb58affa12"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:0422abf1-32e0-4f42-bc48-89bb58affa12"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9daedab3-fb2d-461e-b861-71790eead4f6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9daedab3-fb2d-461e-b861-71790eead4f6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ZGFlZGFiMy1mYjJkLTQ2MWUtYjg2MS03MTc5MGVlYWQ0ZjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "fdf070e8-870f-44c2-b145-592cea98fe9e"
        ],
        "x-ms-request-id": [
          "westus:17adb07e-68d3-4a77-bf60-a8d58ee56759"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:fdf070e8-870f-44c2-b145-592cea98fe9e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "1260"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Azure Security center has identified some of your Network Security Groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to easily target your resources.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"unprotectedNetworkEndpoint\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9daedab3-fb2d-461e-b861-71790eead4f6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9ea02ca2-71db-412d-8b00-7c7ca9fcd32d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ZWEwMmNhMi03MWRiLTQxMmQtOGIwMC03YzdjYTlmY2QzMmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:62150bc5-425a-4f97-92de-3484c1f47cd9"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "a42ff7fc-b278-41b3-afc3-e4035aea9f0f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:a42ff7fc-b278-41b3-afc3-e4035aea9f0f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9ea02ca2-71db-412d-8b00-7c7ca9fcd32d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9ea02ca2-71db-412d-8b00-7c7ca9fcd32d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ZWEwMmNhMi03MWRiLTQxMmQtOGIwMC03YzdjYTlmY2QzMmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:95992ecc-77b9-4f35-9dce-dff4dc5d2f56"
        ],
        "x-ms-correlation-request-id": [
          "32ac4773-b521-471c-a45e-7b5e90f3af0f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:32ac4773-b521-471c-a45e-7b5e90f3af0f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:12 GMT"
        ],
        "Content-Length": [
          "1152"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Append tag and its value from the resource group\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Appends the specified tag with its value from the resource group when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"tagName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Tag Name\",\r\n          \"description\": \"Name of the tag, such as 'environment'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          {\r\n            \"value\": \"[resourceGroup().tags[parameters('tagName')]]\",\r\n            \"exists\": \"true\"\r\n          },\r\n          {\r\n            \"value\": \"[resourceGroup().tags[parameters('tagName')]]\",\r\n            \"notEquals\": \"\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"append\",\r\n        \"details\": [\r\n          {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"value\": \"[resourceGroup().tags[parameters('tagName')]]\"\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9ea02ca2-71db-412d-8b00-7c7ca9fcd32d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9ea02ca2-71db-412d-8b00-7c7ca9fcd32d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/9f658460-46b7-43af-8565-94fc0662be38?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ZjY1ODQ2MC00NmI3LTQzYWYtODU2NS05NGZjMDY2MmJlMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:159544fc-8e33-4cb1-a2c0-10dafd3ec802"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "415be67d-7748-424c-ab77-5affc844e151"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:415be67d-7748-424c-ab77-5affc844e151"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '9f658460-46b7-43af-8565-94fc0662be38' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/9f658460-46b7-43af-8565-94fc0662be38?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy85ZjY1ODQ2MC00NmI3LTQzYWYtODU2NS05NGZjMDY2MmJlMzg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:39641993-cb12-4ce2-add3-b4a6a883d92d"
        ],
        "x-ms-correlation-request-id": [
          "806ea2bf-43ea-426e-95aa-01911c087cd5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:806ea2bf-43ea-426e-95aa-01911c087cd5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "957"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that are not set to the specified time zone\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that are not set to the specified time zone. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsTimeZone\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9f658460-46b7-43af-8565-94fc0662be38\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"9f658460-46b7-43af-8565-94fc0662be38\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMDMwYTU3ZS00NjM5LTRlOGYtYWRlOS1hOTJmMzNhZmU3ZWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1e38a563-971f-43b5-b527-59d975db149d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "765ba78d-ce23-4d02-a7f7-40e6ede88c88"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:765ba78d-ce23-4d02-a7f7-40e6ede88c88"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a030a57e-4639-4e8f-ade9-a92f33afe7ee' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMDMwYTU3ZS00NjM5LTRlOGYtYWRlOS1hOTJmMzNhZmU3ZWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:4e5abe87-ce6e-45cc-bc97-0841e43ad77f"
        ],
        "x-ms-correlation-request-id": [
          "aaede8d4-2cf1-4bf7-9fe6-744ac8bc8695"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205313Z:aaede8d4-2cf1-4bf7-9fe6-744ac8bc8695"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "1050"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs on which the Log Analytics agent is not connected as expected\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. This policy should only be used along with its corresponding deploy policy in an initiative/policy set. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsLogAnalyticsAgentConnection\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a030a57e-4639-4e8f-ade9-a92f33afe7ee\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMDhlYzkwMC0yNTRhLTQ1NTUtOWJmNS1lNDJhZjA0YjVjNWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:589e46fb-3b26-4bf3-ad3e-8749192210ba"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "17d25fe4-0b9f-4300-b99b-aa1cf5168d6f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:17d25fe4-0b9f-4300-b99b-aa1cf5168d6f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a08ec900-254a-4555-9bf5-e42af04b5c5c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMDhlYzkwMC0yNTRhLTQ1NTUtOWJmNS1lNDJhZjA0YjVjNWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:bfe63872-1642-49e3-83a0-26d94cf5de80"
        ],
        "x-ms-correlation-request-id": [
          "853a8f7a-3b9c-4bad-9c82-1f4fce4d4bc7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:853a8f7a-3b9c-4bad-9c82-1f4fce4d4bc7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "930"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allowed resource types\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy enables you to specify the resource types that your organization can deploy. Only resource types that support 'tags' and 'location' will be affected by this policy. To restrict all resources please duplicate this policy and change the 'mode' to 'All'.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfResourceTypesAllowed\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"description\": \"The list of resource types that can be deployed.\",\r\n          \"displayName\": \"Allowed resource types\",\r\n          \"strongType\": \"resourceTypes\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"type\",\r\n          \"in\": \"[parameters('listOfResourceTypesAllowed')]\"\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a08ec900-254a-4555-9bf5-e42af04b5c5c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMTgxN2VjMC1hMzY4LTQzMmEtODA1Ny04MzcxZTE3YWM2ZWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:aaa8c874-d73e-44c6-b69a-c9c57a29f155"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "3b1e543e-d819-4d3a-8b15-413878f17ba8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:3b1e543e-d819-4d3a-8b15-413878f17ba8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a1817ec0-a368-432a-8057-8371e17ac6ee' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMTgxN2VjMC1hMzY4LTQzMmEtODA1Ny04MzcxZTE3YWM2ZWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:3faf443a-c413-4325-8a6f-39a170cc936f"
        ],
        "x-ms-correlation-request-id": [
          "fc865163-9890-495e-9747-fb4f1c00ce6a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:fc865163-9890-495e-9747-fb4f1c00ce6a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "1129"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Service Bus namespace\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Service Bus clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you shoud create access policies at the entity level for queues and topics to provide access to only the specific entity\",\r\n    \"metadata\": {\r\n      \"category\": \"Service Bus\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceBus/namespaces/authorizationRules\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"notEquals\": \"RootManageSharedAccessKey\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a1817ec0-a368-432a-8057-8371e17ac6ee\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMjllZTk1Yy0wMzk1LTQ1MTUtOTg1MS1jYzA0ZmZlODJhOTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:83814cf7-1344-4123-998b-4dadefa7f5a0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "b9c270b9-fff1-497e-823d-4653accc4bc0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:b9c270b9-fff1-497e-823d-4653accc4bc0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a29ee95c-0395-4515-9851-cc04ffe82a91' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMjllZTk1Yy0wMzk1LTQ1MTUtOTg1MS1jYzA0ZmZlODJhOTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:7ff2f89c-bdeb-4dbd-95b1-047a27c53a37"
        ],
        "x-ms-correlation-request-id": [
          "49c94307-71c6-4dc0-9c97-c87c2dea3c7e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:49c94307-71c6-4dc0-9c97-c87c2dea3c7e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:13 GMT"
        ],
        "Content-Length": [
          "965"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that are not joined to the specified domain\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that are not joined to the specified domain. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsDomainMembership\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a29ee95c-0395-4515-9851-cc04ffe82a91\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hNDUxYzFlZi1jNmNhLTQ4M2QtODdlZC1mNDk3NjFlM2ZmYjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d637ad56-ad6c-4864-8dd7-79016bc8f8b0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "38d5831a-7da1-4051-825a-cb6cc24380e5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:38d5831a-7da1-4051-825a-cb6cc24380e5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a451c1ef-c6ca-483d-87ed-f49761e3ffb5' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hNDUxYzFlZi1jNmNhLTQ4M2QtODdlZC1mNDk3NjFlM2ZmYjU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:5944071f-1616-472c-8745-cc16fe1609c9"
        ],
        "x-ms-correlation-request-id": [
          "ca440cec-1a99-489a-94e8-e653527cc6fd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205314Z:ca440cec-1a99-489a-94e8-e653527cc6fd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "975"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit usage of custom RBAC rules\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit built-in roles such as 'Owner, Contributer, Reader' instead of custom RBAC roles, which are error prone. Using custom roles is treated as an exception and requires a rigorous review and threat modeling\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Authorization/roleDefinitions\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Authorization/roleDefinitions/type\",\r\n            \"equals\": \"CustomRole\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a451c1ef-c6ca-483d-87ed-f49761e3ffb5\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hNmZiNDM1OC01YmY0LTRhZDctYmE4Mi0yY2QyZjQxY2U1ZTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a65a446f-ba39-489d-b028-895ea2e732ab"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "bfbe2bef-50f0-4bf8-a706-827ab54916c8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:bfbe2bef-50f0-4bf8-a706-827ab54916c8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hNmZiNDM1OC01YmY0LTRhZDctYmE4Mi0yY2QyZjQxY2U1ZTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:3527f9e0-074f-4739-99ee-71466621ac3f"
        ],
        "x-ms-correlation-request-id": [
          "4d568771-892c-497d-ad10-b58e53ff0249"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:4d568771-892c-497d-ad10-b58e53ff0249"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "1073"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit SQL server level Auditing settings\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audits the existence of SQL Auditing at the server level\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"setting\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Desired Auditing setting\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"enabled\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"enabled\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n            \"equals\": \"[parameters('setting')]\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hN2FjYTUzZi0yZWQ0LTQ0NjYtYTI1ZS0wYjQ1YWRlNjhlZmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:089a18a3-9c6c-4424-a92c-45b785fb028d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "25f1363f-dbd9-4959-9353-f32823c09131"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:25f1363f-dbd9-4959-9353-f32823c09131"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:14 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a7aca53f-2ed4-4466-a25e-0b45ade68efd' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hN2FjYTUzZi0yZWQ0LTQ0NjYtYTI1ZS0wYjQ1YWRlNjhlZmQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:10f187fd-4819-4ed9-bf49-ab37ba9432c1"
        ],
        "x-ms-correlation-request-id": [
          "48ea404d-1222-4eb7-a387-5499b056c669"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:48ea404d-1222-4eb7-a387-5499b056c669"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "1069"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"DDoS Protection Standard should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"DDoS protection standard should be enabled for all virtual networks with a subnet that is part of an application gateway with a public IP.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"microsoft.network/virtualNetworks\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"EnableDDoSProtection\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a7aca53f-2ed4-4466-a25e-0b45ade68efd\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hN2ZmMzE2MS0wMDg3LTQ5MGEtOWFkOS1hZDYyMTdmNGY0M2E/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f5bb2db7-753a-4795-a1f7-cda66a9c7d33"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "5a9eabb9-5afb-47cb-b91c-39974f3044b4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:5a9eabb9-5afb-47cb-b91c-39974f3044b4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a7ff3161-0087-490a-9ad9-ad6217f4f43a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hN2ZmMzE2MS0wMDg3LTQ5MGEtOWFkOS1hZDYyMTdmNGY0M2E/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:e7f79193-7317-4cf4-9627-04806cbefd8c"
        ],
        "x-ms-correlation-request-id": [
          "b0cfba88-c3f2-41e6-b2b3-cf6b9ce5ced4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:b0cfba88-c3f2-41e6-b2b3-cf6b9ce5ced4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "654"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Require encryption on Data Lake Store accounts\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy ensures encryption is enabled on all Data Lake Store accounts\",\r\n    \"metadata\": {\r\n      \"category\": \"Data Lake\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.DataLakeStore/accounts/encryptionState\",\r\n            \"equals\": \"Disabled\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a7ff3161-0087-490a-9ad9-ad6217f4f43a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hOGJlZjAwOS1hNWM5LTRkMGYtOTBkNy02MDE4NzM0ZThhMTY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:15755fd3-b466-407b-b8be-cb571e8226c3"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "5cf9cd0c-0852-4978-ae2e-7e7e49c39bc5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205315Z:5cf9cd0c-0852-4978-ae2e-7e7e49c39bc5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a8bef009-a5c9-4d0f-90d7-6018734e8a16' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hOGJlZjAwOS1hNWM5LTRkMGYtOTBkNy02MDE4NzM0ZThhMTY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:d98dd91d-3177-418d-a9fd-13985b6ea3fc"
        ],
        "x-ms-correlation-request-id": [
          "18e5537d-6007-4416-a973-2d51127dd8d0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:18e5537d-6007-4416-a973-2d51127dd8d0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "1020"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Monitor unencrypted SQL databases in Azure Security Center\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Unencrypted SQL databases will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.SQL/servers/databases\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"encryption\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a8bef009-a5c9-4d0f-90d7-6018734e8a16\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hOWI5OWRkOC0wNmM1LTQzMTctODYyOS05ZDg2YTNjNmU3ZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:cd7a991e-c81b-4af2-8eaf-ab0ab750bd64"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11990"
        ],
        "x-ms-correlation-request-id": [
          "db2adc30-de97-4809-a27b-ba7c4a3defcd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:db2adc30-de97-4809-a27b-ba7c4a3defcd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a9b99dd8-06c5-4317-8629-9d86a3c6e7d9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hOWI5OWRkOC0wNmM1LTQzMTctODYyOS05ZDg2YTNjNmU3ZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:ba6ecce0-a3e3-426b-b6fa-6ecb08c17cb5"
        ],
        "x-ms-correlation-request-id": [
          "efd1a208-2b89-4ead-aac3-ba06f1f07573"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:efd1a208-2b89-4ead-aac3-ba06f1f07573"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "1466"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy network watcher when virtual networks are created\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"Network\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"DeployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Network/networkWatchers\",\r\n          \"resourceGroupName\": \"networkWatcherRG\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"[field('location')]\"\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2016-09-01\",\r\n                    \"type\": \"Microsoft.Network/networkWatchers\",\r\n                    \"name\": \"[concat('networkWatcher_', parameters('location'))]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYTYzMzA4MC04YjcyLTQwYzQtYTJkNy1kMDBjMDNlODBiZWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:3b0cf0c7-1af5-413a-b203-0a94a3b41e10"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "735585f2-4d31-4ab4-be32-f49e2a387c8a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:735585f2-4d31-4ab4-be32-f49e2a387c8a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'aa633080-8b72-40c4-a2d7-d00c03e80bed' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYTYzMzA4MC04YjcyLTQwYzQtYTJkNy1kMDBjMDNlODBiZWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:442f7c02-607a-4e2d-95e1-c2132e207e3e"
        ],
        "x-ms-correlation-request-id": [
          "17d700e4-b227-4ea4-ace2-e74260053e55"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:17d700e4-b227-4ea4-ace2-e74260053e55"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "1124"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"MFA should be enabled on accounts with owner permissions on your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with owner permissions to prevent a breach of accounts or resources.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"EnableMFAForOwnerPermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"aa633080-8b72-40c4-a2d7-d00c03e80bed\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/abcc6037-1fc4-47f6-aac5-89706589be24?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYmNjNjAzNy0xZmM0LTQ3ZjYtYWFjNS04OTcwNjU4OWJlMjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ec1ecd66-1d67-4554-8aa1-2cfcd41fdd6b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "ea249465-442f-4c9f-8e8e-504969107207"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:ea249465-442f-4c9f-8e8e-504969107207"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:15 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'abcc6037-1fc4-47f6-aac5-89706589be24' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/abcc6037-1fc4-47f6-aac5-89706589be24?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYmNjNjAzNy0xZmM0LTQ3ZjYtYWFjNS04OTcwNjU4OWJlMjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:403be3c1-78ad-4fda-992d-fd98b31eb820"
        ],
        "x-ms-correlation-request-id": [
          "ec95939f-11fb-4f89-a871-9284a07f6b66"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:ec95939f-11fb-4f89-a871-9284a07f6b66"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "944"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Automatic provisioning of security monitoring agent\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Installs security agent on VMs for advanced security alerts and preventions in Azure Security Center. Applies only for subscriptions that use Azure Security Center.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"AuditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"securityAgent\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"abcc6037-1fc4-47f6-aac5-89706589be24\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYmZiNDM4OC01YmY0LTRhZDctYmE4Mi0yY2QyZjQxY2VhZTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:49da2e90-1d1e-4790-910e-c5253584ea58"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "f9efc075-44f4-4db7-9a90-318c079de6eb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205316Z:f9efc075-44f4-4db7-9a90-318c079de6eb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYmZiNDM4OC01YmY0LTRhZDctYmE4Mi0yY2QyZjQxY2VhZTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:0f5c7097-21f6-463b-a550-a2d759abf89f"
        ],
        "x-ms-correlation-request-id": [
          "bdef2717-fb2e-4dff-8466-57d0658ef037"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:bdef2717-fb2e-4dff-8466-57d0658ef037"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "941"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Advanced data security should be enabled on your SQL servers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit SQL servers without Advanced Data Security\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n          \"name\": \"Default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/servers/securityAlertPolicies/state\",\r\n            \"equals\": \"Enabled\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYmZiNzM4OC01YmY0LTRhZDctYmE5OS0yY2QyZjQxY2ViYjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:3dca3e71-6904-4934-bdcb-a95f8d2c0dca"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "b21f147e-8787-474e-8060-42ee4134bab2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:b21f147e-8787-474e-8060-42ee4134bab2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYmZiNzM4OC01YmY0LTRhZDctYmE5OS0yY2QyZjQxY2ViYjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:64d0f9a6-5fc7-4bd0-ad8b-c60d41b3a215"
        ],
        "x-ms-correlation-request-id": [
          "dc800430-4710-44bc-9222-3e2aa33465fc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:dc800430-4710-44bc-9222-3e2aa33465fc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "984"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Advanced data security should be enabled on your managed instances\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit SQL managed instances without Advanced Data Security\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/managedInstances\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n          \"name\": \"Default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/state\",\r\n            \"equals\": \"Enabled\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYzRhMTljMi1mYTY3LTQ5YjQtOGFlNS0wYjJlNzhjNDk0NTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:89707f0d-75a8-4ebe-88b3-68f74d5db24f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "c7be5dc5-4a9d-43f4-beed-5117f9331335"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:c7be5dc5-4a9d-43f4-beed-5117f9331335"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'ac4a19c2-fa67-49b4-8ae5-0b2e78c49457' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYzRhMTljMi1mYTY3LTQ5YjQtOGFlNS0wYjJlNzhjNDk0NTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:1bcf10f3-158c-4f2e-ae20-aa6d6976b2e7"
        ],
        "x-ms-correlation-request-id": [
          "4e226ad4-1c28-4532-aec1-8a679a66980c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:4e226ad4-1c28-4532-aec1-8a679a66980c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "1147"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Role-Based Access Control (RBAC) should be used on Kubernetes Services\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"To provide granular filtering on the actions that users can perform, use Role-Based Access Control (RBAC) to manage permissions in Kubernetes Service Clusters and configure relevant authorization policies.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/enableRBAC\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/enableRBAC\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYzdlNWZjMC1jMDI5LTRiMTItOTFkNC1hODUwMGNlNjk3Zjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:538cfca1-2f6d-4e63-9dbe-d0718ec97571"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "ecd9d7a5-8e95-4031-8db7-2d4a52aae688"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:ecd9d7a5-8e95-4031-8db7-2d4a52aae688"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'ac7e5fc0-c029-4b12-91d4-a8500ce697f9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hYzdlNWZjMC1jMDI5LTRiMTItOTFkNC1hODUwMGNlNjk3Zjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "725823ae-d748-4184-afd7-499ee9da13af"
        ],
        "x-ms-request-id": [
          "westus:b9e3e128-eb8c-4a05-bd79-6b1af8c8bb42"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:725823ae-d748-4184-afd7-499ee9da13af"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:16 GMT"
        ],
        "Content-Length": [
          "664"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation if 'environment' tag value in allowed values\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation if the 'environment' tag is set to one of the following values: production, dev, test, staging\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"tags.environment\",\r\n          \"in\": [\r\n            \"production\",\r\n            \"dev\",\r\n            \"test\",\r\n            \"staging\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"ac7e5fc0-c029-4b12-91d4-a8500ce697f9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hZWIyMzU2Mi0xODhkLTQ3Y2ItODBiOC01NTFmMTZlZjlmZmY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f50304ad-b370-4df6-8d4d-4df5bd66d622"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "8edd2d36-1341-4c7d-9701-82c1ebebfd2b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205317Z:8edd2d36-1341-4c7d-9701-82c1ebebfd2b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'aeb23562-188d-47cb-80b8-551f16ef9fff' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hZWIyMzU2Mi0xODhkLTQ3Y2ItODBiOC01NTFmMTZlZjlmZmY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:bbc73e64-4c74-4835-8e8a-8991ca8f36ba"
        ],
        "x-ms-correlation-request-id": [
          "51d60e3f-aa80-4a25-b0f9-916af28ec3f8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:51d60e3f-aa80-4a25-b0f9-916af28ec3f8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "1223"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"SQL managed instances should send security alerts to admins and subscription owners\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit that 'email notification to admins and subscription owners' is enabled in the SQL managed instance advanced threat protection settings. This ensures that any detections of anomalous activities on SQL managed instance are reported as soon as possible to the admins.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/managedInstances\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAccountAdmins\",\r\n            \"equals\": \"true\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"aeb23562-188d-47cb-80b8-551f16ef9fff\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hZjZjZDFiZC0xNjM1LTQ4Y2ItYmRlNy01YjE1NjkzOTAwYjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:786fd79b-4c8d-4b6f-9cfa-70179f97813d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "9bb0d722-fd4b-4f99-88b4-bb7c057e2d94"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:9bb0d722-fd4b-4f99-88b4-bb7c057e2d94"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'af6cd1bd-1635-48cb-bde7-5b15693900b9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hZjZjZDFiZC0xNjM1LTQ4Y2ItYmRlNy01YjE1NjkzOTAwYjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:cc8098d3-6bcd-48b5-a643-cc499d243909"
        ],
        "x-ms-correlation-request-id": [
          "e396695d-edca-428f-b45b-c023341465e7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:e396695d-edca-428f-b45b-c023341465e7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "1104"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Monitor missing Endpoint Protection in Azure Security Center\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"endpointProtection\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"af6cd1bd-1635-48cb-bde7-5b15693900b9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/af8051bf-258b-44e2-a2bf-165330459f9d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hZjgwNTFiZi0yNThiLTQ0ZTItYTJiZi0xNjUzMzA0NTlmOWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f4042bdb-c0f2-4ee3-9639-ee7f4fe7d228"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "f79c9f1c-03f7-4655-a8bb-9276a40885c6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:f79c9f1c-03f7-4655-a8bb-9276a40885c6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'af8051bf-258b-44e2-a2bf-165330459f9d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/af8051bf-258b-44e2-a2bf-165330459f9d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hZjgwNTFiZi0yNThiLTQ0ZTItYTJiZi0xNjUzMzA0NTlmOWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:2e7d0913-68a9-49b6-b17b-56e6f0c6973d"
        ],
        "x-ms-correlation-request-id": [
          "1c7d338f-a895-4550-b079-216bd0a00e8b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:1c7d338f-a895-4550-b079-216bd0a00e8b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "1030"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Monitor unaudited SQL servers in Azure Security Center\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"SQL servers which don't have SQL auditing turned on will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.SQL/servers\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"auditing\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"af8051bf-258b-44e2-a2bf-165330459f9d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMGYzMzI1OS03N2Q3LTRjOWUtYWFjNi0zYWFiY2ZhZTY5M2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:cdd7b278-9327-4756-90c8-268313a2fd5b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "b6bd6540-11c1-4392-8bdd-eb88da7981f4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:b6bd6540-11c1-4392-8bdd-eb88da7981f4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b0f33259-77d7-4c9e-aac6-3aabcfae693c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMGYzMzI1OS03N2Q3LTRjOWUtYWFjNi0zYWFiY2ZhZTY5M2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:d6ffe933-cced-4a7b-9e17-4839e5d14c09"
        ],
        "x-ms-correlation-request-id": [
          "4b8d8105-83ba-4e58-82c5-919d7a3a53ee"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:4b8d8105-83ba-4e58-82c5-919d7a3a53ee"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:17 GMT"
        ],
        "Content-Length": [
          "1062"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Just-In-Time network access control should be applied on virtual machines\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Possible network Just In Time (JIT) access will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"jitNetworkAccess\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b0f33259-77d7-4c9e-aac6-3aabcfae693c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMTgxNzVkZC1jNTk5LTRjNjQtODNiYS1iYjAxOGEwNmQzNWI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a526e41c-e8fe-4ab7-884c-99b5858a52dc"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "50cef1d8-57ba-4ba4-b2fc-34eb18eb7467"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205318Z:50cef1d8-57ba-4ba4-b2fc-34eb18eb7467"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b18175dd-c599-4c64-83ba-bb018a06d35b' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMTgxNzVkZC1jNTk5LTRjNjQtODNiYS1iYjAxOGEwNmQzNWI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:263e5ec1-f6ed-4156-ab96-3f643c569b7e"
        ],
        "x-ms-correlation-request-id": [
          "afd2e038-06b4-4dba-a871-19c853dd33f5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:afd2e038-06b4-4dba-a871-19c853dd33f5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "997"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Linux VMs that do not have the passwd file permissions set to 0644\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Linux virtual machines that do not have the passwd file permissions set to 0644. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"PasswordPolicy_msid121\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b18175dd-c599-4c64-83ba-bb018a06d35b\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b278e460-7cfc-4451-8294-cccc40a940d7?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMjc4ZTQ2MC03Y2ZjLTQ0NTEtODI5NC1jY2NjNDBhOTQwZDc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6e62b71a-781c-4e17-bc8b-bf383d4261ad"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "c3b02d4f-01c6-4a06-a665-f56451897d73"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:c3b02d4f-01c6-4a06-a665-f56451897d73"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b278e460-7cfc-4451-8294-cccc40a940d7' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b278e460-7cfc-4451-8294-cccc40a940d7?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMjc4ZTQ2MC03Y2ZjLTQ0NTEtODI5NC1jY2NjNDBhOTQwZDc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:63bcb8dc-2cfd-4c80-a7bf-d1e4dea528bc"
        ],
        "x-ms-correlation-request-id": [
          "f49ac656-d180-4b20-a941-4bd703eb8701"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:f49ac656-d180-4b20-a941-4bd703eb8701"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "1121"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Event Hub clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you shoud create access policies at the entity level for queues and topics to provide access to only the specific entity\",\r\n    \"metadata\": {\r\n      \"category\": \"Event Hub\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.EventHub/namespaces/authorizationRules\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"notEquals\": \"RootManageSharedAccessKey\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b278e460-7cfc-4451-8294-cccc40a940d7\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMmZjOGY5MS04NjZkLTQ0MzQtOTA4OS01ZWJmZTM4ZDZmZDg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:05aa0189-efdf-48ae-8713-83e90c89cf93"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "201e150d-fbc9-417b-b8a6-0e212565d634"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:201e150d-fbc9-417b-b8a6-0e212565d634"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:18 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b2fc8f91-866d-4434-9089-5ebfe38d6fd8' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iMmZjOGY5MS04NjZkLTQ0MzQtOTA4OS01ZWJmZTM4ZDZmZDg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:44377b76-5592-48c0-be3d-17886125bfc9"
        ],
        "x-ms-correlation-request-id": [
          "dc4c9e68-3d82-4674-9d98-ef03399a7fd2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:dc4c9e68-3d82-4674-9d98-ef03399a7fd2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "4303"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows web servers that are not using secure communication protocols\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"AuditSecureProtocol\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"AuditSecureProtocol\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b2fc8f91-866d-4434-9089-5ebfe38d6fd8\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNDMzMGEwNS1hODQzLTRiYzgtYmY5YS1jYWNjZTUwYzY3ZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:b0031d02-b2e4-49d7-a03e-d09ab84d53a2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "0d8cffdc-fc5e-4ae1-aa8d-46ed2e623804"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:0d8cffdc-fc5e-4ae1-aa8d-46ed2e623804"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b4330a05-a843-4bc8-bf9a-cacce50c67f4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNDMzMGEwNS1hODQzLTRiYzgtYmY5YS1jYWNjZTUwYzY3ZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:2d42205d-9bd9-4143-aefb-1fa045aa0272"
        ],
        "x-ms-correlation-request-id": [
          "2c8a4017-51ec-4e54-b4db-4cb0799c50c2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:2c8a4017-51ec-4e54-b4db-4cb0799c50c2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "1683"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Search services should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Search\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Search/searchServices\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b4330a05-a843-4bc8-bf9a-cacce50c67f4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNDgzMzRhNC05MTFiLTQwODQtYjFhYi0zZTZhNGU1MGI5NTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:31b47807-5462-448d-bd30-e4b26b2cd728"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "dfd8fa1b-b459-4179-a396-dace15e22a8d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205319Z:dfd8fa1b-b459-4179-a396-dace15e22a8d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b48334a4-911b-4084-b1ab-3e6a4e50b951' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNDgzMzRhNC05MTFiLTQwODQtYjFhYi0zZTZhNGU1MGI5NTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:1bd681be-944f-4655-b5b3-0a5368cfa341"
        ],
        "x-ms-correlation-request-id": [
          "f9d4dde1-074a-4bf6-aeba-0a63d3d43052"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:f9d4dde1-074a-4bf6-aeba-0a63d3d43052"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "1203"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Sockets state for an API App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an API app must be carefully reviewed.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"DisableWebSockets\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b48334a4-911b-4084-b1ab-3e6a4e50b951\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNTRlZDc1Yi0zZTFhLTQ0YWMtYTMzMy0wNWJhMzliOTlmZjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a807ca3e-64db-4a92-9b60-3a281b0506df"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "9f324da2-726d-4350-a907-af9c4de1758b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:9f324da2-726d-4350-a907-af9c4de1758b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b54ed75b-3e1a-44ac-a333-05ba39b99ff0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNTRlZDc1Yi0zZTFhLTQ0YWMtYTMzMy0wNWJhMzliOTlmZjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:0cf9395e-c0f4-4c17-89e8-946cf6d2a349"
        ],
        "x-ms-correlation-request-id": [
          "54f2c5a4-90ef-433c-b763-b63fbe2ce40f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:54f2c5a4-90ef-433c-b763-b63fbe2ce40f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "1026"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Service Fabric clusters should only use Azure Active Directory for client authentication\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit usage of client authentication only via Azure Active Directory in Service Fabric\",\r\n    \"metadata\": {\r\n      \"category\": \"Service Fabric\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceFabric/clusters\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\",\r\n                \"equals\": \"\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b54ed75b-3e1a-44ac-a333-05ba39b99ff0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNjA3YzVkZS1lN2Q5LTRlZWUtOWU1Yy04M2YxYmNlZTRmYTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:edc839fb-adf8-45d4-ba8b-50c19be6ab00"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "7a49a9b3-98c7-4350-80e5-21defb853a3f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:7a49a9b3-98c7-4350-80e5-21defb853a3f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iNjA3YzVkZS1lN2Q5LTRlZWUtOWU1Yy04M2YxYmNlZTRmYTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "9a246056-d5c8-4d0e-824e-50362a41bae8"
        ],
        "x-ms-request-id": [
          "westus:cce9a6c8-4687-4c7f-aea1-113b7765a253"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:9a246056-d5c8-4d0e-824e-50362a41bae8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "1250"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in App Services should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit enabling of diagnostic logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"App Service\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"field\": \"kind\",\r\n            \"notContains\": \"functionapp\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Web/sites/config\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/config/detailedErrorLoggingEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/config/httpLoggingEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/config/requestTracingEnabled\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/b821191b-3a12-44bc-9c38-212138a29ff3?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iODIxMTkxYi0zYTEyLTQ0YmMtOWMzOC0yMTIxMzhhMjlmZjM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:736ed7fb-8800-4916-95fd-e0e97b6bbf67"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "6fcf6843-04ec-48cd-ab50-1d046d6a1b5c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:6fcf6843-04ec-48cd-ab50-1d046d6a1b5c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'b821191b-3a12-44bc-9c38-212138a29ff3' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/b821191b-3a12-44bc-9c38-212138a29ff3?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iODIxMTkxYi0zYTEyLTQ0YmMtOWMzOC0yMTIxMzhhMjlmZjM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:ab8a36b1-b089-470e-8d6a-b95d661eae80"
        ],
        "x-ms-correlation-request-id": [
          "1a66ea40-784f-4466-843b-652ef55907b6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:1a66ea40-784f-4466-843b-652ef55907b6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:19 GMT"
        ],
        "Content-Length": [
          "4962"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs in which the Administrators group does not contain only the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group does not contain only the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"Members\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Members\",\r\n          \"description\": \"A semicolon-separated list of all the expected members of the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"AdministratorsGroupMembers\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;Members', '=', parameters('Members')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"AdministratorsGroupMembers\"\r\n                },\r\n                \"Members\": {\r\n                  \"value\": \"[parameters('Members')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"Members\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[LocalGroup]AdministratorsGroup;Members\",\r\n                            \"value\": \"[parameters('Members')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b821191b-3a12-44bc-9c38-212138a29ff3\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"b821191b-3a12-44bc-9c38-212138a29ff3\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iYzAzNzhiYi1kN2FiLTQ2MTQtYTBmNi01YTZlM2YwMmQ2NDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:da8756a9-20f5-4e27-b827-4f2ba326a21a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "8bdff83f-53c1-4cf9-9a74-d27a66024004"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:8bdff83f-53c1-4cf9-9a74-d27a66024004"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'bc0378bb-d7ab-4614-a0f6-5a6e3f02d644' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iYzAzNzhiYi1kN2FiLTQ2MTQtYTBmNi01YTZlM2YwMmQ2NDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:b284d681-2cc8-49cf-9b9f-9b2397981302"
        ],
        "x-ms-correlation-request-id": [
          "cd964b5c-9707-44cb-b2a6-5cbc572ec5fd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205320Z:cd964b5c-9707-44cb-b2a6-5cbc572ec5fd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "1235"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported Python Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestPython\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"bc0378bb-d7ab-4614-a0f6-5a6e3f02d644\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZDM1MmJkNS0yODUzLTQ5ODUtYmYwZC03MzgwNmI0YTU3NDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f7b5d1c1-9478-456c-95ce-c1745d837073"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "319c0194-9303-4d6f-a43f-d9a0c08eccf6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:319c0194-9303-4d6f-a43f-d9a0c08eccf6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'bd352bd5-2853-4985-bf0d-73806b4a5744' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZDM1MmJkNS0yODUzLTQ5ODUtYmYwZC03MzgwNmI0YTU3NDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:eb6b262e-1e36-4699-bb20-a91684a06bac"
        ],
        "x-ms-correlation-request-id": [
          "8736c351-93c4-40e0-a30b-2ce390cff521"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:8736c351-93c4-40e0-a30b-2ce390cff521"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "1303"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: IP Forwarding on your virtual machine should be disabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Enabling IP forwarding on a virtual machine's NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"disableIPForwarding\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"bd352bd5-2853-4985-bf0d-73806b4a5744\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/bda18df3-5e41-4709-add9-2554ce68c966?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZGExOGRmMy01ZTQxLTQ3MDktYWRkOS0yNTU0Y2U2OGM5NjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d32d47e9-d3fb-4b7d-a55c-e068ae1eaf47"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "4eb03d13-4c3f-4ddd-affc-5530e9c90cd2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:4eb03d13-4c3f-4ddd-affc-5530e9c90cd2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'bda18df3-5e41-4709-add9-2554ce68c966' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/bda18df3-5e41-4709-add9-2554ce68c966?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZGExOGRmMy01ZTQxLTQ3MDktYWRkOS0yNTU0Y2U2OGM5NjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:8d029d0b-f5aa-4eba-bbbd-6d12d69d480b"
        ],
        "x-ms-correlation-request-id": [
          "987dd7ab-ea1e-4473-b99d-524f8a29db95"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:987dd7ab-ea1e-4473-b99d-524f8a29db95"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "1174"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL managed instance Advanced Data Security settings\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/managedInstances\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/disabledAlerts[*]\",\r\n            \"equals\": \"\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"bda18df3-5e41-4709-add9-2554ce68c966\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/bde62c94-ccca-4821-a815-92c1d31a76de?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZGU2MmM5NC1jY2NhLTQ4MjEtYTgxNS05MmMxZDMxYTc2ZGU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:144f74ef-99ae-4bf5-a91c-2bb0653afa1c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "7b72485d-a4e3-4c47-b46f-4b01150955f0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:7b72485d-a4e3-4c47-b46f-4b01150955f0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'bde62c94-ccca-4821-a815-92c1d31a76de' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/bde62c94-ccca-4821-a815-92c1d31a76de?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZGU2MmM5NC1jY2NhLTQ4MjEtYTgxNS05MmMxZDMxYTc2ZGU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:2bebec5a-72e1-4dc3-91f8-7a716ec3c381"
        ],
        "x-ms-correlation-request-id": [
          "486bb370-022b-4aef-9d99-1e515a472604"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:486bb370-022b-4aef-9d99-1e515a472604"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:20 GMT"
        ],
        "Content-Length": [
          "1033"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs in which the Administrators group contains any of the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines in which the Administrators group contains any of the specified members. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"AdministratorsGroupMembersToExclude\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"bde62c94-ccca-4821-a815-92c1d31a76de\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZTBhNzY4MS1iZWQ0LTQ4ZGMtOWZmMy1mMDE3MWVlMTcwYjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:62e03b0d-659f-4e2e-a319-e3559fc0e50b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "f2f05d53-e135-4b5f-b8bf-c7fd83df1c43"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:f2f05d53-e135-4b5f-b8bf-c7fd83df1c43"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'be0a7681-bed4-48dc-9ff3-f0171ee170b6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9iZTBhNzY4MS1iZWQ0LTQ4ZGMtOWZmMy1mMDE3MWVlMTcwYjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:b170702b-d5b3-43c8-99f9-733836b26a43"
        ],
        "x-ms-correlation-request-id": [
          "28d58dc0-8b01-4171-ac6f-00855cf4909a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205321Z:28d58dc0-8b01-4171-ac6f-00855cf4909a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "1315"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Java Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported Java version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestJava\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"be0a7681-bed4-48dc-9ff3-f0171ee170b6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jMWI5Y2JlZC0wOGUzLTQyN2QtYjljZS03YzUzNWIxZTliOTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ce1caef0-cb83-4a82-8bed-2dfd918bc804"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "79cc9604-fc66-4dc8-a469-c16b4e1e6a16"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205322Z:79cc9604-fc66-4dc8-a469-c16b4e1e6a16"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c1b9cbed-08e3-427d-b9ce-7c535b1e9b94' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jMWI5Y2JlZC0wOGUzLTQyN2QtYjljZS03YzUzNWIxZTliOTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:fe850163-2b94-46cf-8c36-9c62ad34f61a"
        ],
        "x-ms-correlation-request-id": [
          "99a1a158-f19f-46b6-a22d-790465c5f341"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205322Z:99a1a158-f19f-46b6-a22d-790465c5f341"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:21 GMT"
        ],
        "Content-Length": [
          "720"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation only in Asia data centers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation in the following locations only: East Asia, Southeast Asia, West India, South India, Central India, Japan East, Japan West\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"location\",\r\n          \"in\": [\r\n            \"eastasia\",\r\n            \"southeastasia\",\r\n            \"westindia\",\r\n            \"southindia\",\r\n            \"centralindia\",\r\n            \"japaneast\",\r\n            \"japanwest\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jMjFmNzA2MC1jMTQ4LTQxY2YtYTY4Yi0wYWIzZTE0Yzc2NGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:38c21c3c-f6f4-4aa7-8229-fe5e5d494904"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "3ec7c0aa-cbe5-444c-9182-e97866158550"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205322Z:3ec7c0aa-cbe5-444c-9182-e97866158550"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:22 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c21f7060-c148-41cf-a68b-0ab3e14c764c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jMjFmNzA2MC1jMTQ4LTQxY2YtYTY4Yi0wYWIzZTE0Yzc2NGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:99a933e9-0121-4217-8f1f-d9ea9b93efe5"
        ],
        "x-ms-correlation-request-id": [
          "cdcc73b3-e68d-4b56-a9d5-0aff5bcea8bc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:cdcc73b3-e68d-4b56-a9d5-0aff5bcea8bc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:22 GMT"
        ],
        "Content-Length": [
          "8991"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs that are not set to the specified time zone\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not set to the specified time zone. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"TimeZone\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Time zone\",\r\n          \"description\": \"The expected time zone\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"(UTC-12:00) International Date Line West\",\r\n          \"(UTC-11:00) Coordinated Universal Time-11\",\r\n          \"(UTC-10:00) Aleutian Islands\",\r\n          \"(UTC-10:00) Hawaii\",\r\n          \"(UTC-09:30) Marquesas Islands\",\r\n          \"(UTC-09:00) Alaska\",\r\n          \"(UTC-09:00) Coordinated Universal Time-09\",\r\n          \"(UTC-08:00) Baja California\",\r\n          \"(UTC-08:00) Coordinated Universal Time-08\",\r\n          \"(UTC-08:00) Pacific Time (US & Canada)\",\r\n          \"(UTC-07:00) Arizona\",\r\n          \"(UTC-07:00) Chihuahua, La Paz, Mazatlan\",\r\n          \"(UTC-07:00) Mountain Time (US & Canada)\",\r\n          \"(UTC-06:00) Central America\",\r\n          \"(UTC-06:00) Central Time (US & Canada)\",\r\n          \"(UTC-06:00) Easter Island\",\r\n          \"(UTC-06:00) Guadalajara, Mexico City, Monterrey\",\r\n          \"(UTC-06:00) Saskatchewan\",\r\n          \"(UTC-05:00) Bogota, Lima, Quito, Rio Branco\",\r\n          \"(UTC-05:00) Chetumal\",\r\n          \"(UTC-05:00) Eastern Time (US & Canada)\",\r\n          \"(UTC-05:00) Haiti\",\r\n          \"(UTC-05:00) Havana\",\r\n          \"(UTC-05:00) Indiana (East)\",\r\n          \"(UTC-05:00) Turks and Caicos\",\r\n          \"(UTC-04:00) Asuncion\",\r\n          \"(UTC-04:00) Atlantic Time (Canada)\",\r\n          \"(UTC-04:00) Caracas\",\r\n          \"(UTC-04:00) Cuiaba\",\r\n          \"(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\",\r\n          \"(UTC-04:00) Santiago\",\r\n          \"(UTC-03:30) Newfoundland\",\r\n          \"(UTC-03:00) Araguaina\",\r\n          \"(UTC-03:00) Brasilia\",\r\n          \"(UTC-03:00) Cayenne, Fortaleza\",\r\n          \"(UTC-03:00) City of Buenos Aires\",\r\n          \"(UTC-03:00) Greenland\",\r\n          \"(UTC-03:00) Montevideo\",\r\n          \"(UTC-03:00) Punta Arenas\",\r\n          \"(UTC-03:00) Saint Pierre and Miquelon\",\r\n          \"(UTC-03:00) Salvador\",\r\n          \"(UTC-02:00) Coordinated Universal Time-02\",\r\n          \"(UTC-02:00) Mid-Atlantic - Old\",\r\n          \"(UTC-01:00) Azores\",\r\n          \"(UTC-01:00) Cabo Verde Is.\",\r\n          \"(UTC) Coordinated Universal Time\",\r\n          \"(UTC+00:00) Dublin, Edinburgh, Lisbon, London\",\r\n          \"(UTC+00:00) Monrovia, Reykjavik\",\r\n          \"(UTC+00:00) Sao Tome\",\r\n          \"(UTC+01:00) Casablanca\",\r\n          \"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\",\r\n          \"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\",\r\n          \"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris\",\r\n          \"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb\",\r\n          \"(UTC+01:00) West Central Africa\",\r\n          \"(UTC+02:00) Amman\",\r\n          \"(UTC+02:00) Athens, Bucharest\",\r\n          \"(UTC+02:00) Beirut\",\r\n          \"(UTC+02:00) Cairo\",\r\n          \"(UTC+02:00) Chisinau\",\r\n          \"(UTC+02:00) Damascus\",\r\n          \"(UTC+02:00) Gaza, Hebron\",\r\n          \"(UTC+02:00) Harare, Pretoria\",\r\n          \"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\",\r\n          \"(UTC+02:00) Jerusalem\",\r\n          \"(UTC+02:00) Kaliningrad\",\r\n          \"(UTC+02:00) Khartoum\",\r\n          \"(UTC+02:00) Tripoli\",\r\n          \"(UTC+02:00) Windhoek\",\r\n          \"(UTC+03:00) Baghdad\",\r\n          \"(UTC+03:00) Istanbul\",\r\n          \"(UTC+03:00) Kuwait, Riyadh\",\r\n          \"(UTC+03:00) Minsk\",\r\n          \"(UTC+03:00) Moscow, St. Petersburg\",\r\n          \"(UTC+03:00) Nairobi\",\r\n          \"(UTC+03:30) Tehran\",\r\n          \"(UTC+04:00) Abu Dhabi, Muscat\",\r\n          \"(UTC+04:00) Astrakhan, Ulyanovsk\",\r\n          \"(UTC+04:00) Baku\",\r\n          \"(UTC+04:00) Izhevsk, Samara\",\r\n          \"(UTC+04:00) Port Louis\",\r\n          \"(UTC+04:00) Saratov\",\r\n          \"(UTC+04:00) Tbilisi\",\r\n          \"(UTC+04:00) Volgograd\",\r\n          \"(UTC+04:00) Yerevan\",\r\n          \"(UTC+04:30) Kabul\",\r\n          \"(UTC+05:00) Ashgabat, Tashkent\",\r\n          \"(UTC+05:00) Ekaterinburg\",\r\n          \"(UTC+05:00) Islamabad, Karachi\",\r\n          \"(UTC+05:00) Qyzylorda\",\r\n          \"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi\",\r\n          \"(UTC+05:30) Sri Jayawardenepura\",\r\n          \"(UTC+05:45) Kathmandu\",\r\n          \"(UTC+06:00) Astana\",\r\n          \"(UTC+06:00) Dhaka\",\r\n          \"(UTC+06:00) Omsk\",\r\n          \"(UTC+06:30) Yangon (Rangoon)\",\r\n          \"(UTC+07:00) Bangkok, Hanoi, Jakarta\",\r\n          \"(UTC+07:00) Barnaul, Gorno-Altaysk\",\r\n          \"(UTC+07:00) Hovd\",\r\n          \"(UTC+07:00) Krasnoyarsk\",\r\n          \"(UTC+07:00) Novosibirsk\",\r\n          \"(UTC+07:00) Tomsk\",\r\n          \"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi\",\r\n          \"(UTC+08:00) Irkutsk\",\r\n          \"(UTC+08:00) Kuala Lumpur, Singapore\",\r\n          \"(UTC+08:00) Perth\",\r\n          \"(UTC+08:00) Taipei\",\r\n          \"(UTC+08:00) Ulaanbaatar\",\r\n          \"(UTC+08:45) Eucla\",\r\n          \"(UTC+09:00) Chita\",\r\n          \"(UTC+09:00) Osaka, Sapporo, Tokyo\",\r\n          \"(UTC+09:00) Pyongyang\",\r\n          \"(UTC+09:00) Seoul\",\r\n          \"(UTC+09:00) Yakutsk\",\r\n          \"(UTC+09:30) Adelaide\",\r\n          \"(UTC+09:30) Darwin\",\r\n          \"(UTC+10:00) Brisbane\",\r\n          \"(UTC+10:00) Canberra, Melbourne, Sydney\",\r\n          \"(UTC+10:00) Guam, Port Moresby\",\r\n          \"(UTC+10:00) Hobart\",\r\n          \"(UTC+10:00) Vladivostok\",\r\n          \"(UTC+10:30) Lord Howe Island\",\r\n          \"(UTC+11:00) Bougainville Island\",\r\n          \"(UTC+11:00) Chokurdakh\",\r\n          \"(UTC+11:00) Magadan\",\r\n          \"(UTC+11:00) Norfolk Island\",\r\n          \"(UTC+11:00) Sakhalin\",\r\n          \"(UTC+11:00) Solomon Is., New Caledonia\",\r\n          \"(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky\",\r\n          \"(UTC+12:00) Auckland, Wellington\",\r\n          \"(UTC+12:00) Coordinated Universal Time+12\",\r\n          \"(UTC+12:00) Fiji\",\r\n          \"(UTC+12:00) Petropavlovsk-Kamchatsky - Old\",\r\n          \"(UTC+12:45) Chatham Islands\",\r\n          \"(UTC+13:00) Coordinated Universal Time+13\",\r\n          \"(UTC+13:00) Nuku'alofa\",\r\n          \"(UTC+13:00) Samoa\",\r\n          \"(UTC+14:00) Kiritimati Island\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsTimeZone\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[WindowsTimeZone]WindowsTimeZone1;TimeZone', '=', parameters('TimeZone')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsTimeZone\"\r\n                },\r\n                \"TimeZone\": {\r\n                  \"value\": \"[parameters('TimeZone')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"TimeZone\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[WindowsTimeZone]WindowsTimeZone1;TimeZone\",\r\n                            \"value\": \"[parameters('TimeZone')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c21f7060-c148-41cf-a68b-0ab3e14c764c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jMmRkMmE5YS04YTIwLTRhOWMtYjhkNi1mMTdjY2MyNjkzOWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:98aa6fa6-5dea-419a-9a4d-577e5afef803"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "45d315f8-6392-4b2f-b670-6eb1327daacd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:45d315f8-6392-4b2f-b670-6eb1327daacd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jMmRkMmE5YS04YTIwLTRhOWMtYjhkNi1mMTdjY2MyNjkzOWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:e4877436-c172-4505-bbd0-6a7c34835dba"
        ],
        "x-ms-correlation-request-id": [
          "2b2d34e8-4bb9-40d3-b93b-154a46f1a6eb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:2b2d34e8-4bb9-40d3-b93b-154a46f1a6eb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:22 GMT"
        ],
        "Content-Length": [
          "1002"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines on which the specified services are not installed and 'Running'. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsServiceStatus\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jM2YzMTdhNy1hOTVjLTQ1NDctYjdlNy0xMTAxN2ViZGYyZmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:53d85b43-d644-4013-a445-3e27c48532d0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "40cfe054-2b78-4cb8-be4c-47c895eda913"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:40cfe054-2b78-4cb8-be4c-47c895eda913"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:22 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c3f317a7-a95c-4547-b7e7-11017ebdf2fe' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jM2YzMTdhNy1hOTVjLTQ1NDctYjdlNy0xMTAxN2ViZGYyZmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:151e9c6b-c949-45f1-809d-f06a2544de68"
        ],
        "x-ms-correlation-request-id": [
          "892b93af-e314-4b8c-986f-fa4a5013c832"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:892b93af-e314-4b8c-986f-fa4a5013c832"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:22 GMT"
        ],
        "Content-Length": [
          "1140"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"System updates on virtual machine scale sets should be installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit whether there are any missing system security updates and critical updates that should be installed to ensure that your Windows and Linux virtual machine scale sets are secure.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"SystemUpdates\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c3f317a7-a95c-4547-b7e7-11017ebdf2fe\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c40c9087-1981-4e73-9f53-39743eda9d05?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jNDBjOTA4Ny0xOTgxLTRlNzMtOWY1My0zOTc0M2VkYTlkMDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:847890c8-d54b-4409-8ef8-2291709db620"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "46740d58-5799-4a3d-8c12-203bd739053b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:46740d58-5799-4a3d-8c12-203bd739053b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c40c9087-1981-4e73-9f53-39743eda9d05' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c40c9087-1981-4e73-9f53-39743eda9d05?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jNDBjOTA4Ny0xOTgxLTRlNzMtOWY1My0zOTc0M2VkYTlkMDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:a970cee6-84ff-4504-87ea-0985fa17de84"
        ],
        "x-ms-correlation-request-id": [
          "41b21ba1-d3a3-4a32-83af-ae912412cec3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:41b21ba1-d3a3-4a32-83af-ae912412cec3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "957"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Linux VMs that have accounts without passwords\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Linux virtual machines that have accounts without passwords. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"PasswordPolicy_msid232\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c40c9087-1981-4e73-9f53-39743eda9d05\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jNWZiYzU5ZS1mYjZmLTQ5NGYtODFlMi1kOTlhNjcxYmRhYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:dc46f5e0-944e-481f-b2ee-f8e8e574c159"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "1c243039-80b1-4ff8-a412-8524a37d4bd5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205323Z:1c243039-80b1-4ff8-a412-8524a37d4bd5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c5fbc59e-fb6f-494f-81e2-d99a671bdaa8' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jNWZiYzU5ZS1mYjZmLTQ5NGYtODFlMi1kOTlhNjcxYmRhYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:2df5dc65-8207-403e-bda0-ad6e448b6b27"
        ],
        "x-ms-correlation-request-id": [
          "9325ddec-beb0-41fd-b9bf-3ea38a019ce9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:9325ddec-beb0-41fd-b9bf-3ea38a019ce9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "8316"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that contain certificates expiring within the specified number of days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that contain certificates expiring within the specified number of days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"CertificateStorePath\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate store path\",\r\n          \"description\": \"The path to the certificate store containing the certificates to check the expiration dates of. Default value is 'Cert:' which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: 'Cert:\\\\LocalMachine', 'Cert:\\\\LocalMachine\\\\TrustedPublisher', 'Cert:\\\\CurrentUser'\"\r\n        },\r\n        \"defaultValue\": \"Cert:\"\r\n      },\r\n      \"ExpirationLimitInDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Expiration limit in days\",\r\n          \"description\": \"An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"CertificateThumbprintsToInclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate thumbprints to include\",\r\n          \"description\": \"A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"CertificateThumbprintsToExclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate thumbprints to exclude\",\r\n          \"description\": \"A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"IncludeExpiredCertificates\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Include expired certificates\",\r\n          \"description\": \"Must be 'true' or 'false'. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"false\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"CertificateExpiration\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateStorePath', '=', parameters('CertificateStorePath'), ',', '[CertificateStore]CertificateStore1;ExpirationLimitInDays', '=', parameters('ExpirationLimitInDays'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprintsToInclude'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude', '=', parameters('CertificateThumbprintsToExclude'), ',', '[CertificateStore]CertificateStore1;IncludeExpiredCertificates', '=', parameters('IncludeExpiredCertificates')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"CertificateExpiration\"\r\n                },\r\n                \"CertificateStorePath\": {\r\n                  \"value\": \"[parameters('CertificateStorePath')]\"\r\n                },\r\n                \"ExpirationLimitInDays\": {\r\n                  \"value\": \"[parameters('ExpirationLimitInDays')]\"\r\n                },\r\n                \"CertificateThumbprintsToInclude\": {\r\n                  \"value\": \"[parameters('CertificateThumbprintsToInclude')]\"\r\n                },\r\n                \"CertificateThumbprintsToExclude\": {\r\n                  \"value\": \"[parameters('CertificateThumbprintsToExclude')]\"\r\n                },\r\n                \"IncludeExpiredCertificates\": {\r\n                  \"value\": \"[parameters('IncludeExpiredCertificates')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"CertificateStorePath\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ExpirationLimitInDays\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"CertificateThumbprintsToInclude\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"CertificateThumbprintsToExclude\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"IncludeExpiredCertificates\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[CertificateStore]CertificateStore1;CertificateStorePath\",\r\n                            \"value\": \"[parameters('CertificateStorePath')]\"\r\n                          },\r\n                          {\r\n                            \"name\": \"[CertificateStore]CertificateStore1;ExpirationLimitInDays\",\r\n                            \"value\": \"[parameters('ExpirationLimitInDays')]\"\r\n                          },\r\n                          {\r\n                            \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                            \"value\": \"[parameters('CertificateThumbprintsToInclude')]\"\r\n                          },\r\n                          {\r\n                            \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\",\r\n                            \"value\": \"[parameters('CertificateThumbprintsToExclude')]\"\r\n                          },\r\n                          {\r\n                            \"name\": \"[CertificateStore]CertificateStore1;IncludeExpiredCertificates\",\r\n                            \"value\": \"[parameters('IncludeExpiredCertificates')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jODU1MzhjMS1iNTI3LTRjZTQtYmRiNC0xZGFiY2IzZmQ5MGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:99f67775-1ac8-4477-a796-edaf64bdb8d3"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "44fc7243-2a2f-4d8d-b9b2-7020bc22dcc5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:44fc7243-2a2f-4d8d-b9b2-7020bc22dcc5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c85538c1-b527-4ce4-bdb4-1dabcb3fd90d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jODU1MzhjMS1iNTI3LTRjZTQtYmRiNC0xZGFiY2IzZmQ5MGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:a625a5d2-5c58-4a48-add9-75f44a6e078b"
        ],
        "x-ms-correlation-request-id": [
          "6d3a5e92-1739-4487-9b41-4cbad86741bd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:6d3a5e92-1739-4487-9b41-4cbad86741bd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "1129"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"API App should only be accessible over HTTPS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"OnlyHttpsForApiApp\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jOTVjNzRkOS0zOGZlLTRmMGQtYWY4Ni0wYzdkNjI2YTMxNWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c989aff8-c754-40fa-894a-bfc2c0a76de5"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "c1492a72-a0bb-4300-9275-f6f4eedb0a3d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:c1492a72-a0bb-4300-9275-f6f4eedb0a3d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:23 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c95c74d9-38fe-4f0d-af86-0c7d626a315c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jOTVjNzRkOS0zOGZlLTRmMGQtYWY4Ni0wYzdkNjI2YTMxNWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:6eec0d0c-b1b4-4b39-887a-e993d4f51b70"
        ],
        "x-ms-correlation-request-id": [
          "12d3faac-bf71-4f83-8db8-4cb7ddc7bed9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:12d3faac-bf71-4f83-8db8-4cb7ddc7bed9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "1695"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Data Lake Analytics should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Data Lake\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.DataLakeAnalytics/accounts\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c95c74d9-38fe-4f0d-af86-0c7d626a315c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jOTZmMzI0Ni00MzgyLTQyNjQtYmY2Yi1hZjBiMzVlMjNjM2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:73c6e681-2cd3-4603-a4d3-08fd1317207e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "c605e063-4767-46f0-8f5f-721a6757b080"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:c605e063-4767-46f0-8f5f-721a6757b080"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c96f3246-4382-4264-bf6b-af0b35e23c3c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jOTZmMzI0Ni00MzgyLTQyNjQtYmY2Yi1hZjBiMzVlMjNjM2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:807d9aef-4812-4c58-b9dc-21bcc25ef21c"
        ],
        "x-ms-correlation-request-id": [
          "56a5038e-3a5c-4556-9219-06c59687e8c4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205324Z:56a5038e-3a5c-4556-9219-06c59687e8c4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "4225"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs with a pending reboot\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with a pending reboot. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsPendingReboot\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsPendingReboot\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c96f3246-4382-4264-bf6b-af0b35e23c3c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jOWMyOTQ5OS1jMWQxLTQxOTUtOTliZC0yZWM5ZTNhOWRjODk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:aa14251f-100a-4b03-aad4-d9c2ce9d9b0b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "33e788e2-2f80-4351-9dc3-9ec1c7ec676b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205325Z:33e788e2-2f80-4351-9dc3-9ec1c7ec676b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'c9c29499-c1d1-4195-99bd-2ec9e3a9dc89' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jOWMyOTQ5OS1jMWQxLTQxOTUtOTliZC0yZWM5ZTNhOWRjODk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:6306f4ea-4e28-4281-94f0-d77ea9b52251"
        ],
        "x-ms-correlation-request-id": [
          "d205f2ef-a0e8-4c40-acbd-b26a1c6ac357"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205325Z:d205f2ef-a0e8-4c40-acbd-b26a1c6ac357"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "3906"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Diagnostic Settings for Network Security Groups\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy automatically deploys diagnostic settings to network security groups. A storage account with name '{storagePrefixParameter}{NSGLocation}' will be automatically created.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"storagePrefix\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage Account Prefix for Regional Storage Account\",\r\n          \"description\": \"This prefix will be combined with the network security group location to form the created storage account name.\"\r\n        }\r\n      },\r\n      \"rgName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name for Storage Account (must exist)\",\r\n          \"description\": \"The resource group that the storage account will be created in. This resource group must already exist.\",\r\n          \"strongType\": \"ExistingResourceGroups\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"name\": \"setbypolicy\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n            \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"storagePrefix\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"nsgName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"rgName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"storageDeployName\": \"[concat('policyStorage_', uniqueString(parameters('location'), parameters('nsgName')))]\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\",\r\n                    \"name\": \"[concat(parameters('nsgName'),'/Microsoft.Insights/setbypolicy')]\",\r\n                    \"apiVersion\": \"2017-05-01-preview\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"dependsOn\": [\r\n                      \"[variables('storageDeployName')]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"storageAccountId\": \"[reference(variables('storageDeployName')).outputs.storageAccountId.value]\",\r\n                      \"logs\": [\r\n                        {\r\n                          \"category\": \"NetworkSecurityGroupEvent\",\r\n                          \"enabled\": true,\r\n                          \"retentionPolicy\": {\r\n                            \"enabled\": false,\r\n                            \"days\": 0\r\n                          }\r\n                        },\r\n                        {\r\n                          \"category\": \"NetworkSecurityGroupRuleCounter\",\r\n                          \"enabled\": true,\r\n                          \"retentionPolicy\": {\r\n                            \"enabled\": false,\r\n                            \"days\": 0\r\n                          }\r\n                        }\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-05-10\",\r\n                    \"name\": \"[variables('storageDeployName')]\",\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"resourceGroup\": \"[parameters('rgName')]\",\r\n                    \"properties\": {\r\n                      \"mode\": \"incremental\",\r\n                      \"parameters\": {\r\n                        \"location\": {\r\n                          \"value\": \"[parameters('location')]\"\r\n                        },\r\n                        \"storagePrefix\": {\r\n                          \"value\": \"[parameters('storagePrefix')]\"\r\n                        }\r\n                      },\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"location\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"storagePrefix\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"resources\": [\r\n                          {\r\n                            \"apiVersion\": \"2017-06-01\",\r\n                            \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                            \"name\": \"[concat(parameters('storageprefix'), parameters('location'))]\",\r\n                            \"sku\": {\r\n                              \"name\": \"Standard_LRS\",\r\n                              \"tier\": \"Standard\"\r\n                            },\r\n                            \"kind\": \"Storage\",\r\n                            \"location\": \"[parameters('location')]\",\r\n                            \"tags\": {\r\n                              \"created-by\": \"policy\"\r\n                            },\r\n                            \"scale\": null,\r\n                            \"properties\": {\r\n                              \"networkAcls\": {\r\n                                \"bypass\": \"AzureServices\",\r\n                                \"defaultAction\": \"Allow\",\r\n                                \"ipRules\": [],\r\n                                \"virtualNetworkRules\": []\r\n                              },\r\n                              \"supportsHttpsTrafficOnly\": true\r\n                            }\r\n                          }\r\n                        ],\r\n                        \"outputs\": {\r\n                          \"storageAccountId\": {\r\n                            \"type\": \"string\",\r\n                            \"value\": \"[resourceId(parameters('rgName'), 'Microsoft.Storage/storageAccounts',concat(parameters('storagePrefix'), parameters('location')))]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"storagePrefix\": {\r\n                  \"value\": \"[parameters('storagePrefix')]\"\r\n                },\r\n                \"rgName\": {\r\n                  \"value\": \"[parameters('rgName')]\"\r\n                },\r\n                \"nsgName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jYjUxMGJmZC0xY2JhLTRkOWYtYTIzMC1jYjA5NzZmNGJiNzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:19eb5aa7-decb-4e5f-bbb8-40a95231d083"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "598068f8-70b0-4475-abf2-3c23ec1c0da5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205325Z:598068f8-70b0-4475-abf2-3c23ec1c0da5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:24 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cb510bfd-1cba-4d9f-a230-cb0976f4bb71' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jYjUxMGJmZC0xY2JhLTRkOWYtYTIzMC1jYjA5NzZmNGJiNzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:8dab3a48-772a-4784-9fdc-9c264b4c0e79"
        ],
        "x-ms-correlation-request-id": [
          "7065cbfb-b8d3-4809-833d-4aabce1df04b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205325Z:7065cbfb-b8d3-4809-833d-4aabce1df04b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "1235"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Remote debugging should be turned off for Web Application\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Remote debugging requires inbound ports to be opened on a web application.  Remote debugging should be turned off.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoteDebuggingForWebApplication\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cb510bfd-1cba-4d9f-a230-cb0976f4bb71\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cc7cda28-f867-4311-8497-a526129a8d19?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jYzdjZGEyOC1mODY3LTQzMTEtODQ5Ny1hNTI2MTI5YThkMTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:62e67cad-7bbc-4e02-8f5b-1dbeab4fb14f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "bdfa54a7-6301-499c-a9d5-b3a45a47eb43"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205325Z:bdfa54a7-6301-499c-a9d5-b3a45a47eb43"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cc7cda28-f867-4311-8497-a526129a8d19' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cc7cda28-f867-4311-8497-a526129a8d19?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jYzdjZGEyOC1mODY3LTQzMTEtODQ5Ny1hNTI2MTI5YThkMTk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:c8fdc6e5-ff75-4075-bfaa-266e7acdb21d"
        ],
        "x-ms-correlation-request-id": [
          "885a3bf8-e427-4884-992d-64c148f6bee2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:885a3bf8-e427-4884-992d-64c148f6bee2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "1036"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain only the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines in which the Administrators group does not contain only the specified members. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"AdministratorsGroupMembers\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cc7cda28-f867-4311-8497-a526129a8d19\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cc7cda28-f867-4311-8497-a526129a8d19\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jYzk4MzVmMi05ZjZiLTRjYzgtYWI0YS1mOGVmNjE1ZWIzNDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1b2c5c6e-9668-47bf-88fd-d9a2cdad3d5b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "92d61d3d-ec16-455f-a6bd-9bc4a1d17073"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:92d61d3d-ec16-455f-a6bd-9bc4a1d17073"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jYzk4MzVmMi05ZjZiLTRjYzgtYWI0YS1mOGVmNjE1ZWIzNDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:7aaaee92-7265-4301-8e71-955c9a87dc56"
        ],
        "x-ms-correlation-request-id": [
          "4f936af8-2842-4534-a4d8-b948acefaf78"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:4f936af8-2842-4534-a4d8-b948acefaf78"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "1245"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Sensitive data in your SQL databases should be classified\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Azure Security Center monitors the data discovery and classification scan results for your SQL databases and provides recommendations to classify the sensitive data in your databases for better monitoring and security\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/managedInstances/databases\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"sqlDataClassification\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jY2NjMjNjNy04NDI3LTRmNTMtYWQxMi1iNmE2M2ViNDUyYjM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:4cf3fcde-a276-4169-a20b-e5c5d51b3e0a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "9f963975-d978-406a-bff7-6b9576793341"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:9f963975-d978-406a-bff7-6b9576793341"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cccc23c7-8427-4f53-ad12-b6a63eb452b3' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jY2NjMjNjNy04NDI3LTRmNTMtYWQxMi1iNmE2M2ViNDUyYjM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:8b117ac3-ee0d-490f-a2bd-b520b269c110"
        ],
        "x-ms-correlation-request-id": [
          "bfa0c129-a952-4160-9221-51e75c74d161"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:bfa0c129-a952-4160-9221-51e75c74d161"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:26 GMT"
        ],
        "Content-Length": [
          "861"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allowed virtual machine SKUs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy enables you to specify a set of virtual machine SKUs that your organization can deploy.\",\r\n    \"metadata\": {\r\n      \"category\": \"Compute\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfAllowedSKUs\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"description\": \"The list of SKUs that can be specified for virtual machines.\",\r\n          \"displayName\": \"Allowed SKUs\",\r\n          \"strongType\": \"VMSKUs\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n              \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cccc23c7-8427-4f53-ad12-b6a63eb452b3\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jZDhkYzg3OS1hMmFlLTQzYzMtODIxMS0xODc3YzU3NTUwNjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:127fd57a-fd83-4221-9573-7ccd893117b7"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "d1e4fb88-f21f-45f2-8a94-2ed1e9681510"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:d1e4fb88-f21f-45f2-8a94-2ed1e9681510"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cd8dc879-a2ae-43c3-8211-1877c5755064' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jZDhkYzg3OS1hMmFlLTQzYzMtODIxMS0xODc3YzU3NTUwNjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:0a98d0d5-8267-4e5b-903e-89db7927f79b"
        ],
        "x-ms-correlation-request-id": [
          "eeaa3bbc-7a43-4612-9ef0-b710fbb9b4ba"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205326Z:eeaa3bbc-7a43-4612-9ef0-b710fbb9b4ba"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:25 GMT"
        ],
        "Content-Length": [
          "556"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation if 'department' tag set\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation only if the 'department' tag is set\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"tags\",\r\n          \"containsKey\": \"department\"\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cd8dc879-a2ae-43c3-8211-1877c5755064\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jZGJmNzJkOS1hYzljLTQwMjYtOGEzYS00OTFhNWFjNTkyOTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:72c88fd5-aa05-409a-8611-daebb0d4958c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "37af1469-85a9-41ce-831f-fa5e62c7d01a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:37af1469-85a9-41ce-831f-fa5e62c7d01a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:26 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cdbf72d9-ac9c-4026-8a3a-491a5ac59293' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jZGJmNzJkOS1hYzljLTQwMjYtOGEzYS00OTFhNWFjNTkyOTM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:9add35c4-f38b-40b3-b6be-7ca177974c62"
        ],
        "x-ms-correlation-request-id": [
          "2cb3d474-822a-4893-a05b-d72fda5b6f81"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:2cb3d474-822a-4893-a05b-d72fda5b6f81"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:26 GMT"
        ],
        "Content-Length": [
          "981"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that allow re-use of the previous 24 passwords\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that allow re-use of the previous 24 passwords. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"EnforcePasswordHistory\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cdbf72d9-ac9c-4026-8a3a-491a5ac59293\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jZjgyMGNhMC1mOTllLTRmM2UtODRmYi02NmU5MTM4MTJkMjE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e623443e-793e-4a0e-a991-bd09ee095389"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "8b578f0b-07be-445c-8d19-56257c1b166e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:8b578f0b-07be-445c-8d19-56257c1b166e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'cf820ca0-f99e-4f3e-84fb-66e913812d21' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9jZjgyMGNhMC1mOTllLTRmM2UtODRmYi02NmU5MTM4MTJkMjE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:9b2b08a6-eafc-4a20-b3e9-42a24f624b38"
        ],
        "x-ms-correlation-request-id": [
          "143745c7-e260-4f04-8212-b9049ffdb129"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:143745c7-e260-4f04-8212-b9049ffdb129"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "1674"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Key Vault should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Key Vault\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.KeyVault/vaults\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"cf820ca0-f99e-4f3e-84fb-66e913812d21\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kMWNiNDdkYi1iN2ExLTRjNDYtODE0ZS1hYWQxYzBlODRmM2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1205a8c6-8873-4cc2-8805-1f1ff3cad8ec"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "4b7bf460-87a2-4e16-9f26-7b720c9c5071"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:4b7bf460-87a2-4e16-9f26-7b720c9c5071"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'd1cb47db-b7a1-4c46-814e-aad1c0e84f3c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kMWNiNDdkYi1iN2ExLTRjNDYtODE0ZS1hYWQxYzBlODRmM2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:18277c5a-a0c4-4394-a05e-02d90f104892"
        ],
        "x-ms-correlation-request-id": [
          "b4f965b5-7f5f-4105-be02-020891737fd5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:b4f965b5-7f5f-4105-be02-020891737fd5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "1263"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Function Apps that are not using custom domains\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use of custom domains protects a Function app from common attacks such as phishing and other DNS-related attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"functionapp,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UsedCustomDomains\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"d1cb47db-b7a1-4c46-814e-aad1c0e84f3c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kMzhiNGMyNi05ZDJlLTQ3ZDctYWVmZS0xOGQ4NTlhODcwNmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d7aaa781-d34d-4322-8575-9f971e9b63ea"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "eed34c7d-fb99-453c-8936-c738e506e57f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:eed34c7d-fb99-453c-8936-c738e506e57f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'd38b4c26-9d2e-47d7-aefe-18d859a8706a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kMzhiNGMyNi05ZDJlLTQ3ZDctYWVmZS0xOGQ4NTlhODcwNmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:7a86c8d8-a506-43ba-aad8-11712c4e5c0f"
        ],
        "x-ms-correlation-request-id": [
          "f2b97be2-b954-4b7c-98d4-3ca46da8e2e1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205327Z:f2b97be2-b954-4b7c-98d4-3ca46da8e2e1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "4376"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs on which the DSC configuration is not compliant\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"WindowsDscConfiguration\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"WindowsDscConfiguration\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"d38b4c26-9d2e-47d7-aefe-18d859a8706a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kN2NjZDBjYS04ZDc4LTQyYWYtYTQzZC02YjdmOTI4YWNjYmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a2fe3457-b4b0-41e3-a241-056c8caa999f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "355923e2-dfc7-4efd-900a-9b1508a34eaa"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:355923e2-dfc7-4efd-900a-9b1508a34eaa"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'd7ccd0ca-8d78-42af-a43d-6b7f928accbc' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kN2NjZDBjYS04ZDc4LTQyYWYtYTQzZC02YjdmOTI4YWNjYmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:f46a5602-20af-49eb-acdf-c39589cb4d08"
        ],
        "x-ms-correlation-request-id": [
          "3f79b479-7cbe-4b9f-85c1-d097cf7209ed"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:3f79b479-7cbe-4b9f-85c1-d097cf7209ed"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "982"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows Server VMs on which Windows Serial Console is not enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows Server virtual machines on which Windows Serial Console is not enabled. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsSerialConsole\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"d7ccd0ca-8d78-42af-a43d-6b7f928accbc\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kZDJlYTUyMC02YjA2LTQ1YzMtODA2ZS1lYTI5N2MyM2UwNmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:20f0309d-efde-4cfc-8694-abb54cba8970"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11989"
        ],
        "x-ms-correlation-request-id": [
          "5527d7c6-8bac-477e-a47c-43bb2e705d5f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:5527d7c6-8bac-477e-a47c-43bb2e705d5f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'dd2ea520-6b06-45c3-806e-ea297c23e06a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kZDJlYTUyMC02YjA2LTQ1YzMtODA2ZS1lYTI5N2MyM2UwNmE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "e2195a34-c684-4761-927f-b91d1f8f75c3"
        ],
        "x-ms-request-id": [
          "westus:89b09d23-1e4e-4569-922f-bd4866c789ac"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:e2195a34-c684-4761-927f-b91d1f8f75c3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "1280"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Applications that are not using custom domains\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use of custom domains protects a web application from common attacks such as phishing and other DNS-related attacks.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UsedCustomDomains\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"dd2ea520-6b06-45c3-806e-ea297c23e06a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e01598e8-6538-41ed-95e8-8b29746cd697?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMDE1OThlOC02NTM4LTQxZWQtOTVlOC04YjI5NzQ2Y2Q2OTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c17d6ab8-8286-41a5-9fe3-ecce18ae6a8f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "a73713b4-6204-4c59-aee9-131bfa7b8239"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:a73713b4-6204-4c59-aee9-131bfa7b8239"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e01598e8-6538-41ed-95e8-8b29746cd697' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e01598e8-6538-41ed-95e8-8b29746cd697?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMDE1OThlOC02NTM4LTQxZWQtOTVlOC04YjI5NzQ2Y2Q2OTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:e84d50d4-310c-4acf-964d-d3b720a75fd8"
        ],
        "x-ms-correlation-request-id": [
          "dca8d22e-c295-46a2-8827-025b38ba49d6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:dca8d22e-c295-46a2-8827-025b38ba49d6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:28 GMT"
        ],
        "Content-Length": [
          "587"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n    \"metadata\": {\r\n      \"category\": \"General\",\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {},\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"not\": {\r\n          \"field\": \"location\",\r\n          \"in\": [\r\n            \"japaneast\",\r\n            \"japanwest\"\r\n          ]\r\n        }\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"Deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e01598e8-6538-41ed-95e8-8b29746cd697\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMWU1ZmQ1ZC0zZTRjLTRjZTEtODY2MS03ZDE4NzNhZTZiMTU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:4494f12f-0c19-43ee-91e3-129a9ab6e4b1"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "a6859ef0-9ce7-4199-937e-a37316db4274"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:a6859ef0-9ce7-4199-937e-a37316db4274"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:27 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMWU1ZmQ1ZC0zZTRjLTRjZTEtODY2MS03ZDE4NzNhZTZiMTU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:8bd6e5fa-315d-4b75-b285-a205978350f9"
        ],
        "x-ms-correlation-request-id": [
          "36450a22-a4af-4c25-aed8-9fd4208875fa"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205328Z:36450a22-a4af-4c25-aed8-9fd4208875fa"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:28 GMT"
        ],
        "Content-Length": [
          "1120"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Vulnerabilities in security configuration on your machines should be remediated\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"osVulnerabilities\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMmRkNzk5YS1hOTMyLTRlOWQtYWMxNy1kNDczYmMzYzZjMTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ac6a5bcc-b327-4e69-9d9a-8983b57793df"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "5d157d9c-1426-441f-b040-acc9f9cfc8a5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:5d157d9c-1426-441f-b040-acc9f9cfc8a5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:28 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e2dd799a-a932-4e9d-ac17-d473bc3c6c10' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMmRkNzk5YS1hOTMyLTRlOWQtYWMxNy1kNDczYmMzYzZjMTA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:3814efa1-0c76-4e16-b52d-846fca41ed45"
        ],
        "x-ms-correlation-request-id": [
          "3d264624-0f23-4e51-9d6b-dea367630ae3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:3d264624-0f23-4e51-9d6b-dea367630ae3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:28 GMT"
        ],
        "Content-Length": [
          "5770"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Dependency Agent Deployment in VMSS - VM Image (OS) unlisted\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Reports VMSS as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfImageIdToInclude_windows\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      },\r\n      \"listOfImageIdToInclude_linux\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          {\r\n            \"not\": {\r\n              \"anyOf\": [\r\n                {\r\n                  \"field\": \"Microsoft.Compute/imageId\",\r\n                  \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                },\r\n                {\r\n                  \"field\": \"Microsoft.Compute/imageId\",\r\n                  \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                },\r\n                {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"2008-R2-SP1\",\r\n                            \"2008-R2-SP1-smalldisk\",\r\n                            \"2012-Datacenter\",\r\n                            \"2012-Datacenter-smalldisk\",\r\n                            \"2012-R2-Datacenter\",\r\n                            \"2012-R2-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter\",\r\n                            \"2016-Datacenter-Server-Core\",\r\n                            \"2016-Datacenter-Server-Core-smalldisk\",\r\n                            \"2016-Datacenter-smalldisk\",\r\n                            \"2016-Datacenter-with-Containers\",\r\n                            \"2016-Datacenter-with-RDSH\",\r\n                            \"2019-Datacenter\",\r\n                            \"2019-Datacenter-Core\",\r\n                            \"2019-Datacenter-Core-smalldisk\",\r\n                            \"2019-Datacenter-Core-with-Containers\",\r\n                            \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-smalldisk\",\r\n                            \"2019-Datacenter-with-Containers\",\r\n                            \"2019-Datacenter-with-Containers-smalldisk\",\r\n                            \"2019-Datacenter-zhcn\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerSemiAnnual\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"Datacenter-Core-1709-smalldisk\",\r\n                            \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                            \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"WindowsServerHPCPack\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftSQLServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2016-BYOL\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"like\": \"*-WS2012R2-BYOL\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftRServer\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"MLServer-WS2016\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftVisualStudio\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"VisualStudio\",\r\n                            \"Windows\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftDynamicsAX\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Dynamics\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"microsoft-ads\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"windows-data-science-vm\"\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsDesktop\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Windows-10\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"RedHat\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"RHEL\",\r\n                        \"RHEL-SAP-HANA\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"SUSE\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"SLES\",\r\n                        \"SLES-HPC\",\r\n                        \"SLES-HPC-Priority\",\r\n                        \"SLES-SAP\",\r\n                        \"SLES-SAP-BYOS\",\r\n                        \"SLES-Priority\",\r\n                        \"SLES-BYOS\",\r\n                        \"SLES-SAPCAL\",\r\n                        \"SLES-Standard\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"12-SP2\",\r\n                            \"12-SP3\",\r\n                            \"12-SP4\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"Canonical\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"UbuntuServer\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"14.04.0-LTS\",\r\n                            \"14.04.1-LTS\",\r\n                            \"14.04.5-LTS\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"16.04-LTS\",\r\n                            \"16.04.0-LTS\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"in\": [\r\n                            \"18.04-LTS\"\r\n                          ]\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"OpenLogic\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"Centos\",\r\n                        \"Centos-LVM\",\r\n                        \"CentOS-SRIOV\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"6.*\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                },\r\n                {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"equals\": \"cloudera\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"equals\": \"cloudera-centos-os\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSKU\",\r\n                      \"like\": \"7*\"\r\n                    }\r\n                  ]\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"auditIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n            \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e2dd799a-a932-4e9d-ac17-d473bc3c6c10\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e3576e28-8b17-4677-84c3-db2990658d64?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMzU3NmUyOC04YjE3LTQ2NzctODRjMy1kYjI5OTA2NThkNjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ce279120-4bf2-4bb3-9a60-061daab928f2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "c4adbc44-b7cd-4c40-b48b-e6ff537dfde8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:c4adbc44-b7cd-4c40-b48b-e6ff537dfde8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:28 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e3576e28-8b17-4677-84c3-db2990658d64' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e3576e28-8b17-4677-84c3-db2990658d64?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lMzU3NmUyOC04YjE3LTQ2NzctODRjMy1kYjI5OTA2NThkNjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:35d0da89-42d5-439d-8c23-792d324ff3f7"
        ],
        "x-ms-correlation-request-id": [
          "c6c2658d-67be-49aa-8d5f-3d8616024eb7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:c6c2658d-67be-49aa-8d5f-3d8616024eb7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "1120"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"MFA should be enabled on accounts with read permissions on your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with read privileges to prevent a breach of accounts or resources.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"EnableMFAForReadPermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e3576e28-8b17-4677-84c3-db2990658d64\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNTY5NjJhNi00NzQ3LTQ5Y2QtYjY3Yi1iZjhiMDE5NzVjNGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:a5d26562-9073-4526-bf20-7dc07020b4e5"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11988"
        ],
        "x-ms-correlation-request-id": [
          "1395d6c3-2bf8-4df8-b613-32843a5d231e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:1395d6c3-2bf8-4df8-b613-32843a5d231e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e56962a6-4747-49cd-b67b-bf8b01975c4c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNTY5NjJhNi00NzQ3LTQ5Y2QtYjY3Yi1iZjhiMDE5NzVjNGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:5effada5-5055-4140-8a06-ce492a9cd625"
        ],
        "x-ms-correlation-request-id": [
          "419cff29-58b7-4212-bf0e-98e90fdcd69a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:419cff29-58b7-4212-bf0e-98e90fdcd69a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "1066"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allowed locations\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfAllowedLocations\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n          \"strongType\": \"location\",\r\n          \"displayName\": \"Allowed locations\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"location\",\r\n            \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n          },\r\n          {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"global\"\r\n          },\r\n          {\r\n            \"field\": \"type\",\r\n            \"notEquals\": \"Microsoft.AzureActiveDirectory/b2cDirectories\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e56962a6-4747-49cd-b67b-bf8b01975c4c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNjc2ODdlOC0wOGQ1LTRlN2YtODIyNi01YjQ3NTNiYmEwMDg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1d0b4c3f-17ec-492d-9fda-53e3bc915b6e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "2f8d0935-b969-4ef6-8cc6-e763027a107d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205329Z:2f8d0935-b969-4ef6-8cc6-e763027a107d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e67687e8-08d5-4e7f-8226-5b4753bba008' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNjc2ODdlOC0wOGQ1LTRlN2YtODIyNi01YjQ3NTNiYmEwMDg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "9bd0bbb7-ae91-45d7-a3d3-dabf5a761cd8"
        ],
        "x-ms-request-id": [
          "westus:a73c2f3c-ed9e-4597-b5a4-31b173e78714"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:9bd0bbb7-ae91-45d7-a3d3-dabf5a761cd8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "1256"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Node.js Framework\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Use the latest supported Node.js version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"UseLatestNodeJS\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e67687e8-08d5-4e7f-8226-5b4753bba008\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e71308d3-144b-4262-b144-efdc3cc90517?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzEzMDhkMy0xNDRiLTQyNjItYjE0NC1lZmRjM2NjOTA1MTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:fcce7e2a-b07c-4a35-a62b-e1b3a1cbb495"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11987"
        ],
        "x-ms-correlation-request-id": [
          "2c4f26e9-dcd3-48f9-b088-185d16bfc67f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:2c4f26e9-dcd3-48f9-b088-185d16bfc67f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e71308d3-144b-4262-b144-efdc3cc90517' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e71308d3-144b-4262-b144-efdc3cc90517?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzEzMDhkMy0xNDRiLTQyNjItYjE0NC1lZmRjM2NjOTA1MTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:fa182190-2df0-4287-b2d0-493cf10c913e"
        ],
        "x-ms-correlation-request-id": [
          "e2739548-7fdf-4557-a5aa-f0819b6a78b2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:e2739548-7fdf-4557-a5aa-f0819b6a78b2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "1182"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Subnets should be associated with a Network Security Group\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Protect your subnet from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your subnet.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"networkSecurityGroupsOnSubnets\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e71308d3-144b-4262-b144-efdc3cc90517\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzU2Yjk0NS0xYjFiLTQ4MGItOGRlOC05YTA4NTlkNWY3YWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:96ec9b44-1ef0-49cb-9d13-482ddf62c109"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "e307cd2a-db59-4717-90de-82a7d2baa944"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:e307cd2a-db59-4717-90de-82a7d2baa944"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:29 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e756b945-1b1b-480b-8de8-9a0859d5f7ad' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzU2Yjk0NS0xYjFiLTQ4MGItOGRlOC05YTA4NTlkNWY3YWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:c0c6d515-92bf-4742-90d5-8f1eff2547de"
        ],
        "x-ms-correlation-request-id": [
          "1f2d1476-d8ef-4c83-98bb-f6018d04c443"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:1f2d1476-d8ef-4c83-98bb-f6018d04c443"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "1137"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL server Advanced Data Security settings\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/servers/securityAlertPolicies/disabledAlerts[*]\",\r\n            \"equals\": \"\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e756b945-1b1b-480b-8de8-9a0859d5f7ad\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzY1YjVkZS0xMjI1LTRiYTMtYmQ1Ni0xYWM2Njk1YWY5ODg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:327b6b75-da88-4224-b97d-6892acd39208"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "a0535a99-2399-4fb7-828f-7e977f8d8ab1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:a0535a99-2399-4fb7-828f-7e977f8d8ab1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e765b5de-1225-4ba3-bd56-1ac6695af988' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzY1YjVkZS0xMjI1LTRiYTMtYmQ1Ni0xYWM2Njk1YWY5ODg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:1b6ecca0-49b1-46b4-afca-b80de71c33cc"
        ],
        "x-ms-correlation-request-id": [
          "fe1d744d-a306-48d0-9100-c277866728f8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:fe1d744d-a306-48d0-9100-c277866728f8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "908"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Allowed locations for resource groups\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n    \"metadata\": {\r\n      \"category\": \"General\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfAllowedLocations\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"description\": \"The list of locations that resource groups can be created in.\",\r\n          \"strongType\": \"location\",\r\n          \"displayName\": \"Allowed locations\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"location\",\r\n            \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n          },\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e765b5de-1225-4ba3-bd56-1ac6695af988\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzk3Zjg1MS04YmU3LTRjNDAtYmI1Ni0yZTMzOTUyMTViMGU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6ab4d039-0f15-4edb-b72b-175f1e5a575a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "39620e7b-39ae-4dbc-8d41-8b379f83613e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205330Z:39620e7b-39ae-4dbc-8d41-8b379f83613e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e797f851-8be7-4c40-bb56-2e3395215b0e' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lNzk3Zjg1MS04YmU3LTRjNDAtYmI1Ni0yZTMzOTUyMTViMGU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:f9a8cc7c-10ae-468d-a33c-036b58ec9539"
        ],
        "x-ms-correlation-request-id": [
          "9e39174b-97ea-413a-a4f1-1bb873ae06d9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:9e39174b-97ea-413a-a4f1-1bb873ae06d9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "1303"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Deprecated]: Audit Web Sockets state for a Web Application\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within a web application must be carefully reviewed.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true,\r\n      \"deprecated\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"WebApp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"app,linux,container\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"DisableWebSockets\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e797f851-8be7-4c40-bb56-2e3395215b0e\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lOWM4ZDA4NS1kOWNjLTRiMTctOWNkYy0wNTlmMWYwMWYxOWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:22ac0b5f-2f91-4154-903c-5bd99ee8299a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "1b9e6e9c-54b8-4f73-a111-92a0397c6b44"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:1b9e6e9c-54b8-4f73-a111-92a0397c6b44"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'e9c8d085-d9cc-4b17-9cdc-059f1f01f19e' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lOWM4ZDA4NS1kOWNjLTRiMTctOWNkYy0wNTlmMWYwMWYxOWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:2f61359e-4748-4386-8fa2-86301a8d8a07"
        ],
        "x-ms-correlation-request-id": [
          "8ae69ad2-005a-4257-8613-5179a61e4d47"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:8ae69ad2-005a-4257-8613-5179a61e4d47"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "1126"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Remote debugging should be turned off for API App\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Remote debugging requires inbound ports to be opened on an API app.  Remote debugging should be turned off.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.Web/sites\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"equals\": \"apiApp\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoteDebuggingForApiApp\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lYmI2MmEwYy0zNTYwLTQ5ZTEtODllZC0yN2UwNzRlOWY4YWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8937cddf-b98d-4677-8d3a-bf4e4d98b97e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "cd9f81e7-bdd1-49a4-a9fa-0ad465258279"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:cd9f81e7-bdd1-49a4-a9fa-0ad465258279"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'ebb62a0c-3560-49e1-89ed-27e074e9f8ad' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lYmI2MmEwYy0zNTYwLTQ5ZTEtODllZC0yN2UwNzRlOWY4YWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:9fc6b9b6-caab-4e3e-aba4-f72dc0396266"
        ],
        "x-ms-correlation-request-id": [
          "a644fa16-0ae1-40ac-ad42-097262c1d8c3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:a644fa16-0ae1-40ac-ad42-097262c1d8c3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "1154"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deprecated accounts with owner permissions should be removed from your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Deprecated accounts with owner permissions should be removed from your subscription.  Deprecated accounts are accounts that have been blocked from signing in.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoveDeprecatedAccountsWithOwnerPermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"ebb62a0c-3560-49e1-89ed-27e074e9f8ad\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/ec49586f-4939-402d-a29e-6ff502b20592?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lYzQ5NTg2Zi00OTM5LTQwMmQtYTI5ZS02ZmY1MDJiMjA1OTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:cb7dac7d-e476-43b5-a513-045db079aaa0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "1ac03658-b44a-4a3c-8a7b-21df2c522bc3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:1ac03658-b44a-4a3c-8a7b-21df2c522bc3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:30 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'ec49586f-4939-402d-a29e-6ff502b20592' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/ec49586f-4939-402d-a29e-6ff502b20592?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lYzQ5NTg2Zi00OTM5LTQwMmQtYTI5ZS02ZmY1MDJiMjA1OTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:6776013b-3508-456a-907b-8c927284436c"
        ],
        "x-ms-correlation-request-id": [
          "ef30ebb1-8cd3-4c8d-a82d-e62244877d45"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205331Z:ef30ebb1-8cd3-4c8d-a82d-e62244877d45"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "4721"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Linux VMs that allow remote connections from accounts without passwords\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that allow remote connections from accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"microsoft-aks\",\r\n                  \"AzureDatabricks\",\r\n                  \"qubole-inc\",\r\n                  \"datastax\",\r\n                  \"couchbase\",\r\n                  \"scalegrid\",\r\n                  \"checkpoint\",\r\n                  \"paloaltonetworks\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"CentOS*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"RHEL\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"osa\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"credativ\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Debian\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"7*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Suse\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"SLES*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"11*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"12*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"linux-data-science-vm-ubuntu\",\r\n                      \"azureml\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-altus-centos-os\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"PasswordPolicy_msid110\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"PasswordPolicy_msid110\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforLinux\",\r\n                      \"typeHandlerVersion\": \"1.0\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"ec49586f-4939-402d-a29e-6ff502b20592\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lZDdjOGMxMy01MWU3LTQ5ZDEtOGE0My04NDkwNDMxYTBkYTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:0d186e58-ebc1-4394-85cc-84c8a2fd2842"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "f4f53dcb-eb9d-4610-8061-2c0738130b57"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:f4f53dcb-eb9d-4610-8061-2c0738130b57"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'ed7c8c13-51e7-49d1-8a43-8490431a0da2' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lZDdjOGMxMy01MWU3LTQ5ZDEtOGE0My04NDkwNDMxYTBkYTI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:201372f7-8673-44ad-b8f0-f08adfe13ddb"
        ],
        "x-ms-correlation-request-id": [
          "3afd32de-16a5-47c2-a253-39a0ce57cebc"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:3afd32de-16a5-47c2-a253-39a0ce57cebc"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "3571"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Diagnostic Settings for Key Vault to Event Hub\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Deploys the diagnostic settings for Key Vault to stream to a regional Event Hub when any Key Vault which is missing this diagnostic settings is created or updated.\",\r\n    \"metadata\": {\r\n      \"category\": \"Key Vault\"\r\n    },\r\n    \"parameters\": {\r\n      \"profileName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Profile name\",\r\n          \"description\": \"The diagnostic settings profile name\"\r\n        },\r\n        \"defaultValue\": \"setbypolicy\"\r\n      },\r\n      \"eventHubRuleId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Event Hub Authorization Rule Id\",\r\n          \"description\": \"The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\",\r\n          \"strongType\": \"Microsoft.EventHub/Namespaces/AuthorizationRules\",\r\n          \"assignPermissions\": true\r\n        }\r\n      },\r\n      \"metricsEnabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Enable metrics\",\r\n          \"description\": \"Whether to enable metrics stream to the Event Hub - True or False\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"True\",\r\n          \"False\"\r\n        ],\r\n        \"defaultValue\": \"False\"\r\n      },\r\n      \"logsEnabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Enable logs\",\r\n          \"description\": \"Whether to enable logs stream to the Event Hub  - True or False\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"True\",\r\n          \"False\"\r\n        ],\r\n        \"defaultValue\": \"True\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.KeyVault/vaults\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"name\": \"[parameters('profileName')]\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                \"equals\": \"[parameters('logsEnabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                \"equals\": \"[parameters('metricsEnabled')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vaultName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"eventHubRuleId\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"metricsEnabled\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"logsEnabled\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"profileName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.KeyVault/vaults/providers/diagnosticSettings\",\r\n                    \"apiVersion\": \"2017-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vaultName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"dependsOn\": [],\r\n                    \"properties\": {\r\n                      \"eventHubAuthorizationRuleId\": \"[parameters('eventHubRuleId')]\",\r\n                      \"metrics\": [\r\n                        {\r\n                          \"category\": \"AllMetrics\",\r\n                          \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                          \"retentionPolicy\": {\r\n                            \"enabled\": false,\r\n                            \"days\": 0\r\n                          }\r\n                        }\r\n                      ],\r\n                      \"logs\": [\r\n                        {\r\n                          \"category\": \"AuditEvent\",\r\n                          \"enabled\": \"[parameters('logsEnabled')]\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  }\r\n                ],\r\n                \"outputs\": {\r\n                  \"policy\": {\r\n                    \"type\": \"string\",\r\n                    \"value\": \"[concat('Enabled diagnostic settings for ', parameters('vaultName'))]\"\r\n                  }\r\n                }\r\n              },\r\n              \"parameters\": {\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"vaultName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"eventHubRuleId\": {\r\n                  \"value\": \"[parameters('eventHubRuleId')]\"\r\n                },\r\n                \"metricsEnabled\": {\r\n                  \"value\": \"[parameters('metricsEnabled')]\"\r\n                },\r\n                \"logsEnabled\": {\r\n                  \"value\": \"[parameters('logsEnabled')]\"\r\n                },\r\n                \"profileName\": {\r\n                  \"value\": \"[parameters('profileName')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"ed7c8c13-51e7-49d1-8a43-8490431a0da2\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lZjJhOGYyYS1iM2Q5LTQ5Y2QtYThhOC05YTNhYWFmNjQ3ZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:077bb5d0-7325-48b9-9789-398f9a334dfa"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "215d6ad0-c263-44c3-8f94-4ce29f14386b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:215d6ad0-c263-44c3-8f94-4ce29f14386b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:31 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9lZjJhOGYyYS1iM2Q5LTQ5Y2QtYThhOC05YTNhYWFmNjQ3ZDk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:03e09124-348e-4045-850b-36a0fff260bc"
        ],
        "x-ms-correlation-request-id": [
          "344593d1-282c-43da-a25b-5ea2697643d9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:344593d1-282c-43da-a25b-5ea2697643d9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "1113"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Vulnerability assessment should be enabled on your SQL servers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit Azure SQL servers which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/vulnerabilityAssessments\",\r\n          \"name\": \"default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/servers/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n            \"equals\": \"True\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f0633351-c7b2-41ff-9981-508fc08553c2?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mMDYzMzM1MS1jN2IyLTQxZmYtOTk4MS01MDhmYzA4NTUzYzI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7e02d8b9-3c06-45bf-a964-94ca7f6dc093"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "fb548ba1-a87e-4656-8d76-bf87217c1a43"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:fb548ba1-a87e-4656-8d76-bf87217c1a43"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f0633351-c7b2-41ff-9981-508fc08553c2' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f0633351-c7b2-41ff-9981-508fc08553c2?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mMDYzMzM1MS1jN2IyLTQxZmYtOTk4MS01MDhmYzA4NTUzYzI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:35db72d8-b16b-476a-918a-45380c3b726a"
        ],
        "x-ms-correlation-request-id": [
          "27a5b927-3234-4c31-aaaf-1713d5911969"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:27a5b927-3234-4c31-aaaf-1713d5911969"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "5150"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy requirements to audit Windows VMs that have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"ApplicationName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names (supports wildcards)\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"NotInstalledApplication\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[InstalledApplication]NotInstalledApplicationResource1;Name', '=', parameters('ApplicationName')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"NotInstalledApplication\"\r\n                },\r\n                \"ApplicationName\": {\r\n                  \"value\": \"[parameters('ApplicationName')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ApplicationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[InstalledApplication]NotInstalledApplicationResource1;Name\",\r\n                            \"value\": \"[parameters('ApplicationName')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f0633351-c7b2-41ff-9981-508fc08553c2\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mMTlhYTFjMS02YjkxLTRjMjctYWU2YS05NzAyNzlmMDNkYjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:81a34ea5-1571-4158-941e-0c159dde7c58"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "deefb712-7725-4892-b2d7-393dccd3de55"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205332Z:deefb712-7725-4892-b2d7-393dccd3de55"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f19aa1c1-6b91-4c27-ae6a-970279f03db9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mMTlhYTFjMS02YjkxLTRjMjctYWU2YS05NzAyNzlmMDNkYjk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:1524f53a-f984-4479-9d79-ecfbf605af11"
        ],
        "x-ms-correlation-request-id": [
          "738a2f81-08b8-4ebb-b4cc-085f4b695c2a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:738a2f81-08b8-4ebb-b4cc-085f4b695c2a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "4711"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Linux VMs that do not have the passwd file permissions set to 0644\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the passwd file permissions set to 0644. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"microsoft-aks\",\r\n                  \"AzureDatabricks\",\r\n                  \"qubole-inc\",\r\n                  \"datastax\",\r\n                  \"couchbase\",\r\n                  \"scalegrid\",\r\n                  \"checkpoint\",\r\n                  \"paloaltonetworks\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"OpenLogic\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"CentOS*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"RHEL\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"RedHat\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"osa\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"credativ\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"Debian\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"7*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Suse\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"SLES*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"11*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"Canonical\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"UbuntuServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"12*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"linux-data-science-vm-ubuntu\",\r\n                      \"azureml\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-centos-os\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"6*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloudera\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"cloudera-altus-centos-os\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"PasswordPolicy_msid121\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"PasswordPolicy_msid121\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforLinux\",\r\n                      \"typeHandlerVersion\": \"1.0\",\r\n                      \"autoUpgradeMinorVersion\": true\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f19aa1c1-6b91-4c27-ae6a-970279f03db9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mM2I0NGU1ZC0xNDU2LTQ3NWYtOWM2Ny1jNjZjNDYxOGU4NWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d9ce5362-e5a4-414d-b539-39227167e97d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "20624407-4e0b-4131-b393-13550696cdc5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:20624407-4e0b-4131-b393-13550696cdc5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f3b44e5d-1456-475f-9c67-c66c4618e85a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mM2I0NGU1ZC0xNDU2LTQ3NWYtOWM2Ny1jNjZjNDYxOGU4NWE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:52256d3c-4711-4612-8fcb-d40738ee47be"
        ],
        "x-ms-correlation-request-id": [
          "eb97cc48-5b2e-4b9a-b0ec-f644729e89ab"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:eb97cc48-5b2e-4b9a-b0ec-f644729e89ab"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "1049"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain all of the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines in which the Administrators group does not contain all of the specified members. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"AdministratorsGroupMembersToInclude\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f3b44e5d-1456-475f-9c67-c66c4618e85a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mM2I5YWQ4My0wMDBkLTRkYzEtYmZmMC02ZDU0NTMzZGQwM2Y/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:183ea48a-0647-4d46-853b-62205618f0d9"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "f6f3df6c-0070-4421-9676-95e27d51c905"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:f6f3df6c-0070-4421-9676-95e27d51c905"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f3b9ad83-000d-4dc1-bff0-6d54533dd03f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mM2I5YWQ4My0wMDBkLTRkYzEtYmZmMC02ZDU0NTMzZGQwM2Y/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:45076048-ac44-4953-a1f4-c8152642ed07"
        ],
        "x-ms-correlation-request-id": [
          "83562b5b-7202-4fdd-b05b-b030449977b9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:83562b5b-7202-4fdd-b05b-b030449977b9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:32 GMT"
        ],
        "Content-Length": [
          "1085"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"WindowsCertificateInTrustedRoot\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f3b9ad83-000d-4dc1-bff0-6d54533dd03f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNDdiNTU4Mi0zM2VjLTRjNWMtODdjMC1iMDEwYTZiMmU5MTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:7ca4cbc6-f1b3-445e-927b-10ad48bb8975"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "92043876-fe98-4220-9ea0-0bfe58e09236"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:92043876-fe98-4220-9ea0-0bfe58e09236"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f47b5582-33ec-4c5c-87c0-b010a6b2e917' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNDdiNTU4Mi0zM2VjLTRjNWMtODdjMC1iMDEwYTZiMmU5MTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11993"
        ],
        "x-ms-request-id": [
          "westus:d9d8e6dd-6802-458e-bc29-ddc7544cb317"
        ],
        "x-ms-correlation-request-id": [
          "bbe9f7c1-d4c0-4f33-b804-059347065388"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205333Z:bbe9f7c1-d4c0-4f33-b804-059347065388"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "1136"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Log Analytics Workspace for VM - Report Mismatch\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Reports VMs as non-compliant if they not logging to the LA workspace specified in the policy/initiative assignment.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalyticsWorkspaceId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics Workspace Id that VMs should be configured for\",\r\n          \"description\": \"This is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured for.\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n            \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.Compute/virtualMachines/extensions/settings.workspaceId\",\r\n            \"notEquals\": \"[parameters('logAnalyticsWorkspaceId')]\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f47b5582-33ec-4c5c-87c0-b010a6b2e917\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNDgyNmU1Zi02YTI3LTQwN2MtYWUzZS05NTgyZWIzOTg5MWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:746971d6-72cf-4004-a9ff-d056766fd77b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "bad3940d-175b-4106-96b6-37c72f73913c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:bad3940d-175b-4106-96b6-37c72f73913c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f4826e5f-6a27-407c-ae3e-9582eb39891d' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNDgyNmU1Zi02YTI3LTQwN2MtYWUzZS05NTgyZWIzOTg5MWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:16464d5a-3614-4ec4-ab20-4654148ff31d"
        ],
        "x-ms-correlation-request-id": [
          "a5e3ca3d-bfe5-4a79-bb92-57b4033207be"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:a5e3ca3d-bfe5-4a79-bb92-57b4033207be"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "905"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Authorization rules on the Event Hub instance should be defined\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Audit existence of authorization rules on Event Hub entities to grant least-privileged access\",\r\n    \"metadata\": {\r\n      \"category\": \"Event Hub\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.EventHub/namespaces/eventhubs\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.EventHub/namespaces/eventHubs/authorizationRules\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f4826e5f-6a27-407c-ae3e-9582eb39891d\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNDhiMjkxMy0xZGM1LTQ4MzQtOGM3Mi1jY2MxZGZkODE5YmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ad6564b4-751b-4e9a-870c-166e8c40d5d4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "0d301cf4-52a6-4d28-8277-9d2f0b2d5b9b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:0d301cf4-52a6-4d28-8277-9d2f0b2d5b9b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f48b2913-1dc5-4834-8c72-ccc1dfd819bb' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNDhiMjkxMy0xZGM1LTQ4MzQtOGM3Mi1jY2MxZGZkODE5YmI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:12cecf79-7580-4e7c-829f-2df7fa6730ba"
        ],
        "x-ms-correlation-request-id": [
          "425d4828-b25e-4616-8145-2619727de90d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:425d4828-b25e-4616-8145-2619727de90d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "1017"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not have the password complexity setting enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Windows virtual machines that do not have the password complexity setting enabled. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"PasswordMustMeetComplexityRequirements\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f48b2913-1dc5-4834-8c72-ccc1dfd819bb\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNGIyNDVkNC00NmM5LTQyYmUtOWIxYS00OWUyYjViOTQxOTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:d75a490d-9776-4b74-8ccb-048362d8f834"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "694be24d-1ea4-4ec8-9c83-79464e0b2c2d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:694be24d-1ea4-4ec8-9c83-79464e0b2c2d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f4b245d4-46c9-42be-9b1a-49e2b5b94194' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNGIyNDVkNC00NmM5LTQyYmUtOWIxYS00OWUyYjViOTQxOTQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:c3727822-ebe5-4ead-8bcc-88936365035b"
        ],
        "x-ms-correlation-request-id": [
          "13335cff-55ed-4b0c-b5cb-868af4409c09"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:13335cff-55ed-4b0c-b5cb-868af4409c09"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "4959"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Deploy requirements to audit Windows VMs that have not restarted within the specified number of days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that have not restarted within the specified number of days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\",\r\n      \"requiredProviders\": [\r\n        \"Microsoft.GuestConfiguration\"\r\n      ]\r\n    },\r\n    \"parameters\": {\r\n      \"NumberOfDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Number of days\",\r\n          \"description\": \"The number of days without restart until the machine is considered non-compliant\"\r\n        },\r\n        \"defaultValue\": \"12\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"in\": [\r\n                  \"esri\",\r\n                  \"incredibuild\",\r\n                  \"MicrosoftDynamicsAX\",\r\n                  \"MicrosoftSharepoint\",\r\n                  \"MicrosoftVisualStudio\",\r\n                  \"MicrosoftWindowsDesktop\",\r\n                  \"MicrosoftWindowsServerHPCPack\"\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftWindowsServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notLike\": \"2008*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"MicrosoftSQLServer\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                    \"notEquals\": \"SQL2008R2SP3-WS2008R2SP1\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-dsvm\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"dsvm-windows\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"microsoft-ads\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"in\": [\r\n                      \"standard-data-science-vm\",\r\n                      \"windows-data-science-vm\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"batch\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"equals\": \"rendering-windows2016\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"center-for-internet-security-inc\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"cis-windows-server-201*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"pivotal\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"bosh-windows-server*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"equals\": \"cloud-infrastructure-services\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                    \"like\": \"ad*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n          \"name\": \"MachineLastBootUpTime\",\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n            \"equals\": \"[base64(concat('[MachineUpTime]MachineLastBootUpTime;NumberOfDays', '=', parameters('NumberOfDays')))]\"\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"parameters\": {\r\n                \"vmName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                },\r\n                \"configurationName\": {\r\n                  \"value\": \"MachineLastBootUpTime\"\r\n                },\r\n                \"NumberOfDays\": {\r\n                  \"value\": \"[parameters('NumberOfDays')]\"\r\n                }\r\n              },\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"vmName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"configurationName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"NumberOfDays\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2018-11-20\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"guestConfiguration\": {\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"version\": \"1.*\",\r\n                        \"configurationParameter\": [\r\n                          {\r\n                            \"name\": \"[MachineUpTime]MachineLastBootUpTime;NumberOfDays\",\r\n                            \"value\": \"[parameters('NumberOfDays')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2017-03-30\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                    \"identity\": {\r\n                      \"type\": \"SystemAssigned\"\r\n                    },\r\n                    \"name\": \"[parameters('vmName')]\",\r\n                    \"location\": \"[parameters('location')]\"\r\n                  },\r\n                  {\r\n                    \"apiVersion\": \"2015-05-01-preview\",\r\n                    \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                    \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                    \"location\": \"[parameters('location')]\",\r\n                    \"properties\": {\r\n                      \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                      \"type\": \"ConfigurationforWindows\",\r\n                      \"typeHandlerVersion\": \"1.1\",\r\n                      \"autoUpgradeMinorVersion\": true,\r\n                      \"settings\": {},\r\n                      \"protectedSettings\": {}\r\n                    },\r\n                    \"dependsOn\": [\r\n                      \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f4b245d4-46c9-42be-9b1a-49e2b5b94194\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNGM2ODQ4NC0xMzJmLTQxZjktOWI2ZC0zZTRiMWNiNTUwMzY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e29161c8-d427-4c0a-acda-a3795f866652"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "bfb74b36-d914-4544-a8be-3b96a9d50f6c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:bfb74b36-d914-4544-a8be-3b96a9d50f6c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:33 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f4c68484-132f-41f9-9b6d-3e4b1cb55036' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNGM2ODQ4NC0xMzJmLTQxZjktOWI2ZC0zZTRiMWNiNTUwMzY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:64d9eb43-b3e9-455e-80b0-964ae81276de"
        ],
        "x-ms-correlation-request-id": [
          "bdd2d6df-190d-438e-838a-756ada96f2c5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205334Z:bdd2d6df-190d-438e-838a-756ada96f2c5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "4046"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Deploy Auditing on SQL servers\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"This policy ensures that Auditing is enabled on SQL Servers for enhanced security and compliance. It will automatically create a storage account in the same region as the SQL server to store audit records.\",\r\n    \"metadata\": {\r\n      \"category\": \"SQL\"\r\n    },\r\n    \"parameters\": {\r\n      \"retentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"description\": \"The value in days of the retention period (0 indicates unlimited retention)\",\r\n          \"displayName\": \"Retention days (optional, 180 days if unspecified)\"\r\n        },\r\n        \"defaultValue\": \"180\"\r\n      },\r\n      \"storageAccountsResourceGroup\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource group name for storage accounts\",\r\n          \"description\": \"Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.\",\r\n          \"strongType\": \"existingResourceGroups\"\r\n        }\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Sql/servers\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"DeployIfNotExists\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n          \"name\": \"Default\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n            \"equals\": \"Enabled\"\r\n          },\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\",\r\n            \"/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n          ],\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"serverName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"auditRetentionDays\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"storageAccountsResourceGroup\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"location\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"retentionDays\": \"[int(parameters('auditRetentionDays'))]\",\r\n                  \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                  \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), parameters('location'), parameters('storageAccountsResourceGroup'))]\",\r\n                  \"locationCode\": \"[substring(parameters('location'), 0, 3)]\",\r\n                  \"storageName\": \"[tolower(concat('sqlaudit', variables('locationCode'), variables('uniqueStorage')))]\",\r\n                  \"createStorageAccountDeploymentName\": \"[concat('sqlServerAuditingStorageAccount-', uniqueString(variables('locationCode'), parameters('serverName')))]\"\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"apiVersion\": \"2017-05-10\",\r\n                    \"name\": \"[variables('createStorageAccountDeploymentName')]\",\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"resourceGroup\": \"[parameters('storageAccountsResourceGroup')]\",\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"parameters\": {\r\n                        \"location\": {\r\n                          \"value\": \"[parameters('location')]\"\r\n                        },\r\n                        \"storageName\": {\r\n                          \"value\": \"[variables('storageName')]\"\r\n                        }\r\n                      },\r\n                      \"templateLink\": {\r\n                        \"uri\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json\",\r\n                        \"contentVersion\": \"1.0.0.0\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                    \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n                    \"apiVersion\": \"2017-03-01-preview\",\r\n                    \"properties\": {\r\n                      \"state\": \"Enabled\",\r\n                      \"storageEndpoint\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountEndPoint.value]\",\r\n                      \"storageAccountAccessKey\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountKey.value]\",\r\n                      \"retentionDays\": \"[variables('retentionDays')]\",\r\n                      \"auditActionsAndGroups\": null,\r\n                      \"storageAccountSubscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"isStorageSecondaryKeyInUse\": false\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"serverName\": {\r\n                  \"value\": \"[field('name')]\"\r\n                },\r\n                \"auditRetentionDays\": {\r\n                  \"value\": \"[parameters('retentionDays')]\"\r\n                },\r\n                \"storageAccountsResourceGroup\": {\r\n                  \"value\": \"[parameters('storageAccountsResourceGroup')]\"\r\n                },\r\n                \"location\": {\r\n                  \"value\": \"[field('location')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f4c68484-132f-41f9-9b6d-3e4b1cb55036\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNmRlMGJlNy05YThhLTRiOGEtYjM0OS00M2NmMDJkMjJmN2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:b79f3257-9c55-4581-bfb0-07c313dbe939"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "851e0aa9-37d3-4cd2-8295-a21382a9417c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:851e0aa9-37d3-4cd2-8295-a21382a9417c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f6de0be7-9a8a-4b8a-b349-43cf02d22f7c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mNmRlMGJlNy05YThhLTRiOGEtYjM0OS00M2NmMDJkMjJmN2M/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:dd8a5157-e904-4a9a-b3b0-574704b051f4"
        ],
        "x-ms-correlation-request-id": [
          "e5d99a3f-ded1-4401-9bcb-9b2691fd0212"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:e5d99a3f-ded1-4401-9bcb-9b2691fd0212"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "1284"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Virtual machines should be associated with a Network Security Group\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"Protect your VM from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your VM from other instances, in or outside the same subnet.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.ClassicCompute/virtualMachines\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"networkSecurityGroupsOnVirtualMachines\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"Monitored\",\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mODQ1NmMxYy1hYTY2LTRkZmItODYxYS0yNWQxMjdiNzc1Yzk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8ac04042-d889-40dc-8007-7f1c1555b7fa"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "28fba2c7-0921-4725-9876-6a88ac557db7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:28fba2c7-0921-4725-9876-6a88ac557db7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f8456c1c-aa66-4dfb-861a-25d127b775c9' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mODQ1NmMxYy1hYTY2LTRkZmItODYxYS0yNWQxMjdiNzc1Yzk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:fa1cebff-88b2-451f-89ce-47333d52fd7e"
        ],
        "x-ms-correlation-request-id": [
          "dd6d144b-3085-4f29-a142-0ea5a84877db"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:dd6d144b-3085-4f29-a142-0ea5a84877db"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "1113"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"External accounts with owner permissions should be removed from your subscription\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"External accounts with owner permissions should be removed from your subscription in order to prevent unmonitored access.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.Resources/subscriptions\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"RemoveExternalAccountsWithOwnerPermissions\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f8456c1c-aa66-4dfb-861a-25d127b775c9\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mOGQzNmUyZi0zODliLTRlZTQtODk4ZC0yMWFlYjY5YTBmNDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:5713987d-1a9a-4031-a66a-c37f33d5065d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "88238671-e618-4810-9035-d8f678ff2b2d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:88238671-e618-4810-9035-d8f678ff2b2d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f8d36e2f-389b-4ee4-898d-21aeb69a0f45' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mOGQzNmUyZi0zODliLTRlZTQtODk4ZC0yMWFlYjY5YTBmNDU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:b2fe9118-4d51-49b5-81e3-cf41180d2c49"
        ],
        "x-ms-correlation-request-id": [
          "bdf6606b-d96c-402d-8595-70259de9b1ba"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:bdf6606b-d96c-402d-8595-70259de9b1ba"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "1684"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Service Bus should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Service Bus\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f8d36e2f-389b-4ee4-898d-21aeb69a0f45\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mOWJlNTM2OC05YmY1LTRiODQtOWUwYS03ODUwZGE5OGJiNDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:56967529-4f78-4499-a28d-733989e3b12c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "1807737b-272a-4c50-add0-93f44563b7ce"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:1807737b-272a-4c50-add0-93f44563b7ce"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:34 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'f9be5368-9bf5-4b84-9e0a-7850da98bb46' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mOWJlNTM2OC05YmY1LTRiODQtOWUwYS03ODUwZGE5OGJiNDY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:9481b6f7-f8a7-4030-af99-0bb2c51a86be"
        ],
        "x-ms-correlation-request-id": [
          "13b61598-845a-4cc2-88a9-4bce075ca304"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205335Z:13b61598-845a-4cc2-88a9-4bce075ca304"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "1708"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Diagnostic logs in Azure Stream Analytics should be enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n    \"metadata\": {\r\n      \"category\": \"Stream Analytics\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"requiredRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (days)\",\r\n          \"description\": \"The required diagnostic logs retention in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.StreamAnalytics/streamingJobs\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n          \"existenceCondition\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                    \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                      \"equals\": \"true\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"f9be5368-9bf5-4b84-9e0a-7850da98bb46\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/fb893a29-21bb-418c-a157-e99480ec364c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mYjg5M2EyOS0yMWJiLTQxOGMtYTE1Ny1lOTk0ODBlYzM2NGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:37050589-e8a0-49f0-a87f-c48657dd6433"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "5cd59a40-0613-44f2-a1b4-5887327eaaef"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205336Z:5cd59a40-0613-44f2-a1b4-5887327eaaef"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'fb893a29-21bb-418c-a157-e99480ec364c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/fb893a29-21bb-418c-a157-e99480ec364c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mYjg5M2EyOS0yMWJiLTQxOGMtYTE1Ny1lOTk0ODBlYzM2NGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:ae519131-09fb-44a7-999a-892e8d6b6361"
        ],
        "x-ms-correlation-request-id": [
          "13135ce4-e2f5-4e93-b2bf-60742d9c6808"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205336Z:13135ce4-e2f5-4e93-b2bf-60742d9c6808"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "2438"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Kubernetes Services should be upgraded to a non-vulnerable Kubernetes version\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Upgrade your Kubernetes service cluster to a later Kubernetes version to protect against known vulnerabilities in your current Kubernetes version. Vulnerability CVE-2019-9946 has been patched in Kubernetes versions 1.11.9+, 1.12.7+, 1.13.5+, and 1.14.0+\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\",\r\n      \"preview\": true\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          {\r\n            \"anyOf\": [\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"in\": [\r\n                  \"1.13.4\",\r\n                  \"1.13.3\",\r\n                  \"1.13.2\",\r\n                  \"1.13.1\",\r\n                  \"1.13.0\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"in\": [\r\n                  \"1.12.6\",\r\n                  \"1.12.5\",\r\n                  \"1.12.4\",\r\n                  \"1.12.3\",\r\n                  \"1.12.2\",\r\n                  \"1.12.1\",\r\n                  \"1.12.0\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"in\": [\r\n                  \"1.11.8\",\r\n                  \"1.11.7\",\r\n                  \"1.11.6\",\r\n                  \"1.11.5\",\r\n                  \"1.11.4\",\r\n                  \"1.11.3\",\r\n                  \"1.11.2\",\r\n                  \"1.11.1\",\r\n                  \"1.11.0\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.10.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.9.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.8.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.7.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.6.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.5.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.4.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.3.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.2.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.1.*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/kubernetesVersion\",\r\n                \"like\": \"1.0.*\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/fb893a29-21bb-418c-a157-e99480ec364c\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"fb893a29-21bb-418c-a157-e99480ec364c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mZWU1Y2IyYi05ZDliLTQxMGUtYWZlMy0yOTAyZDkwZDAwMDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f25e910c-cc2f-4f1d-b1e9-50fad77090e8"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "0defb785-22dc-42e3-ad96-43364663b3d3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205336Z:0defb785-22dc-42e3-ad96-43364663b3d3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'fee5cb2b-9d9b-410e-afe3-2902d90d0004' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mZWU1Y2IyYi05ZDliLTQxMGUtYWZlMy0yOTAyZDkwZDAwMDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:7de6f2fc-bb3c-4039-b2a6-ba4245126b43"
        ],
        "x-ms-correlation-request-id": [
          "99be4b5f-05c2-4f24-8bea-dc94256040c6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205336Z:99be4b5f-05c2-4f24-8bea-dc94256040c6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:36 GMT"
        ],
        "Content-Length": [
          "985"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Linux VMs that do not have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"All\",\r\n    \"description\": \"This policy audits Linux virtual machines that do not have the specified applications installed. This policy should only be used along with its corresponding deploy policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\"\r\n          },\r\n          {\r\n            \"field\": \"name\",\r\n            \"equals\": \"installed_application_linux\"\r\n          },\r\n          {\r\n            \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n            \"notEquals\": \"Compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"audit\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"fee5cb2b-9d9b-410e-afe3-2902d90d0004\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mZWVkYmY4NC02Yjk5LTQ4OGMtYWNjMi03MWM4MjlhYTVmZmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ef51a6db-6b14-4cc0-8e50-383ec6988169"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "1586c568-8e00-4ff1-8b25-a94a71880f18"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205336Z:1586c568-8e00-4ff1-8b25-a94a71880f18"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:36 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'feedbf84-6b99-488c-acc2-71c829aa5ffc' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9mZWVkYmY4NC02Yjk5LTQ4OGMtYWNjMi03MWM4MjlhYTVmZmM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "b01618d3-7d2c-4dfc-be8a-9dbd4d3e60bf"
        ],
        "x-ms-request-id": [
          "westus:afe3a13a-ead6-478f-b4f7-aebd703e0efc"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11993"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205336Z:b01618d3-7d2c-4dfc-be8a-9dbd4d3e60bf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:35 GMT"
        ],
        "Content-Length": [
          "1108"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Vulnerabilities on your SQL databases should be remediated\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Indexed\",\r\n    \"description\": \"Monitor Vulnerability Assessment scan results and recommendations for how to remediate database vulnerabilities.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"in\": [\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/managedinstances/databases\"\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"type\": \"Microsoft.Security/complianceResults\",\r\n          \"name\": \"sqlVulnerabilityAssessment\",\r\n          \"existenceCondition\": {\r\n            \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n            \"in\": [\r\n              \"NotApplicable\",\r\n              \"OffByPolicy\",\r\n              \"Healthy\"\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"feedbf84-6b99-488c-acc2-71c829aa5ffc\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/0f636243-1b1c-4d50-880f-310f6199f2cb?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZjYzNjI0My0xYjFjLTRkNTAtODgwZi0zMTBmNjE5OWYyY2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:782d5675-8aff-465d-9b3e-a515b4c4e713"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "2242f996-82a6-46d0-860b-e1a573048a01"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:2242f996-82a6-46d0-860b-e1a573048a01"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:36 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '0f636243-1b1c-4d50-880f-310f6199f2cb' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/0f636243-1b1c-4d50-880f-310f6199f2cb?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8wZjYzNjI0My0xYjFjLTRkNTAtODgwZi0zMTBmNjE5OWYyY2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:2240db1d-5e6e-4200-9017-a2df52abac31"
        ],
        "x-ms-correlation-request-id": [
          "61d28935-451a-4c24-b3d6-6e4b2cdaf837"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:61d28935-451a-4c24-b3d6-6e4b2cdaf837"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:36 GMT"
        ],
        "Content-Length": [
          "1647"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Ensure containers listen only on allowed ports in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy enforces containers to listen only on allowed ports in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"allowedContainerPortsRegex\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Allowed container ports regex\",\r\n          \"description\": \"Regex representing container ports allowed in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$\"\r\n        }\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"ContainerAllowedPorts\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-ports/limited-preview/gatekeeperpolicy.rego\",\r\n          \"policyParameters\": {\r\n            \"allowedContainerPortsRegex\": \"[parameters('allowedContainerPortsRegex')]\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f636243-1b1c-4d50-880f-310f6199f2cb\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"0f636243-1b1c-4d50-880f-310f6199f2cb\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/16c6ca72-89d2-4798-b87e-496f9de7fcb7?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNmM2Y2E3Mi04OWQyLTQ3OTgtYjg3ZS00OTZmOWRlN2ZjYjc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:900a11e9-4d43-476a-99f0-bc3565d79a42"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "aa10e9e5-4699-4ca4-a500-815a96186cc4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:aa10e9e5-4699-4ca4-a500-815a96186cc4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:36 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '16c6ca72-89d2-4798-b87e-496f9de7fcb7' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/16c6ca72-89d2-4798-b87e-496f9de7fcb7?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8xNmM2Y2E3Mi04OWQyLTQ3OTgtYjg3ZS00OTZmOWRlN2ZjYjc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:8c717762-df38-45a1-bd88-96d3c63bdc0f"
        ],
        "x-ms-correlation-request-id": [
          "f7e04909-45f7-431c-a0b6-4d1106b6a798"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:f7e04909-45f7-431c-a0b6-4d1106b6a798"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:37 GMT"
        ],
        "Content-Length": [
          "1592"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Enforce labels on pods in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy enforces the specified labels are provided for pods in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"commaSeparatedListOfLabels\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Comma-separated list of labels\",\r\n          \"description\": \"A comma-separated list of labels to be specified on Pods in Kubernetes cluster. E.g. test1,test2\"\r\n        }\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"PodEnforceLabels\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/pod-enforce-labels/limited-preview/gatekeeperpolicy.rego\",\r\n          \"policyParameters\": {\r\n            \"commaSeparatedListOfLabels\": \"[parameters('commaSeparatedListOfLabels')]\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16c6ca72-89d2-4798-b87e-496f9de7fcb7\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"16c6ca72-89d2-4798-b87e-496f9de7fcb7\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/25dee3db-6ce0-4c02-ab5d-245887b24077?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNWRlZTNkYi02Y2UwLTRjMDItYWI1ZC0yNDU4ODdiMjQwNzc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:9dc24003-49e8-4e13-8713-83f3694ba36b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "e3cd8cba-8176-4abc-a7f9-35e61baa807f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:e3cd8cba-8176-4abc-a7f9-35e61baa807f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:36 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '25dee3db-6ce0-4c02-ab5d-245887b24077' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/25dee3db-6ce0-4c02-ab5d-245887b24077?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yNWRlZTNkYi02Y2UwLTRjMDItYWI1ZC0yNDU4ODdiMjQwNzc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:c017baf7-b760-4377-8b1a-e1f60e674539"
        ],
        "x-ms-correlation-request-id": [
          "a3981a1c-cbf0-4a92-902b-bb9e1ae5c32a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:a3981a1c-cbf0-4a92-902b-bb9e1ae5c32a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:37 GMT"
        ],
        "Content-Length": [
          "1629"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Ensure services listen only on allowed ports in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy enforces services to listen only on allowed ports in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"allowedServicePortsRegex\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Allowed service ports regex\",\r\n          \"description\": \"Regex representing service ports allowed in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$\"\r\n        }\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"ServiceAllowedPorts\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/service-allowed-ports/limited-preview/gatekeeperpolicy.rego\",\r\n          \"policyParameters\": {\r\n            \"allowedServicePortsRegex\": \"[parameters('allowedServicePortsRegex')]\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25dee3db-6ce0-4c02-ab5d-245887b24077\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"25dee3db-6ce0-4c02-ab5d-245887b24077\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/2fbff515-eecc-4b7e-9b63-fcc7138b7dc3?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZmJmZjUxNS1lZWNjLTRiN2UtOWI2My1mY2M3MTM4YjdkYzM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f224e1b8-173d-4f7d-a04f-df1a7341fc50"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "5756c6b2-753a-4e05-b903-ce2a9adc1b9b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205337Z:5756c6b2-753a-4e05-b903-ce2a9adc1b9b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:37 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '2fbff515-eecc-4b7e-9b63-fcc7138b7dc3' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/2fbff515-eecc-4b7e-9b63-fcc7138b7dc3?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy8yZmJmZjUxNS1lZWNjLTRiN2UtOWI2My1mY2M3MTM4YjdkYzM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:b5bb0265-630b-41a9-bace-4282f538767d"
        ],
        "x-ms-correlation-request-id": [
          "eb73d5ac-38df-4fc5-aac8-bbacc8549ad2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:eb73d5ac-38df-4fc5-aac8-bbacc8549ad2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:37 GMT"
        ],
        "Content-Length": [
          "1247"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Enforce HTTPS ingress in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy enforces HTTPS ingress in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"HttpsIngressOnly\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-https-only/limited-preview/gatekeeperpolicy.rego\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fbff515-eecc-4b7e-9b63-fcc7138b7dc3\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"2fbff515-eecc-4b7e-9b63-fcc7138b7dc3\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/5f86cb6e-c4da-441b-807c-44bd0cc14e66?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81Zjg2Y2I2ZS1jNGRhLTQ0MWItODA3Yy00NGJkMGNjMTRlNjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:83904307-eb70-40d6-b554-e42941314aed"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "4b7560d0-0823-4874-bbd9-529f54870a97"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:4b7560d0-0823-4874-bbd9-529f54870a97"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '5f86cb6e-c4da-441b-807c-44bd0cc14e66' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/5f86cb6e-c4da-441b-807c-44bd0cc14e66?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy81Zjg2Y2I2ZS1jNGRhLTQ0MWItODA3Yy00NGJkMGNjMTRlNjY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "392026a5-23a6-426d-b89a-0b7e32eb529e"
        ],
        "x-ms-request-id": [
          "westus:9015244d-967c-4401-ba6b-4cbdf6714df1"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:392026a5-23a6-426d-b89a-0b7e32eb529e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:37 GMT"
        ],
        "Content-Length": [
          "1656"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Ensure only allowed container images in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy ensures only allowed container images are running in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"allowedContainerImagesRegex\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Allowed container images regex\",\r\n          \"description\": \"Regex representing container images allowed in Kubernetes cluster. E.g. Regex of azure container registry images is ^.+azurecr.io/.+$\"\r\n        }\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"ContainerAllowedImages\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-images/limited-preview/gatekeeperpolicy.rego\",\r\n          \"policyParameters\": {\r\n            \"allowedContainerImagesRegex\": \"[parameters('allowedContainerImagesRegex')]\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5f86cb6e-c4da-441b-807c-44bd0cc14e66\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"5f86cb6e-c4da-441b-807c-44bd0cc14e66\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/7ce7ac02-a5c6-45d6-8d1b-844feb1c1531?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83Y2U3YWMwMi1hNWM2LTQ1ZDYtOGQxYi04NDRmZWIxYzE1MzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:17e31bdc-c9ad-453b-a064-c37326fd3f3d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "7451c048-8ddd-4a9e-bd88-e64c242b8a11"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:7451c048-8ddd-4a9e-bd88-e64c242b8a11"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition '7ce7ac02-a5c6-45d6-8d1b-844feb1c1531' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/7ce7ac02-a5c6-45d6-8d1b-844feb1c1531?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy83Y2U3YWMwMi1hNWM2LTQ1ZDYtOGQxYi04NDRmZWIxYzE1MzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:acf0f8e3-dbdf-492f-9581-c6ffe92d6943"
        ],
        "x-ms-correlation-request-id": [
          "39d7d211-ab21-465d-bfd0-d41f0f0b6c83"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:39d7d211-ab21-465d-bfd0-d41f0f0b6c83"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "1291"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Do not allow privileged containers in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy does not allow privileged containers creation in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"ContainerNoPrivilege\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-no-privilege/limited-preview/gatekeeperpolicy.rego\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7ce7ac02-a5c6-45d6-8d1b-844feb1c1531\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"7ce7ac02-a5c6-45d6-8d1b-844feb1c1531\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a2d3ed81-8d11-4079-80a5-1faadc0024f4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMmQzZWQ4MS04ZDExLTQwNzktODBhNS0xZmFhZGMwMDI0ZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c8eb0833-3843-48de-8f57-c6c04c6b1cd4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "8c1308b9-712d-43f1-b43b-13b531adcad5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:8c1308b9-712d-43f1-b43b-13b531adcad5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a2d3ed81-8d11-4079-80a5-1faadc0024f4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a2d3ed81-8d11-4079-80a5-1faadc0024f4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hMmQzZWQ4MS04ZDExLTQwNzktODBhNS0xZmFhZGMwMDI0ZjQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:65b154ce-5dfb-484e-a23a-53c57f446477"
        ],
        "x-ms-correlation-request-id": [
          "5a5e12b7-8cdb-4803-88b0-492abffdca12"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:5a5e12b7-8cdb-4803-88b0-492abffdca12"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "1341"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Ensure CPU and memory resource limits defined on containers in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy ensures CPU and memory resource limits are defined on containers in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"ContainerResourceLimits\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-resource-limits/limited-preview/gatekeeperpolicy.rego\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a2d3ed81-8d11-4079-80a5-1faadc0024f4\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a2d3ed81-8d11-4079-80a5-1faadc0024f4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/a74d8f00-2fd9-4ce4-968e-0ee1eb821698?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hNzRkOGYwMC0yZmQ5LTRjZTQtOTY4ZS0wZWUxZWI4MjE2OTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:40ed2e84-2abb-4819-94ee-eac76806063b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "366d28b6-c4be-4580-97b2-397adf809ab0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205338Z:366d28b6-c4be-4580-97b2-397adf809ab0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'a74d8f00-2fd9-4ce4-968e-0ee1eb821698' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/a74d8f00-2fd9-4ce4-968e-0ee1eb821698?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9hNzRkOGYwMC0yZmQ5LTRjZTQtOTY4ZS0wZWUxZWI4MjE2OTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11993"
        ],
        "x-ms-request-id": [
          "westus:de5a5b12-0960-454a-8611-4857c8a73f67"
        ],
        "x-ms-correlation-request-id": [
          "01891ca2-4f2b-45b8-a4dd-044e5b872268"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205339Z:01891ca2-4f2b-45b8-a4dd-044e5b872268"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "1293"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Enforce internal load balancers in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy enforces load balancers do not have public IPs in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"LoadBalancersInternal\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/loadbalancer-no-publicips/limited-preview/gatekeeperpolicy.rego\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a74d8f00-2fd9-4ce4-968e-0ee1eb821698\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"a74d8f00-2fd9-4ce4-968e-0ee1eb821698\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policydefinitions/d011d9f7-ba32-4005-b727-b3d09371ca60?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kMDExZDlmNy1iYTMyLTQwMDUtYjcyNy1iM2QwOTM3MWNhNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f4836bc5-8108-4086-be38-8f064bfe26a4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "68f1d9aa-8209-4baf-b2e9-6e47fcf90e8e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205339Z:68f1d9aa-8209-4baf-b2e9-6e47fcf90e8e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "138"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'd011d9f7-ba32-4005-b727-b3d09371ca60' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policydefinitions/d011d9f7-ba32-4005-b727-b3d09371ca60?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lkZWZpbml0aW9ucy9kMDExZDlmNy1iYTMyLTQwMDUtYjcyNy1iM2QwOTM3MWNhNjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicyDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:1d06c761-8683-4fca-a5da-1bb2785d8eea"
        ],
        "x-ms-correlation-request-id": [
          "32221558-8062-4f5f-97d1-1c506f6c9163"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205339Z:32221558-8062-4f5f-97d1-1c506f6c9163"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "1319"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Limited Preview]: Enforce unique ingress hostnames across namespaces in AKS\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"mode\": \"Microsoft.ContainerService.Data\",\r\n    \"description\": \"This policy enforces unique ingress hostnames across namespaces in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\",\r\n    \"metadata\": {\r\n      \"category\": \"Kubernetes service\"\r\n    },\r\n    \"parameters\": {\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Enable or disable the execution of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"EnforceRegoPolicy\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"EnforceRegoPolicy\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"field\": \"type\",\r\n        \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[parameters('effect')]\",\r\n        \"details\": {\r\n          \"policyId\": \"UniqueIngressHostnames\",\r\n          \"policy\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-hostnames-conflict/limited-preview/gatekeeperpolicy.rego\"\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/d011d9f7-ba32-4005-b727-b3d09371ca60\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"d011d9f7-ba32-4005-b727-b3d09371ca60\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE5LTAxLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "BuiltinFilterParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus:576b72cd-07ed-4f15-80f9-8c10343b57fb"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "5e2f4a73-90cf-436d-afd6-493670fcba51"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205339Z:5e2f4a73-90cf-436d-afd6-493670fcba51"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:38 GMT"
        ],
        "Content-Length": [
          "181522"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain only the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines in which the Administrators group does not contain only the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"Members\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members\",\r\n              \"description\": \"A semicolon-separated list of all the expected members of the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_AdministratorsGroupMembers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b821191b-3a12-44bc-9c38-212138a29ff3\",\r\n            \"parameters\": {\r\n              \"Members\": {\r\n                \"value\": \"[parameters('Members')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_AdministratorsGroupMembers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cc7cda28-f867-4311-8497-a526129a8d19\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/06122b01-688c-42a8-af2e-fa97dd39aa3b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"06122b01-688c-42a8-af2e-fa97dd39aa3b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs on which the Log Analytics agent is not connected as expected\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"WorkspaceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Connected workspace IDs\",\r\n              \"description\": \"A semicolon-separated list of the workspace IDs that the Log Analytics agent should be connected to\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsLogAnalyticsAgentConnection\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/68511db2-bd02-41c4-ae6b-1900a012968a\",\r\n            \"parameters\": {\r\n              \"WorkspaceId\": {\r\n                \"value\": \"[parameters('WorkspaceId')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsLogAnalyticsAgentConnection\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/06c5e415-a662-463a-bb85-ede14286b979\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"06c5e415-a662-463a-bb85-ede14286b979\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain all of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines in which the Administrators group does not contain all of the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"MembersToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members to include\",\r\n              \"description\": \"A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_AdministratorsGroupMembersToInclude\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\",\r\n            \"parameters\": {\r\n              \"MembersToInclude\": {\r\n                \"value\": \"[parameters('MembersToInclude')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_AdministratorsGroupMembersToInclude\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/133046de-0bd7-4546-93f4-f452e9e258b7\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"133046de-0bd7-4546-93f4-f452e9e258b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Monitoring in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Monitor all the available security recommendations in Azure Security Center. This is the default policy for Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"vmssSystemUpdatesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System updates on virtual machine scale sets should be installed\",\r\n              \"description\": \"Enable or disable virtual machine scale sets reporting of system updates\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vmssEndpointProtectionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Endpoint protection solution should be installed on virtual machine scale sets\",\r\n              \"description\": \"Enable or disable virtual machine scale sets endpoint protection monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vmssOsVulnerabilitiesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\",\r\n              \"description\": \"Enable or disable virtual machine scale sets OS vulnerabilities monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"systemUpdatesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System updates should be installed on your machines\",\r\n              \"description\": \"Enable or disable reporting of system updates\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"systemConfigurationsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerabilities in security configuration on your machines should be remediated\",\r\n              \"description\": \"Enable or disable OS vulnerabilities monitoring (based on a configured baseline)\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"endpointProtectionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor missing Endpoint Protection in Azure Security Center\",\r\n              \"description\": \"Enable or disable endpoint protection monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diskEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Disk encryption should be applied on virtual machines\",\r\n              \"description\": \"Enable or disable the monitoring for VM disk encryption\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"networkSecurityGroupsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor network security groups\",\r\n              \"description\": \"[Deprecated] Enable or disable monitoring of network security groups with permissive rules\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"networkSecurityGroupsOnSubnetsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Security Groups on the subnet level should be enabled\",\r\n              \"description\": \"Enable or disable monitoring of NSGs on subnets\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"networkSecurityGroupsOnVirtualMachinesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Security Groups for virtual machines should be enabled\",\r\n              \"description\": \"Enable or disable monitoring of NSGs on VMs\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webApplicationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The NSGs rules for web applications on IaaS should be hardened\",\r\n              \"description\": \"Enable or disable the monitoring of unprotected web applications\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"nextGenerationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n              \"description\": \"Enable or disable overly permissive inbound NSG rules monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vulnerabilityAssesmentMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerabilities should be remediated by a Vulnerability Assessment solution\",\r\n              \"description\": \"Enable or disable the detection of VM vulnerabilities by a vulnerability assessment solution\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"storageEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit missing blob encryption for storage accounts\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of blob encryption for storage accounts\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"jitNetworkAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Just-In-Time network access control should be applied on virtual machines\",\r\n              \"description\": \"Enable or disable the monitoring of network just In time access\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"adaptiveApplicationControlsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Adaptive Application Controls should be enabled on virtual machines\",\r\n              \"description\": \"Enable or disable the monitoring of application whitelisting in Azure Security Center\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlAuditingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor unaudited SQL servers in Azure Security Center\",\r\n              \"description\": \"Enable or disable the monitoring of unaudited SQL databases\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor unencrypted SQL databases in Azure Security Center\",\r\n              \"description\": \"Enable or disable the monitoring of unencrypted SQL databases\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlDbEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Transparent Data Encryption on SQL databases should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of unencrypted SQL databases\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlServerAuditingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit SQL server level Auditing settings\",\r\n              \"description\": \"Enable or disable the monitoring of unaudited SQL Servers\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlServerAuditingActionsAndGroupsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit SQL auditing settings at the server level for the Action-Groups and Actions\",\r\n              \"description\": \"Enable or disable the monitoring of auditing policy Action-Groups and Actions setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"SqlServerAuditingRetentionDaysMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"SQL servers should be configured with auditing retention days greater than 90 days\",\r\n              \"description\": \"Enable or disable the monitoring of SQL servers with auditing retention period less than 90\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInAppServiceMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor diagnostic logs in Azure App Services\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of diagnostics logs in Azure App Services\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"diagnosticsLogsInSelectiveAppServicesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in App Services should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostics logs in Azure App Services\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"encryptionOfAutomationAccountMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Automation account variables should be encrypted\",\r\n              \"description\": \"Enable or disable the monitoring of automation account encryption\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"diagnosticsLogsInBatchAccountMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Batch accounts should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Batch accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInBatchAccountRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) for logs in Batch accounts\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"metricAlertsInBatchAccountMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric alert rules should be configured on Batch accounts\",\r\n              \"description\": \"Enable or disable the monitoring of metric alerts in Batch accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"classicComputeVMsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Virtual machines should be migrated to new Azure Resource Manager resources\",\r\n              \"description\": \"Enable or disable the monitoring of classic compute VMs\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"classicStorageAccountsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage accounts should be migrated to new Azure Resource Manager resources\",\r\n              \"description\": \"Enable or disable the monitoring of classic storage accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Data Lake Analytics should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Data Lake Analytics accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInDataLakeAnalyticsRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Data Lake Analytics accounts\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"diagnosticsLogsInDataLakeStoreMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Azure Data Lake Store should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Data Lake Store accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInDataLakeStoreRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Data Lake Store accounts\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"diagnosticsLogsInEventHubMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Event Hub should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Event Hub accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInEventHubRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Event Hub accounts\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"diagnosticsLogsInKeyVaultMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Key Vault should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Key Vault vaults\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInKeyVaultRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Key Vault vaults\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"diagnosticsLogsInLogicAppsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Logic Apps should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Logic Apps workflows\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInLogicAppsRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Logic Apps workflows\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"diagnosticsLogsInRedisCacheMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Only secure connections to your Redis Cache should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Azure Redis Cache\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"diagnosticsLogsInSearchServiceMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Search services should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Azure Search service\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInSearchServiceRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Azure Search service\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"aadAuthenticationInServiceFabricMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Service Fabric clusters should only use Azure Active Directory for client authentication\",\r\n              \"description\": \"Enable or disable the monitoring of Azure Active Directory for client authentication in Service Fabric\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"clusterProtectionLevelInServiceFabricMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign\",\r\n              \"description\": \"Enable or disable the monitoring of cluster protection level in Service Fabric\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"diagnosticsLogsInServiceBusMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Service Bus should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Service Bus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInServiceBusRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Service Bus\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"namespaceAuthorizationRulesInServiceBusMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Service Bus namespace\",\r\n              \"description\": \"Enable or disable the monitoring of Service Bus namespace authorization rules\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"aadAuthenticationInSqlServerMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"An Azure Active Directory administrator should be provisioned for SQL servers\",\r\n              \"description\": \"Enable or disable the monitoring of an Azure AD admininistrator for SQL server\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"secureTransferToStorageAccountMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Secure transfer to storage accounts should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of secure transfer to storage account\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"diagnosticsLogsInStreamAnalyticsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Azure Stream Analytics should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Stream Analytics\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInStreamAnalyticsRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in Stream Analytics\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"useRbacRulesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit usage of custom RBAC rules\",\r\n              \"description\": \"Enable or disable the monitoring of using built-in RBAC rules\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit unrestricted network access to storage accounts\",\r\n              \"description\": \"Enable or disable the monitoring of network access to storage account\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"diagnosticsLogsInServiceFabricMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in Virtual Machine Scale Sets should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in Service Fabric\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"accessRulesInEventHubNamespaceMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace\",\r\n              \"description\": \"Enable or disable the monitoring of access rules in Event Hub namespaces\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"accessRulesInEventHubMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Authorization rules on the Event Hub instance should be defined\",\r\n              \"description\": \"Enable or disable the monitoring of access rules in Event Hubs\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"sqlDbVulnerabilityAssesmentMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerabilities on your SQL databases should be remediated\",\r\n              \"description\": \"Enable or disable the monitoring of Vulnerability Assessment scan results and recommendations for how to remediate database vulnerabilities.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlDbDataClassificationMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Sensitive data in your SQL databases should be classified\",\r\n              \"description\": \"Enable or disable the monitoring of sensitive data classification in databases.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityDesignateLessThanOwnersMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"A maximum of 3 owners should be designated for your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of maximum owners in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityDesignateMoreThanOneOwnerMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"There should be more than one owner assigned to your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of minimum owners in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityEnableMFAForOwnerPermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MFA should be enabled on accounts with owner permissions on your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of MFA for accounts with owner permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityEnableMFAForWritePermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MFA should be enabled accounts with write permissions on your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of MFA for accounts with write permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityEnableMFAForReadPermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MFA should be enabled on accounts with read permissions on your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of MFA for accounts with read permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Deprecated accounts with owner permissions should be removed from your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of deprecated acounts with owner permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityRemoveDeprecatedAccountMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Deprecated accounts should be removed from your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of deprecated acounts in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"External accounts with owner permissions should be removed from your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of external acounts with owner permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"External accounts with write permissions should be removed from your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of external acounts with write permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"External accounts with read permissions should be removed from your subscription\",\r\n              \"description\": \"Enable or disable the monitoring of external acounts with read permissions in subscription\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"apiAppConfigureIPRestrictionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor Configure IP restrictions for API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of IP restrictions for API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"functionAppConfigureIPRestrictionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor Configure IP restrictions for Function App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of IP restrictions for Function App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppConfigureIPRestrictionsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor Configure IP restrictions for Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of IP restrictions for Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"apiAppDisableRemoteDebuggingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Remote debugging should be turned off for API App\",\r\n              \"description\": \"Enable or disable the monitoring of remote debugging for API App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"functionAppDisableRemoteDebuggingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Remote debugging should be turned off for Function App\",\r\n              \"description\": \"Enable or disable the monitoring of remote debugging for Function App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webAppDisableRemoteDebuggingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Remote debugging should be turned off for Web Application\",\r\n              \"description\": \"Enable or disable the monitoring of remote debugging for Web App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"apiAppDisableWebSocketsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor disable web sockets for API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of web sockets for API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"functionAppDisableWebSocketsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor disable web sockets for Function App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of web sockets for Function App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppDisableWebSocketsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor disable web sockets for Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of web sockets for Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"apiAppEnforceHttpsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"API App should only be accessible over HTTPS\",\r\n              \"description\": \"Enable or disable the monitoring of the use of HTTPS in API App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"functionAppEnforceHttpsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Function App should only be accessible over HTTPS\",\r\n              \"description\": \"Enable or disable the monitoring of the use of HTTPS in function App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webAppEnforceHttpsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Web Application should only be accessible over HTTPS\",\r\n              \"description\": \"Enable or disable the monitoring of the use of HTTPS in Web App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"apiAppRestrictCORSAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"CORS should not allow every resource to access your API App\",\r\n              \"description\": \"Enable or disable the monitoring of CORS restrictions for API App\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"functionAppRestrictCORSAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"CORS should not allow every resource to access your Function App\",\r\n              \"description\": \"Enable or disable the monitoring of CORS restrictions for API Function\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webAppRestrictCORSAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"CORS should not allow every resource to access your Web Application\",\r\n              \"description\": \"Enable or disable the monitoring of CORS restrictions for API Web\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"apiAppUsedCustomDomainsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor the custom domain use in API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of custom domain use in API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"functionAppUsedCustomDomainsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor the custom domain use in Function App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of custom domain use in Function App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppUsedCustomDomainsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor the custom domain use in Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of custom domain use in Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"apiAppUsedLatestDotNetMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest .Net in API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of .Net version in API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppUsedLatestDotNetMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest .Net in Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of .Net version in Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"apiAppUsedLatestJavaMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest Java in API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of Java version in API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppUsedLatestJavaMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest Java in Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of Java version in Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppUsedLatestNodeJsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest Node.js in Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of Node.js version in Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"apiAppUsedLatestPHPMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest PHP in API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of PHP version in API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppUsedLatestPHPMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest PHP in Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of PHP version in Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"apiAppUsedLatestPythonMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest Python in API App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of Python version in API App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"webAppUsedLatestPythonMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor use latest Python in Web App\",\r\n              \"description\": \"[Deprecated] Enable or disable the monitoring of Python version in Web App\",\r\n              \"deprecated\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          },\r\n          \"vnetEnableDDoSProtectionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"DDoS Protection Standard should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of DDoS protection for virtual network\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInIoTHubMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Diagnostic logs in IoT Hub should be enabled\",\r\n              \"description\": \"Enable or disable the monitoring of diagnostic logs in IoT Hubs\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diagnosticsLogsInIoTHubRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (in days) of logs in IoT Hub accounts\",\r\n              \"description\": \"The required diagnostic logs retention period in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          },\r\n          \"sqlServerAdvancedDataSecurityMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Advanced data security should be enabled on your SQL servers\",\r\n              \"description\": \"Enable or disable the monitoring of SQL servers without Advanced Data Security\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Ensure that 'Send alerts to' is set in SQL server Advanced Data Security settings\",\r\n              \"description\": \"Provide the email address where alerts will be sent when anomalous activities are detected on SQL servers\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Advanced data security settings for SQL managed instance should contain an email address to receive security alerts\",\r\n              \"description\": \"Enable or disable the monitoring that advanced data security settings for SQL managed instance contain at least one email address to receive security alerts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"SQL managed instances should send security alerts to admins and subscription owners\",\r\n              \"description\": \"Enable or Disable the monitoring of SQL managed instances without alerts being sent to admins and subscription owners\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Advanced data security should be enabled on your managed instances\",\r\n              \"description\": \"Enable or disable the monitoring of SQL managed instances without Advanced Data Security\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"kubernetesServiceRbacEnabledMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Role-Based Access Control (RBAC) should be used on Kubernetes Services\",\r\n              \"description\": \"Enable or disable the monitoring of Kubernetes Services without RBAC enabled\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"kubernetesServicePspEnabledMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Pod Security Policies should be defined on Kubernetes Services\",\r\n              \"description\": \"Enable or disable the monitoring of Kubernetes Services without Pod Security Policy enabled\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Authorized IP ranges should be defined on Kubernetes Services\",\r\n              \"description\": \"Enable or disable the monitoring of Kubernetes Services without Authorized IP Ranges enabled\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"kubernetesServiceVersionUpToDateMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kubernetes Services should be upgraded to a non vulnerable Kubernetes version\",\r\n              \"description\": \"Enable or disable the monitoring of the Kubernetes Services with versions that contain known vulnerabilities\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerability assessment should be enabled on your SQL managed instances\",\r\n              \"description\": \"Audit SQL managed instances which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vulnerabilityAssessmentOnServerMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerability assessment should be enabled on your SQL servers\",\r\n              \"description\": \"Audit Azure SQL servers which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"threatDetectionTypesOnManagedInstanceMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL managed instance Advanced Data Security settings\",\r\n              \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"threatDetectionTypesOnServerMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL server Advanced Data Security settings\",\r\n              \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"adaptiveNetworkHardeningsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Security Group Rules for Internet facing virtual machines should be hardened\",\r\n              \"description\": \"Enable or disable the monitoring of Internet-facing virtual machines for Network Security Group traffic hardening recommendations\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"restrictAccessToManagementPortsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Management ports should be closed on your virtual machines\",\r\n              \"description\": \"Enable or disable the monitoring of open management ports on Virtual Machines\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"restrictAccessToAppServicesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Access to App Services should be restricted\",\r\n              \"description\": \"Enable or disable the monitoring of permissive network access to app-services\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"disableIPForwardingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP Forwarding on your virtual machine should be disabled\",\r\n              \"description\": \"Enable or disable the monitoring of IP forwarding on virtual machines\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"SQL server TDE protector should be encrypted with your own key\",\r\n              \"description\": \"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"SQL managed instance TDE protector should be encrypted with your own key\",\r\n              \"description\": \"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vmssOsVulnerabilitiesMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vmssOsVulnerabilitiesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vmssEndpointProtectionMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vmssEndpointProtectionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vmssSystemUpdatesMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vmssSystemUpdatesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInIoTHubMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInIoTHubMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInIoTHubRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInServiceFabricMonitoringEffect\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInServiceFabricMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"accessRulesInEventHubNamespaceMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('accessRulesInEventHubNamespaceMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"accessRulesInEventHubMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('accessRulesInEventHubMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"disableUnrestrictedNetworkToStorageAccountMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('disableUnrestrictedNetworkToStorageAccountMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"useRbacRulesMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('useRbacRulesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInStreamAnalyticsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInStreamAnalyticsMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInStreamAnalyticsRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"secureTransferToStorageAccountMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('secureTransferToStorageAccountMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"aadAuthenticationInSqlServerMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('aadAuthenticationInSqlServerMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"namespaceAuthorizationRulesInServiceBusMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('namespaceAuthorizationRulesInServiceBusMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInServiceBusMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInServiceBusMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInServiceBusRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"clusterProtectionLevelInServiceFabricMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('clusterProtectionLevelInServiceFabricMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"aadAuthenticationInServiceFabricMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('aadAuthenticationInServiceFabricMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInSearchServiceMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInSearchServiceMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInSearchServiceRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInRedisCacheMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInRedisCacheMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInLogicAppsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInLogicAppsMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInLogicAppsRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInKeyVaultMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInKeyVaultMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInKeyVaultRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInEventHubMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInEventHubMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInEventHubRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInDataLakeStoreMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInDataLakeStoreMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInDataLakeStoreRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInDataLakeAnalyticsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInDataLakeAnalyticsMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInDataLakeAnalyticsRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"classicStorageAccountsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('classicStorageAccountsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"classicComputeVMsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('classicComputeVMsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"metricAlertsInBatchAccountPoolDeleteStart\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('metricAlertsInBatchAccountMonitoringEffect')]\"\r\n              },\r\n              \"metricName\": {\r\n                \"value\": \"PoolDeleteStartEvent\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInBatchAccountMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInBatchAccountMonitoringEffect')]\"\r\n              },\r\n              \"requiredRetentionDays\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInBatchAccountRetentionDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"encryptionOfAutomationAccountMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('encryptionOfAutomationAccountMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diagnosticsLogsInSelectiveAppServicesMonitoringEffect\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diagnosticsLogsInSelectiveAppServicesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlDbEncryptionMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlDbEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlServerAuditingMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlServerAuditingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlServerAuditingActionsAndGroupsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlServerAuditingActionsAndGroupsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"SqlServerAuditingRetentionDaysMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('SqlServerAuditingRetentionDaysMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlEncryptionMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlAuditingMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlAuditingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"systemUpdatesMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemUpdatesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"jitNetworkAccessMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('jitNetworkAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"adaptiveApplicationControlsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('adaptiveApplicationControlsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"networkSecurityGroupsOnSubnetsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('networkSecurityGroupsOnSubnetsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"networkSecurityGroupsOnVirtualMachinesMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('networkSecurityGroupsOnVirtualMachinesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"systemConfigurationsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemConfigurationsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"endpointProtectionMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('endpointProtectionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"diskEncryptionMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diskEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vulnerabilityAssessmentMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vulnerabilityAssesmentMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"webApplicationFirewallMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webApplicationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"nextGenerationFirewallMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('nextGenerationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlDbVulnerabilityAssesmentMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlDbVulnerabilityAssesmentMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlDbDataClassificationMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlDbDataClassificationMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityDesignateLessThanOwnersMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityDesignateLessThanOwnersMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityDesignateMoreThanOneOwnerMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityDesignateMoreThanOneOwnerMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityEnableMFAForOwnerPermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityEnableMFAForOwnerPermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityEnableMFAForWritePermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityEnableMFAForWritePermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityEnableMFAForReadPermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityEnableMFAForReadPermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityRemoveDeprecatedAccountMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityRemoveDeprecatedAccountMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityRemoveExternalAccountWithOwnerPermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityRemoveExternalAccountWithWritePermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityRemoveExternalAccountWithWritePermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"identityRemoveExternalAccountWithReadPermissionsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('identityRemoveExternalAccountWithReadPermissionsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"apiAppDisableRemoteDebuggingMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('apiAppDisableRemoteDebuggingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"functionAppDisableRemoteDebuggingMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('functionAppDisableRemoteDebuggingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"webAppDisableRemoteDebuggingMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webAppDisableRemoteDebuggingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"apiAppEnforceHttpsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('apiAppEnforceHttpsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"functionAppEnforceHttpsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('functionAppEnforceHttpsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"webAppEnforceHttpsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webAppEnforceHttpsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"apiAppRestrictCORSAccessMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('apiAppRestrictCORSAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"functionAppRestrictCORSAccessMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('functionAppRestrictCORSAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"webAppRestrictCORSAccessMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webAppRestrictCORSAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vnetEnableDDoSProtectionMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vnetEnableDDoSProtectionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlServerAdvancedDataSecurityMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlServerAdvancedDataSecurityMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlServerAdvancedDataSecurityEmailsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9677b740-f641-4f3c-b9c5-466005c85278\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlServerAdvancedDataSecurityEmailsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"sqlManagedInstanceAdvancedDataSecurityMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlManagedInstanceAdvancedDataSecurityMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"kubernetesServiceRbacEnabledMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('kubernetesServiceRbacEnabledMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"kubernetesServicePspEnabledMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('kubernetesServicePspEnabledMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"kubernetesServiceVersionUpToDateMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/fb893a29-21bb-418c-a157-e99480ec364c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('kubernetesServiceVersionUpToDateMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"kubernetesServiceAuthorizedIPRangesEnabledMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vulnerabilityAssessmentOnServerMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vulnerabilityAssessmentOnServerMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"vulnerabilityAssessmentOnManagedInstanceMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vulnerabilityAssessmentOnManagedInstanceMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"threatDetectionTypesOnServerMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('threatDetectionTypesOnServerMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"threatDetectionTypesOnManagedInstanceMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('threatDetectionTypesOnManagedInstanceMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"adaptiveNetworkHardeningsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('adaptiveNetworkHardeningsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"restrictAccessToManagementPortsMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('restrictAccessToManagementPortsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"restrictAccessToAppServicesMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('restrictAccessToAppServicesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"disableIPForwardingMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('disableIPForwardingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"ensureServerTDEIsEncryptedWithYourOwnKeyMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoring\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1f3afdf9-d0c9-4c3d-847f-89da613e70a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"installedApplication\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_InstalledApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\",\r\n            \"parameters\": {\r\n              \"installedApplication\": {\r\n                \"value\": \"[parameters('installedApplication')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_InstalledApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"25ef9b72-4af2-4501-acd1-fc814e73dde1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit UK OFFICIAL and UK NHS controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative includes policies that address a subset of UK OFFICIAL and UK NHS controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/ukofficial-blueprint and https://aka.ms/uknhs-blueprint\",\r\n        \"metadata\": {\r\n          \"category\": \"Regulatory Compliance\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of resource types that should have diagnostic logs enabled\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithReadPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithReadPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMaximumPasswordAge70Days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMinimumPasswordAge1Day\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmEtcPasswdFilePermissionsAreSetTo0644\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMaximumPasswordAge70Days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMinimumPasswordAge1Day\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleAppWhitelistingInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnauditedSQLDatabaseInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedSQLDatabaseInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedVmDisksInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorVmVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditDiagnosticSetting\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypes\": {\r\n                \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditEnablementOfEncryptionOfAutomationAccountVariables\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSecureTransferToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSQLServerLevelAuditingSettings\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditTheSettingOfClusterprotectionlevelPropertyToEncryptandsignInServiceFabric\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditTransparentDataEncryptionStatus\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUnrestrictedNetworkAccessToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUsageOfAzureActiveDirectoryForClientAuthenticationInServiceFabric\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditVMsThatDoNotUseManagedDisks\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUseOfClassicStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUseOfClassicVirtualMachines\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/3937f550-eedd-4639-9c5e-294358be442e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3937f550-eedd-4639-9c5e-294358be442e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit VMs with insecure password security settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits virtual machines with insecure password security settings. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_MaximumPasswordAge\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_MinimumPasswordAge\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_PasswordMustMeetComplexityRequirements\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_StorePasswordsUsingReversibleEncryption\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_EnforcePasswordHistory\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_MinimumPasswordLength\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_PasswordPolicy_msid110\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_PasswordPolicy_msid121\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_PasswordPolicy_msid232\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_MaximumPasswordAge\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_MinimumPasswordAge\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_PasswordMustMeetComplexityRequirements\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_StorePasswordsUsingReversibleEncryption\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_EnforcePasswordHistory\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_MinimumPasswordLength\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_PasswordPolicy_msid110\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_PasswordPolicy_msid121\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_PasswordPolicy_msid232\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit PCI v3.2.1:2018 controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of PCI v3.2.1:2018 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/pciv321-init.\",\r\n        \"metadata\": {\r\n          \"category\": \"Regulatory Compliance\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of resource types that should have diagnostic logs enabled\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditDeprecatedAccountsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditExternalAccountsWithReadPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditWindowsVmMaximumPasswordAge70Days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewDeployVmExtensionToAuditWindowsVmMaximumPasswordAge70Days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewDeployVmExtensionToAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewDeployVmExtensionToAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditHttpsOnlyAccessForAnApiApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditHttpsOnlyAccessForAFunctionApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditHttpsOnlyAccessForAWebApplication\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditMaximumNumberOfOwnersForASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewAuditMinimumNumberOfOwnersForSubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorUnauditedSQLDatabaseInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorUnencryptedSQLDatabaseInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorUnencryptedVmDisksInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"accessThroughInternetFacingEndpointShouldBeRestricted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"previewMonitorVmVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditDiagnosticSetting\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypes\": {\r\n                \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditEnablementOfEncryptionOfAutomationAccountVariables\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditSecureTransferToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditSQLServerLevelAuditingSettings\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditTheSettingOfClusterprotectionlevelPropertyToEncryptandsignInServiceFabric\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditUseOfClassicStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditUseOfClassicVirtualMachines\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditTransparentDataEncryptionStatus\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditUnrestrictedNetworkAccessToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"auditUsageOfCustomRBACRules\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/496eeda9-8f2f-4d5e-8dfd-204f0a92ed41\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"496eeda9-8f2f-4d5e-8dfd-204f0a92ed41\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that are not set to the specified time zone\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that are not set to the specified time zone. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"TimeZone\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Time zone\",\r\n              \"description\": \"The expected time zone\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"(UTC-12:00) International Date Line West\",\r\n              \"(UTC-11:00) Coordinated Universal Time-11\",\r\n              \"(UTC-10:00) Aleutian Islands\",\r\n              \"(UTC-10:00) Hawaii\",\r\n              \"(UTC-09:30) Marquesas Islands\",\r\n              \"(UTC-09:00) Alaska\",\r\n              \"(UTC-09:00) Coordinated Universal Time-09\",\r\n              \"(UTC-08:00) Baja California\",\r\n              \"(UTC-08:00) Coordinated Universal Time-08\",\r\n              \"(UTC-08:00) Pacific Time (US & Canada)\",\r\n              \"(UTC-07:00) Arizona\",\r\n              \"(UTC-07:00) Chihuahua, La Paz, Mazatlan\",\r\n              \"(UTC-07:00) Mountain Time (US & Canada)\",\r\n              \"(UTC-06:00) Central America\",\r\n              \"(UTC-06:00) Central Time (US & Canada)\",\r\n              \"(UTC-06:00) Easter Island\",\r\n              \"(UTC-06:00) Guadalajara, Mexico City, Monterrey\",\r\n              \"(UTC-06:00) Saskatchewan\",\r\n              \"(UTC-05:00) Bogota, Lima, Quito, Rio Branco\",\r\n              \"(UTC-05:00) Chetumal\",\r\n              \"(UTC-05:00) Eastern Time (US & Canada)\",\r\n              \"(UTC-05:00) Haiti\",\r\n              \"(UTC-05:00) Havana\",\r\n              \"(UTC-05:00) Indiana (East)\",\r\n              \"(UTC-05:00) Turks and Caicos\",\r\n              \"(UTC-04:00) Asuncion\",\r\n              \"(UTC-04:00) Atlantic Time (Canada)\",\r\n              \"(UTC-04:00) Caracas\",\r\n              \"(UTC-04:00) Cuiaba\",\r\n              \"(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\",\r\n              \"(UTC-04:00) Santiago\",\r\n              \"(UTC-03:30) Newfoundland\",\r\n              \"(UTC-03:00) Araguaina\",\r\n              \"(UTC-03:00) Brasilia\",\r\n              \"(UTC-03:00) Cayenne, Fortaleza\",\r\n              \"(UTC-03:00) City of Buenos Aires\",\r\n              \"(UTC-03:00) Greenland\",\r\n              \"(UTC-03:00) Montevideo\",\r\n              \"(UTC-03:00) Punta Arenas\",\r\n              \"(UTC-03:00) Saint Pierre and Miquelon\",\r\n              \"(UTC-03:00) Salvador\",\r\n              \"(UTC-02:00) Coordinated Universal Time-02\",\r\n              \"(UTC-02:00) Mid-Atlantic - Old\",\r\n              \"(UTC-01:00) Azores\",\r\n              \"(UTC-01:00) Cabo Verde Is.\",\r\n              \"(UTC) Coordinated Universal Time\",\r\n              \"(UTC+00:00) Dublin, Edinburgh, Lisbon, London\",\r\n              \"(UTC+00:00) Monrovia, Reykjavik\",\r\n              \"(UTC+00:00) Sao Tome\",\r\n              \"(UTC+01:00) Casablanca\",\r\n              \"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\",\r\n              \"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\",\r\n              \"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris\",\r\n              \"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb\",\r\n              \"(UTC+01:00) West Central Africa\",\r\n              \"(UTC+02:00) Amman\",\r\n              \"(UTC+02:00) Athens, Bucharest\",\r\n              \"(UTC+02:00) Beirut\",\r\n              \"(UTC+02:00) Cairo\",\r\n              \"(UTC+02:00) Chisinau\",\r\n              \"(UTC+02:00) Damascus\",\r\n              \"(UTC+02:00) Gaza, Hebron\",\r\n              \"(UTC+02:00) Harare, Pretoria\",\r\n              \"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\",\r\n              \"(UTC+02:00) Jerusalem\",\r\n              \"(UTC+02:00) Kaliningrad\",\r\n              \"(UTC+02:00) Khartoum\",\r\n              \"(UTC+02:00) Tripoli\",\r\n              \"(UTC+02:00) Windhoek\",\r\n              \"(UTC+03:00) Baghdad\",\r\n              \"(UTC+03:00) Istanbul\",\r\n              \"(UTC+03:00) Kuwait, Riyadh\",\r\n              \"(UTC+03:00) Minsk\",\r\n              \"(UTC+03:00) Moscow, St. Petersburg\",\r\n              \"(UTC+03:00) Nairobi\",\r\n              \"(UTC+03:30) Tehran\",\r\n              \"(UTC+04:00) Abu Dhabi, Muscat\",\r\n              \"(UTC+04:00) Astrakhan, Ulyanovsk\",\r\n              \"(UTC+04:00) Baku\",\r\n              \"(UTC+04:00) Izhevsk, Samara\",\r\n              \"(UTC+04:00) Port Louis\",\r\n              \"(UTC+04:00) Saratov\",\r\n              \"(UTC+04:00) Tbilisi\",\r\n              \"(UTC+04:00) Volgograd\",\r\n              \"(UTC+04:00) Yerevan\",\r\n              \"(UTC+04:30) Kabul\",\r\n              \"(UTC+05:00) Ashgabat, Tashkent\",\r\n              \"(UTC+05:00) Ekaterinburg\",\r\n              \"(UTC+05:00) Islamabad, Karachi\",\r\n              \"(UTC+05:00) Qyzylorda\",\r\n              \"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi\",\r\n              \"(UTC+05:30) Sri Jayawardenepura\",\r\n              \"(UTC+05:45) Kathmandu\",\r\n              \"(UTC+06:00) Astana\",\r\n              \"(UTC+06:00) Dhaka\",\r\n              \"(UTC+06:00) Omsk\",\r\n              \"(UTC+06:30) Yangon (Rangoon)\",\r\n              \"(UTC+07:00) Bangkok, Hanoi, Jakarta\",\r\n              \"(UTC+07:00) Barnaul, Gorno-Altaysk\",\r\n              \"(UTC+07:00) Hovd\",\r\n              \"(UTC+07:00) Krasnoyarsk\",\r\n              \"(UTC+07:00) Novosibirsk\",\r\n              \"(UTC+07:00) Tomsk\",\r\n              \"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi\",\r\n              \"(UTC+08:00) Irkutsk\",\r\n              \"(UTC+08:00) Kuala Lumpur, Singapore\",\r\n              \"(UTC+08:00) Perth\",\r\n              \"(UTC+08:00) Taipei\",\r\n              \"(UTC+08:00) Ulaanbaatar\",\r\n              \"(UTC+08:45) Eucla\",\r\n              \"(UTC+09:00) Chita\",\r\n              \"(UTC+09:00) Osaka, Sapporo, Tokyo\",\r\n              \"(UTC+09:00) Pyongyang\",\r\n              \"(UTC+09:00) Seoul\",\r\n              \"(UTC+09:00) Yakutsk\",\r\n              \"(UTC+09:30) Adelaide\",\r\n              \"(UTC+09:30) Darwin\",\r\n              \"(UTC+10:00) Brisbane\",\r\n              \"(UTC+10:00) Canberra, Melbourne, Sydney\",\r\n              \"(UTC+10:00) Guam, Port Moresby\",\r\n              \"(UTC+10:00) Hobart\",\r\n              \"(UTC+10:00) Vladivostok\",\r\n              \"(UTC+10:30) Lord Howe Island\",\r\n              \"(UTC+11:00) Bougainville Island\",\r\n              \"(UTC+11:00) Chokurdakh\",\r\n              \"(UTC+11:00) Magadan\",\r\n              \"(UTC+11:00) Norfolk Island\",\r\n              \"(UTC+11:00) Sakhalin\",\r\n              \"(UTC+11:00) Solomon Is., New Caledonia\",\r\n              \"(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky\",\r\n              \"(UTC+12:00) Auckland, Wellington\",\r\n              \"(UTC+12:00) Coordinated Universal Time+12\",\r\n              \"(UTC+12:00) Fiji\",\r\n              \"(UTC+12:00) Petropavlovsk-Kamchatsky - Old\",\r\n              \"(UTC+12:45) Chatham Islands\",\r\n              \"(UTC+13:00) Coordinated Universal Time+13\",\r\n              \"(UTC+13:00) Nuku'alofa\",\r\n              \"(UTC+13:00) Samoa\",\r\n              \"(UTC+14:00) Kiritimati Island\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsTimeZone\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c\",\r\n            \"parameters\": {\r\n              \"TimeZone\": {\r\n                \"value\": \"[parameters('TimeZone')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsTimeZone\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9f658460-46b7-43af-8565-94fc0662be38\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/538942d3-3fae-4fb6-9d94-744f9a51e7da\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"538942d3-3fae-4fb6-9d94-744f9a51e7da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Azure Monitor for VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Enable Azure Monitor for the Virtual Machines (VMs) in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Windows_VM_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n            \"parameters\": {\r\n              \"logAnalytics\": {\r\n                \"value\": \"[parameters('logAnalytics_1')]\"\r\n              },\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Linux_VM_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\r\n            \"parameters\": {\r\n              \"logAnalytics\": {\r\n                \"value\": \"[parameters('logAnalytics_1')]\"\r\n              },\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Windows_VM_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Linux_VM_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"LogAnalytics_OSImage_Audit\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude_windows\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              },\r\n              \"listOfImageIdToInclude_linux\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DependencyAgent_OSImage_Audit\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude_windows\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              },\r\n              \"listOfImageIdToInclude_linux\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"55f3eceb-5573-4f18-9695-226972c6d74a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that are not joined to the specified domain\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that are not joined to the specified domain. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"DomainName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Domain Name (FQDN)\",\r\n              \"description\": \"The fully qualified domain name (FQDN) that the Windows VMs should be joined to\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsDomainMembership\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970\",\r\n            \"parameters\": {\r\n              \"DomainName\": {\r\n                \"value\": \"[parameters('DomainName')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsDomainMembership\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/6b3c1e80-8ae5-405b-b021-c23d13b3959f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6b3c1e80-8ae5-405b-b021-c23d13b3959f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Azure Monitor for VM Scale Sets (VMSS)\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Enable Azure Monitor for the VM Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Windows_VMSS_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\r\n            \"parameters\": {\r\n              \"logAnalytics\": {\r\n                \"value\": \"[parameters('logAnalytics_1')]\"\r\n              },\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Linux_VMSS_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\r\n            \"parameters\": {\r\n              \"logAnalytics\": {\r\n                \"value\": \"[parameters('logAnalytics_1')]\"\r\n              },\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Windows_VMSS_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Linux_VMSS_Deploy\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"LogAnalytics_OSImage_VMSS_Audit\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude_windows\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              },\r\n              \"listOfImageIdToInclude_linux\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DependencyAgent_OSImage_VMSS_Audit\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\r\n            \"parameters\": {\r\n              \"listOfImageIdToInclude_windows\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n              },\r\n              \"listOfImageIdToInclude_linux\": {\r\n                \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"75714362-cae7-409e-9b99-a8e5075b7fad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit ISO 27001:2013 controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of ISO 27001:2013 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/iso27001-blueprint.\",\r\n        \"metadata\": {\r\n          \"category\": \"Regulatory Compliance\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of resource types that should have diagnostic logs enabled\",\r\n              \"strongType\": \"resourceTypes\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithReadPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDependencyAgentDeploymentVmImageOSUnlisted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDependencyAgentDeploymentInVMSSVmImageOSUnlisted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmPasswdFilePermissions\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMaximumPasswordAge70Days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMinimumPasswordAge1Day\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmShouldNotStorePasswordsUsingReversibleEncryption\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmEtcPasswdFilePermissionsAreSetTo0644\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAFunctionApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAWebApplication\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAnApiApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentVmImageOSUnlisted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentInVMSSVmImageOSUnlisted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditMaximumNumberOfOwnersForASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditMinimumNumberOfOwnersForSubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMaximumPasswordAge70Days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMinimumPasswordAge1Day\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmShouldNotStorePasswordsUsingReversibleEncryption\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleAppWhitelistingInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnauditedSQLDatabaseInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedSQLDatabaseInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedVmDisksInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnprotectedNetworkEndpointsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnprotectedWebApplicationInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorVmVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditDiagnosticSetting\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypes\": {\r\n                \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditEnablementOfEncryptionOfAutomationAccountVariables\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSecureTransferToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSQLServerLevelAuditingSettings\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditTheSettingOfClusterprotectionlevelPropertyToEncryptandsignInServiceFabric\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditTransparentDataEncryptionStatus\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUnrestrictedNetworkAccessToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUsageOfAzureActiveDirectoryForClientAuthenticationInServiceFabric\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUsageOfCustomRBACRules\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUseOfClassicStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUseOfClassicVirtualMachines\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditVMsThatDoNotUseManagedDisks\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"89c6cddc-1c73-4ac1-b19c-54d1a15a42f2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows web servers that are not using secure communication protocols\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsTLS\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsTLS\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"8bc55e6b-e9d5-4266-8dac-f688d151ec9c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines on which the specified services are not installed and 'Running'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"ServiceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Service names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the services that should be installed and 'Running'. e.g. 'WinRm;Wi*'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsServiceStatus\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262\",\r\n            \"parameters\": {\r\n              \"ServiceName\": {\r\n                \"value\": \"[parameters('ServiceName')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsServiceStatus\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/8eeec860-e2fa-4f89-a669-84942c57225f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"8eeec860-e2fa-4f89-a669-84942c57225f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Data Protection Suite\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Enable data protection for SQL servers. This initiative is assigned automatically by Azure Security Center Standard Tier.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"deployThreatDetectionOnSqlServers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines on which Windows Defender Exploit Guard is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"NotAvailableMachineState\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"State in which to show VMs on which Windows Defender Exploit Guard is not available\",\r\n              \"description\": \"Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to 'Non-Compliant' will make machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) non-compliant. Setting this value to 'Compliant' will make these machines compliant.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Compliant\",\r\n              \"Non-Compliant\"\r\n            ],\r\n            \"defaultValue\": \"Non-Compliant\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsDefenderExploitGuard\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\",\r\n            \"parameters\": {\r\n              \"NotAvailableMachineState\": {\r\n                \"value\": \"[parameters('NotAvailableMachineState')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsDefenderExploitGuard\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/9d2fd8e6-95c8-410d-add0-43ada4241574\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"9d2fd8e6-95c8-410d-add0-43ada4241574\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows Server VMs on which Windows Serial Console is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows Server virtual machines on which Windows Serial Console is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"EMSPortNumber\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"EMS Port Number\",\r\n              \"description\": \"An integer indicating the COM port to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ],\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"EMSBaudRate\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"EMS Baud Rate\",\r\n              \"description\": \"An integer indicating the baud rate to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"9600\",\r\n              \"19200\",\r\n              \"38400\",\r\n              \"57600\",\r\n              \"115200\"\r\n            ],\r\n            \"defaultValue\": \"115200\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsSerialConsole\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7a031c68-d6ab-406e-a506-697a19c634b0\",\r\n            \"parameters\": {\r\n              \"EMSPortNumber\": {\r\n                \"value\": \"[parameters('EMSPortNumber')]\"\r\n              },\r\n              \"EMSBaudRate\": {\r\n                \"value\": \"[parameters('EMSBaudRate')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsSerialConsole\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/acb6cd8e-45f5-466f-b3cb-ff6fce525f71\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"acb6cd8e-45f5-466f-b3cb-ff6fce525f71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs in which the Administrators group contains any of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines in which the Administrators group contains any of the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"MembersToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members to exclude\",\r\n              \"description\": \"A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_AdministratorsGroupMembersToExclude\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n            \"parameters\": {\r\n              \"MembersToExclude\": {\r\n                \"value\": \"[parameters('MembersToExclude')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_AdministratorsGroupMembersToExclude\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/add1999e-a61c-46d3-b8c3-f35fb8398175\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"add1999e-a61c-46d3-b8c3-f35fb8398175\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that contain certificates expiring within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that contain certificates expiring within the specified number of days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"CertificateStorePath\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate store path\",\r\n              \"description\": \"The path to the certificate store containing the certificates to check the expiration dates of. Default value is 'Cert:' which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: 'Cert:\\\\LocalMachine', 'Cert:\\\\LocalMachine\\\\TrustedPublisher', 'Cert:\\\\CurrentUser'\"\r\n            },\r\n            \"defaultValue\": \"Cert:\"\r\n          },\r\n          \"ExpirationLimitInDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expiration limit in days\",\r\n              \"description\": \"An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\"\r\n            },\r\n            \"defaultValue\": \"30\"\r\n          },\r\n          \"CertificateThumbprintsToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to include\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"CertificateThumbprintsToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to exclude\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"IncludeExpiredCertificates\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include expired certificates\",\r\n              \"description\": \"Must be 'true' or 'false'. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_CertificateExpiration\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\",\r\n            \"parameters\": {\r\n              \"CertificateStorePath\": {\r\n                \"value\": \"[parameters('CertificateStorePath')]\"\r\n              },\r\n              \"ExpirationLimitInDays\": {\r\n                \"value\": \"[parameters('ExpirationLimitInDays')]\"\r\n              },\r\n              \"CertificateThumbprintsToInclude\": {\r\n                \"value\": \"[parameters('CertificateThumbprintsToInclude')]\"\r\n              },\r\n              \"CertificateThumbprintsToExclude\": {\r\n                \"value\": \"[parameters('CertificateThumbprintsToExclude')]\"\r\n              },\r\n              \"IncludeExpiredCertificates\": {\r\n                \"value\": \"[parameters('IncludeExpiredCertificates')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_CertificateExpiration\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9328f27e-611e-44a7-a244-39109d7d35ab\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/b6f5e05c-0aaa-4337-8dd4-357c399d12ae\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"b6f5e05c-0aaa-4337-8dd4-357c399d12ae\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that have not restarted within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that have not restarted within the specified number of days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"NumberOfDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Number of days\",\r\n              \"description\": \"The number of days without restart until the machine is considered non-compliant\"\r\n            },\r\n            \"defaultValue\": \"12\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_MachineLastBootUpTime\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194\",\r\n            \"parameters\": {\r\n              \"NumberOfDays\": {\r\n                \"value\": \"[parameters('NumberOfDays')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_MachineLastBootUpTime\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/b8b5b0a8-b809-4e5d-8082-382c686e35b7\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"b8b5b0a8-b809-4e5d-8082-382c686e35b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs on which the DSC configuration is not compliant\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsDscConfiguration\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsDscConfiguration\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c58599d5-0d51-454f-aaf1-da18a5e76edd\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c58599d5-0d51-454f-aaf1-da18a5e76edd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Linux VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Linux virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_InstalledApplicationLinux\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721\",\r\n            \"parameters\": {\r\n              \"ApplicationName\": {\r\n                \"value\": \"[parameters('ApplicationName')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_InstalledApplicationLinux\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c937dcb4-4398-4b39-8d63-4a6be432252e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs with a pending reboot\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines with a pending reboot. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsPendingReboot\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsPendingReboot\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c96b2a9c-6fab-4ac2-ae21-502143491cd4\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c96b2a9c-6fab-4ac2-ae21-502143491cd4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that do not have the specified Windows PowerShell modules installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"Modules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"PowerShell Modules\",\r\n              \"description\": \"A semicolon-separated list of the names of the PowerShell modules that should be installed. You may also specify a specific version of a module that should be installed by including a comma after the module name, followed by the desired version. e.g. PSDscResources; SqlServerDsc, 12.0.0.0; ComputerManagementDsc, 6.1.0.0\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsPowerShellModules\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf\",\r\n            \"parameters\": {\r\n              \"Modules\": {\r\n                \"value\": \"[parameters('Modules')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsPowerShellModules\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c980fd64-c67f-49a6-a8a8-e57661150802\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c980fd64-c67f-49a6-a8a8-e57661150802\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"CertificateThumbprints\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_WindowsCertificateInTrustedRoot\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\",\r\n            \"parameters\": {\r\n              \"CertificateThumbprints\": {\r\n                \"value\": \"[parameters('CertificateThumbprints')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_WindowsCertificateInTrustedRoot\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/cdfcc6ff-945e-4bc6-857e-056cbc511e0c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"cdfcc6ff-945e-4bc6-857e-056cbc511e0c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit NIST SP 800-53 R4 controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of NIST SP 800-53 R4 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/nist80053-blueprint.\",\r\n        \"metadata\": {\r\n          \"category\": \"Regulatory Compliance\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalyticsWorkspaceIdforVMReporting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace ID for VM agent reporting\"\r\n            }\r\n          },\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of resource types that should have diagnostic logs enabled\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Microsoft.AnalysisServices/servers\",\r\n              \"Microsoft.ApiManagement/service\",\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          },\r\n          \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of users excluded from Windows VM Administrators group\"\r\n            }\r\n          },\r\n          \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of users that must be included in Windows VM Administrators group\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithReadPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditAnyMissingSystemUpdatesOnVirtualMachineScaleSetsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditCORSResourceAccessRestrictionsForAWebApplication\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithReadPermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAFunctionApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAWebApplication\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAnApiApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentMImageOSUnlisted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentInVMSSVmImageOSUnlisted\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsWorkspaceforVMPreviewReportMismatch\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917\",\r\n            \"parameters\": {\r\n              \"logAnalyticsWorkspaceId\": {\r\n                \"value\": \"[parameters('logAnalyticsWorkspaceIdforVMreporting')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditMaximumNumberOfOwnersForASubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditMinimumNumberOfOwnersForSubscription\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditOSVulnerabilitiesOnYourVirtualMachineScaleSetsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditRemoteDebuggingStateForAFunctionApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditRemoteDebuggingStateForAWebApplication\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditRemoteDebuggingStateForAnAPIApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditStandardTierOfDDoSProtectionIsEnabledForAVirtualNetwork\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatLinuxVMsDoNotAllowRemoteConnectionsFromAccountsWithoutPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatLinuxVMsDoNotHaveAccountsWithoutPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatLinuxVMsHaveThePasswdFilePermissionsSetTo0644\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsCannotreUseThePrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsHaveAMaximumPasswordAgeOf70days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAudiThatWindowsVMsHaveAMinimumPasswordAgeOf1Day\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsHaveThePasswordComplexitySettingEnabled\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsRestrictTheMinimumPasswordLengthTo14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsStorePasswordsUsingReversibleEncryption\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewAuditTheEndpointProtectionSolutionOnVirtualMachineScaleSetsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatLinuxVMsDoNotAllowRemoteConnectionsFromAccountsWithoutPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatLinuxVMsDoNotHaveAccountsWithoutPasswords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatLinuxVMsHaveThePasswdFilePermissionsSeTTo0644\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsCannotreUseThePrevious24Passwords\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsHaveAMaximumPasswordAgeOf70days\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsHaveAMinimumPasswordAgeOf1Day\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsHaveThePasswordComplexitySettingEnabled\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsRestrictTheMinimumPasswordLengthTo14Characters\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsStorePasswordsUsingReversibleEncryption\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorInternetFacingVirtualMachinesForNetworkSecurityGroupTrafficHardeningRecommendations\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleAppWhitelistingInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleNetworkJustInTimeJITAccessInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnauditedSQLServersInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedSQLDatabasesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedVMDisksInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorUnprotectedNetworkEndpointsInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"PreviewMonitorVMVulnerabilitiesInAzureSecurityCenter\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditDiagnosticSetting\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypes\": {\r\n                \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSecureTransferToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSQLManagedInstancesWithoutAdvancedDataSecurity\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSQLServerLevelAuditingSettings\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditSQLServersWithoutAdvancedDataSecurity\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditThatTheAdministratorsGroupInsideWindowsVMsExcludesTheSpecifiedMembers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditThatTheAdministratorsGroupInsideWindowsVMsIncludesTheSpecifiedMembers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditThatWindowsWebServersAreUsingsScureCommunicationProtocols\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditTransparentDataEncryptionStatus\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUnrestrictedNetworkAccessToStorageAccounts\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUsageOfAzureActiveDirectoryForClientAuthenticationInServiceFabric\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditUsageOfCustomRBACRules\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"AuditVirtualMachinesWithoutDisasterRecoveryConfigured\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DeployVMExtensionToAuditThatTheAdministratorsGroupInsideWindowsVMsExcludesTheSpecifiedMembers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n            \"parameters\": {\r\n              \"MembersToExclude\": {\r\n                \"value\": \"[parameters('listOfMembersToExcludeFromWindowsVMAdministratorsGroup')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DeployVMExtensionToAuditThatTheAdministratorsGroupInsideWindowsVMsIncludesTheSpecifiedMembers\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\",\r\n            \"parameters\": {\r\n              \"MembersToInclude\": {\r\n                \"value\": \"[parameters('listOfMembersToIncludeInWindowsVMAdministratorsGroup')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"DeployVMExtensionToAuditThatWindowsWebServersAreUsingScureCommunicationProtocols\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_NotInstalledApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2\",\r\n            \"parameters\": {\r\n              \"ApplicationName\": {\r\n                \"value\": \"[parameters('ApplicationName')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_NotInstalledApp\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"d7fff7ea-9d47-4952-b854-b7da261e48f2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Linux VMs that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This initiative deploys the policy requirements and audits Linux virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\"\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'python; powershell'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Deploy_NotInstalledApplicationLinux\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0\",\r\n            \"parameters\": {\r\n              \"ApplicationName\": {\r\n                \"value\": \"[parameters('ApplicationName')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Audit_NotInstalledApplicationLinux\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f48bcc78-5400-4fb0-b913-5140a2e5fa20\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim ttt\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7915382897531231755\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"japaneast\",\r\n                  \"japanwest\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policySetDefinitions/3613bdc8-6f75-461c-a1e8-06b1fcf6905b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3613bdc8-6f75-461c-a1e8-06b1fcf6905b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim set\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"1\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {\r\n            \"omsWorkspace\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7\",\r\n            \"resourceGroups\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7\",\r\n            \"resourceGroup\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"ALLOWEDSTORAGESKU_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11816456642448143785\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/9c1ba477-ff0c-41ea-8a5d-826c4ca18208\",\r\n            \"parameters\": {\r\n              \"omsWorkspace\": {\r\n                \"value\": \"/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/resourcegroups/jilim/providers/microsoft.operationalinsights/workspaces/jilimabc\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7095696909984450251\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/e6440295-d0ac-472b-949b-1cf289618198\",\r\n            \"parameters\": {\r\n              \"locations\": {\r\n                \"value\": [\r\n                  \"australiaeast\"\r\n                ]\r\n              },\r\n              \"location\": {\r\n                \"value\": \"australiaeast\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": [\r\n                  \"jilim\"\r\n                ]\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"jilim\"\r\n              },\r\n              \"tags\": {\r\n                \"value\": [\r\n                  \"a\"\r\n                ]\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"a\"\r\n              },\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"eastus\"\r\n              },\r\n              \"allowedStorageSkus\": {\r\n                \"value\": [\r\n                  \"Standard_LRS\"\r\n                ]\r\n              },\r\n              \"allowedStorageSku\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": [\r\n                  \"FirstName\"\r\n                ]\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"FirstName\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/PolicyUIMG/providers/Microsoft.Authorization/policySetDefinitions/482fc09c-82af-48b9-96e0-6e750f0153db\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"482fc09c-82af-48b9-96e0-6e750f0153db\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test init2\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9388605824103837052\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/20929e43-ae09-4aac-b8ce-05a42434a1ec\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"London\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15255467709018494198\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/c8a0e9e0-f0e9-4d4c-8214-aace6218110e\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"London\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovTest5/providers/Microsoft.Authorization/policySetDefinitions/21e27984-a6b2-43de-a786-643b7df0c0b2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"21e27984-a6b2-43de-a786-643b7df0c0b2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test init\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {\r\n            \"allowedLocations\": \"/providers/Microsoft.Management/managementGroups/AzGovTest5\",\r\n            \"listOfAllowedSKUs\": \"/subscriptions/72930a30-8e57-4e97-98fe-02c1023ab43a\"\r\n          }\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11677931907622429588\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest3/providers/Microsoft.Authorization/policyDefinitions/99b560dc-8924-4ba4-8467-adf1fdf04660\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17175752026273514153\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest5/providers/Microsoft.Authorization/policyDefinitions/e1d7de9f-42f0-4af1-9ee0-0187bfce08d5\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"australiacentral\",\r\n                  \"australiacentral2\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"francecentral\",\r\n                  \"francesouth\",\r\n                  \"global\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"southcentralus\",\r\n                  \"southindia\",\r\n                  \"southeastasia\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17602706772987440385\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest3/providers/Microsoft.Authorization/policyDefinitions/ced9d1e5-109c-4e0b-a447-afbf649db203\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Premium_LRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9371630468206030356\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest3/providers/Microsoft.Authorization/policyDefinitions/ced9d1e5-109c-4e0b-a447-afbf649db22a\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Standard_A8m_v2\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovTest5/providers/Microsoft.Authorization/policySetDefinitions/8a3978dc-2d90-477d-91e6-8746066f9061\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"8a3978dc-2d90-477d-91e6-8746066f9061\"\r\n    }\r\n  ]\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/06122b01-688c-42a8-af2e-fa97dd39aa3b?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8wNjEyMmIwMS02ODhjLTQyYTgtYWYyZS1mYTk3ZGQzOWFhM2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:74168f10-0373-4f6a-ba2c-d33b98c8ed99"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "5bd60161-9e80-4e3d-8dc6-0a4950ea75ca"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205339Z:5bd60161-9e80-4e3d-8dc6-0a4950ea75ca"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:39 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '06122b01-688c-42a8-af2e-fa97dd39aa3b' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/06122b01-688c-42a8-af2e-fa97dd39aa3b?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8wNjEyMmIwMS02ODhjLTQyYTgtYWYyZS1mYTk3ZGQzOWFhM2I/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:799b08b4-ad56-499e-a584-9f5dbabb0a9d"
        ],
        "x-ms-correlation-request-id": [
          "b3d0e50f-ec89-45da-8bda-6dd31e14c9d8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205339Z:b3d0e50f-ec89-45da-8bda-6dd31e14c9d8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:39 GMT"
        ],
        "Content-Length": [
          "1330"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain only the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines in which the Administrators group does not contain only the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"Members\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Members\",\r\n          \"description\": \"A semicolon-separated list of all the expected members of the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_AdministratorsGroupMembers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b821191b-3a12-44bc-9c38-212138a29ff3\",\r\n        \"parameters\": {\r\n          \"Members\": {\r\n            \"value\": \"[parameters('Members')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_AdministratorsGroupMembers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cc7cda28-f867-4311-8497-a526129a8d19\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/06122b01-688c-42a8-af2e-fa97dd39aa3b\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"06122b01-688c-42a8-af2e-fa97dd39aa3b\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/06c5e415-a662-463a-bb85-ede14286b979?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8wNmM1ZTQxNS1hNjYyLTQ2M2EtYmI4NS1lZGUxNDI4NmI5Nzk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:942a7fbb-e029-469d-aba1-57146ddb4d9c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "9613a39c-0d2a-4286-bcc8-e94d5c29f1b2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205340Z:9613a39c-0d2a-4286-bcc8-e94d5c29f1b2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:39 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '06c5e415-a662-463a-bb85-ede14286b979' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/06c5e415-a662-463a-bb85-ede14286b979?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8wNmM1ZTQxNS1hNjYyLTQ2M2EtYmI4NS1lZGUxNDI4NmI5Nzk/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11993"
        ],
        "x-ms-request-id": [
          "westus:c4418570-5bf1-4661-8112-3d76e57c8e58"
        ],
        "x-ms-correlation-request-id": [
          "8564cfb3-8bc6-4676-bfa4-a7f837455289"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205340Z:8564cfb3-8bc6-4676-bfa4-a7f837455289"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:39 GMT"
        ],
        "Content-Length": [
          "1343"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs on which the Log Analytics agent is not connected as expected\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"WorkspaceId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Connected workspace IDs\",\r\n          \"description\": \"A semicolon-separated list of the workspace IDs that the Log Analytics agent should be connected to\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsLogAnalyticsAgentConnection\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/68511db2-bd02-41c4-ae6b-1900a012968a\",\r\n        \"parameters\": {\r\n          \"WorkspaceId\": {\r\n            \"value\": \"[parameters('WorkspaceId')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsLogAnalyticsAgentConnection\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/06c5e415-a662-463a-bb85-ede14286b979\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"06c5e415-a662-463a-bb85-ede14286b979\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/133046de-0bd7-4546-93f4-f452e9e258b7?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8xMzMwNDZkZS0wYmQ3LTQ1NDYtOTNmNC1mNDUyZTllMjU4Yjc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:4a6b43e7-6623-4cd1-bd2d-cf6ec6b3e4bd"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "0509dd3c-8d78-4e5e-97db-e858c0f50bc3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205340Z:0509dd3c-8d78-4e5e-97db-e858c0f50bc3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:39 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '133046de-0bd7-4546-93f4-f452e9e258b7' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/133046de-0bd7-4546-93f4-f452e9e258b7?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8xMzMwNDZkZS0wYmQ3LTQ1NDYtOTNmNC1mNDUyZTllMjU4Yjc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:cfa0b00c-1744-4ee9-a12f-51cd885fc66f"
        ],
        "x-ms-correlation-request-id": [
          "47573b3b-2195-4b33-8f4d-1251de6ace26"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205340Z:47573b3b-2195-4b33-8f4d-1251de6ace26"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:40 GMT"
        ],
        "Content-Length": [
          "1397"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs in which the Administrators group does not contain all of the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines in which the Administrators group does not contain all of the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"MembersToInclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Members to include\",\r\n          \"description\": \"A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_AdministratorsGroupMembersToInclude\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\",\r\n        \"parameters\": {\r\n          \"MembersToInclude\": {\r\n            \"value\": \"[parameters('MembersToInclude')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_AdministratorsGroupMembersToInclude\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/133046de-0bd7-4546-93f4-f452e9e258b7\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"133046de-0bd7-4546-93f4-f452e9e258b7\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8xZjNhZmRmOS1kMGM5LTRjM2QtODQ3Zi04OWRhNjEzZTcwYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:bf518250-23cf-4b40-8739-4ac2e24996aa"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "b85c85d1-0eb5-451a-9250-561483d2ac79"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205340Z:b85c85d1-0eb5-451a-9250-561483d2ac79"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:39 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '1f3afdf9-d0c9-4c3d-847f-89da613e70a8' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8xZjNhZmRmOS1kMGM5LTRjM2QtODQ3Zi04OWRhNjEzZTcwYTg/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:faef8a9b-ba17-42bd-93be-ed3c4f18e65c"
        ],
        "x-ms-correlation-request-id": [
          "c3a4dc2a-ff8a-4303-b653-2f21bd3c44d2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205340Z:c3a4dc2a-ff8a-4303-b653-2f21bd3c44d2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:40 GMT"
        ],
        "Content-Length": [
          "65164"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Enable Monitoring in Azure Security Center\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"Monitor all the available security recommendations in Azure Security Center. This is the default policy for Azure Security Center.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {\r\n      \"vmssSystemUpdatesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"System updates on virtual machine scale sets should be installed\",\r\n          \"description\": \"Enable or disable virtual machine scale sets reporting of system updates\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"vmssEndpointProtectionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Endpoint protection solution should be installed on virtual machine scale sets\",\r\n          \"description\": \"Enable or disable virtual machine scale sets endpoint protection monitoring\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"vmssOsVulnerabilitiesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\",\r\n          \"description\": \"Enable or disable virtual machine scale sets OS vulnerabilities monitoring\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"systemUpdatesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"System updates should be installed on your machines\",\r\n          \"description\": \"Enable or disable reporting of system updates\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"systemConfigurationsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vulnerabilities in security configuration on your machines should be remediated\",\r\n          \"description\": \"Enable or disable OS vulnerabilities monitoring (based on a configured baseline)\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"endpointProtectionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor missing Endpoint Protection in Azure Security Center\",\r\n          \"description\": \"Enable or disable endpoint protection monitoring\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diskEncryptionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disk encryption should be applied on virtual machines\",\r\n          \"description\": \"Enable or disable the monitoring for VM disk encryption\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"networkSecurityGroupsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor network security groups\",\r\n          \"description\": \"[Deprecated] Enable or disable monitoring of network security groups with permissive rules\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"networkSecurityGroupsOnSubnetsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Network Security Groups on the subnet level should be enabled\",\r\n          \"description\": \"Enable or disable monitoring of NSGs on subnets\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"networkSecurityGroupsOnVirtualMachinesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Network Security Groups for virtual machines should be enabled\",\r\n          \"description\": \"Enable or disable monitoring of NSGs on VMs\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"webApplicationFirewallMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"The NSGs rules for web applications on IaaS should be hardened\",\r\n          \"description\": \"Enable or disable the monitoring of unprotected web applications\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"nextGenerationFirewallMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n          \"description\": \"Enable or disable overly permissive inbound NSG rules monitoring\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"vulnerabilityAssesmentMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vulnerabilities should be remediated by a Vulnerability Assessment solution\",\r\n          \"description\": \"Enable or disable the detection of VM vulnerabilities by a vulnerability assessment solution\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"storageEncryptionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Audit missing blob encryption for storage accounts\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of blob encryption for storage accounts\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"jitNetworkAccessMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Just-In-Time network access control should be applied on virtual machines\",\r\n          \"description\": \"Enable or disable the monitoring of network just In time access\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"adaptiveApplicationControlsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Adaptive Application Controls should be enabled on virtual machines\",\r\n          \"description\": \"Enable or disable the monitoring of application whitelisting in Azure Security Center\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlAuditingMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor unaudited SQL servers in Azure Security Center\",\r\n          \"description\": \"Enable or disable the monitoring of unaudited SQL databases\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlEncryptionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor unencrypted SQL databases in Azure Security Center\",\r\n          \"description\": \"Enable or disable the monitoring of unencrypted SQL databases\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlDbEncryptionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Transparent Data Encryption on SQL databases should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of unencrypted SQL databases\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlServerAuditingMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Audit SQL server level Auditing settings\",\r\n          \"description\": \"Enable or disable the monitoring of unaudited SQL Servers\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlServerAuditingActionsAndGroupsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Audit SQL auditing settings at the server level for the Action-Groups and Actions\",\r\n          \"description\": \"Enable or disable the monitoring of auditing policy Action-Groups and Actions setting\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"SqlServerAuditingRetentionDaysMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"SQL servers should be configured with auditing retention days greater than 90 days\",\r\n          \"description\": \"Enable or disable the monitoring of SQL servers with auditing retention period less than 90\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInAppServiceMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor diagnostic logs in Azure App Services\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of diagnostics logs in Azure App Services\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"diagnosticsLogsInSelectiveAppServicesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in App Services should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostics logs in Azure App Services\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"encryptionOfAutomationAccountMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Automation account variables should be encrypted\",\r\n          \"description\": \"Enable or disable the monitoring of automation account encryption\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"diagnosticsLogsInBatchAccountMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Batch accounts should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Batch accounts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInBatchAccountRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) for logs in Batch accounts\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"metricAlertsInBatchAccountMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Metric alert rules should be configured on Batch accounts\",\r\n          \"description\": \"Enable or disable the monitoring of metric alerts in Batch accounts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"classicComputeVMsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Virtual machines should be migrated to new Azure Resource Manager resources\",\r\n          \"description\": \"Enable or disable the monitoring of classic compute VMs\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"classicStorageAccountsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Storage accounts should be migrated to new Azure Resource Manager resources\",\r\n          \"description\": \"Enable or disable the monitoring of classic storage accounts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"diagnosticsLogsInDataLakeAnalyticsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Data Lake Analytics should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Data Lake Analytics accounts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInDataLakeAnalyticsRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Data Lake Analytics accounts\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"diagnosticsLogsInDataLakeStoreMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Azure Data Lake Store should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Data Lake Store accounts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInDataLakeStoreRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Data Lake Store accounts\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"diagnosticsLogsInEventHubMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Event Hub should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Event Hub accounts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInEventHubRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Event Hub accounts\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"diagnosticsLogsInKeyVaultMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Key Vault should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Key Vault vaults\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInKeyVaultRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Key Vault vaults\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"diagnosticsLogsInLogicAppsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Logic Apps should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Logic Apps workflows\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInLogicAppsRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Logic Apps workflows\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"diagnosticsLogsInRedisCacheMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Only secure connections to your Redis Cache should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Azure Redis Cache\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"diagnosticsLogsInSearchServiceMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Search services should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Azure Search service\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInSearchServiceRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Azure Search service\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"aadAuthenticationInServiceFabricMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service Fabric clusters should only use Azure Active Directory for client authentication\",\r\n          \"description\": \"Enable or disable the monitoring of Azure Active Directory for client authentication in Service Fabric\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"clusterProtectionLevelInServiceFabricMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign\",\r\n          \"description\": \"Enable or disable the monitoring of cluster protection level in Service Fabric\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"diagnosticsLogsInServiceBusMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Service Bus should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Service Bus\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInServiceBusRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Service Bus\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"namespaceAuthorizationRulesInServiceBusMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Service Bus namespace\",\r\n          \"description\": \"Enable or disable the monitoring of Service Bus namespace authorization rules\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"aadAuthenticationInSqlServerMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"An Azure Active Directory administrator should be provisioned for SQL servers\",\r\n          \"description\": \"Enable or disable the monitoring of an Azure AD admininistrator for SQL server\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"secureTransferToStorageAccountMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Secure transfer to storage accounts should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of secure transfer to storage account\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"diagnosticsLogsInStreamAnalyticsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Azure Stream Analytics should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Stream Analytics\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInStreamAnalyticsRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in Stream Analytics\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"useRbacRulesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Audit usage of custom RBAC rules\",\r\n          \"description\": \"Enable or disable the monitoring of using built-in RBAC rules\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"disableUnrestrictedNetworkToStorageAccountMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Audit unrestricted network access to storage accounts\",\r\n          \"description\": \"Enable or disable the monitoring of network access to storage account\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"diagnosticsLogsInServiceFabricMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in Virtual Machine Scale Sets should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in Service Fabric\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"accessRulesInEventHubNamespaceMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace\",\r\n          \"description\": \"Enable or disable the monitoring of access rules in Event Hub namespaces\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"accessRulesInEventHubMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Authorization rules on the Event Hub instance should be defined\",\r\n          \"description\": \"Enable or disable the monitoring of access rules in Event Hubs\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"sqlDbVulnerabilityAssesmentMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vulnerabilities on your SQL databases should be remediated\",\r\n          \"description\": \"Enable or disable the monitoring of Vulnerability Assessment scan results and recommendations for how to remediate database vulnerabilities.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlDbDataClassificationMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Sensitive data in your SQL databases should be classified\",\r\n          \"description\": \"Enable or disable the monitoring of sensitive data classification in databases.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityDesignateLessThanOwnersMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"A maximum of 3 owners should be designated for your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of maximum owners in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityDesignateMoreThanOneOwnerMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"There should be more than one owner assigned to your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of minimum owners in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityEnableMFAForOwnerPermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"MFA should be enabled on accounts with owner permissions on your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of MFA for accounts with owner permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityEnableMFAForWritePermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"MFA should be enabled accounts with write permissions on your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of MFA for accounts with write permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityEnableMFAForReadPermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"MFA should be enabled on accounts with read permissions on your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of MFA for accounts with read permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Deprecated accounts with owner permissions should be removed from your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of deprecated acounts with owner permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityRemoveDeprecatedAccountMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Deprecated accounts should be removed from your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of deprecated acounts in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"External accounts with owner permissions should be removed from your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of external acounts with owner permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityRemoveExternalAccountWithWritePermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"External accounts with write permissions should be removed from your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of external acounts with write permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"identityRemoveExternalAccountWithReadPermissionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"External accounts with read permissions should be removed from your subscription\",\r\n          \"description\": \"Enable or disable the monitoring of external acounts with read permissions in subscription\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"apiAppConfigureIPRestrictionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor Configure IP restrictions for API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of IP restrictions for API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"functionAppConfigureIPRestrictionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor Configure IP restrictions for Function App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of IP restrictions for Function App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppConfigureIPRestrictionsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor Configure IP restrictions for Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of IP restrictions for Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"apiAppDisableRemoteDebuggingMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Remote debugging should be turned off for API App\",\r\n          \"description\": \"Enable or disable the monitoring of remote debugging for API App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"functionAppDisableRemoteDebuggingMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Remote debugging should be turned off for Function App\",\r\n          \"description\": \"Enable or disable the monitoring of remote debugging for Function App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"webAppDisableRemoteDebuggingMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Remote debugging should be turned off for Web Application\",\r\n          \"description\": \"Enable or disable the monitoring of remote debugging for Web App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"apiAppDisableWebSocketsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor disable web sockets for API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of web sockets for API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"functionAppDisableWebSocketsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor disable web sockets for Function App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of web sockets for Function App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppDisableWebSocketsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor disable web sockets for Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of web sockets for Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"apiAppEnforceHttpsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"API App should only be accessible over HTTPS\",\r\n          \"description\": \"Enable or disable the monitoring of the use of HTTPS in API App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"functionAppEnforceHttpsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Function App should only be accessible over HTTPS\",\r\n          \"description\": \"Enable or disable the monitoring of the use of HTTPS in function App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"webAppEnforceHttpsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Web Application should only be accessible over HTTPS\",\r\n          \"description\": \"Enable or disable the monitoring of the use of HTTPS in Web App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"apiAppRestrictCORSAccessMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"CORS should not allow every resource to access your API App\",\r\n          \"description\": \"Enable or disable the monitoring of CORS restrictions for API App\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"functionAppRestrictCORSAccessMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"CORS should not allow every resource to access your Function App\",\r\n          \"description\": \"Enable or disable the monitoring of CORS restrictions for API Function\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"webAppRestrictCORSAccessMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"CORS should not allow every resource to access your Web Application\",\r\n          \"description\": \"Enable or disable the monitoring of CORS restrictions for API Web\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"apiAppUsedCustomDomainsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor the custom domain use in API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of custom domain use in API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"functionAppUsedCustomDomainsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor the custom domain use in Function App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of custom domain use in Function App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppUsedCustomDomainsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor the custom domain use in Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of custom domain use in Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"apiAppUsedLatestDotNetMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest .Net in API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of .Net version in API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppUsedLatestDotNetMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest .Net in Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of .Net version in Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"apiAppUsedLatestJavaMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest Java in API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of Java version in API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppUsedLatestJavaMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest Java in Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of Java version in Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppUsedLatestNodeJsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest Node.js in Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of Node.js version in Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"apiAppUsedLatestPHPMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest PHP in API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of PHP version in API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppUsedLatestPHPMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest PHP in Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of PHP version in Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"apiAppUsedLatestPythonMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest Python in API App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of Python version in API App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"webAppUsedLatestPythonMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitor use latest Python in Web App\",\r\n          \"description\": \"[Deprecated] Enable or disable the monitoring of Python version in Web App\",\r\n          \"deprecated\": true\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Disabled\"\r\n      },\r\n      \"vnetEnableDDoSProtectionMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"DDoS Protection Standard should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of DDoS protection for virtual network\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInIoTHubMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Diagnostic logs in IoT Hub should be enabled\",\r\n          \"description\": \"Enable or disable the monitoring of diagnostic logs in IoT Hubs\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"diagnosticsLogsInIoTHubRetentionDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Required retention (in days) of logs in IoT Hub accounts\",\r\n          \"description\": \"The required diagnostic logs retention period in days\"\r\n        },\r\n        \"defaultValue\": \"365\"\r\n      },\r\n      \"sqlServerAdvancedDataSecurityMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Advanced data security should be enabled on your SQL servers\",\r\n          \"description\": \"Enable or disable the monitoring of SQL servers without Advanced Data Security\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlServerAdvancedDataSecurityEmailsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Ensure that 'Send alerts to' is set in SQL server Advanced Data Security settings\",\r\n          \"description\": \"Provide the email address where alerts will be sent when anomalous activities are detected on SQL servers\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Advanced data security settings for SQL managed instance should contain an email address to receive security alerts\",\r\n          \"description\": \"Enable or disable the monitoring that advanced data security settings for SQL managed instance contain at least one email address to receive security alerts\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"SQL managed instances should send security alerts to admins and subscription owners\",\r\n          \"description\": \"Enable or Disable the monitoring of SQL managed instances without alerts being sent to admins and subscription owners\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"sqlManagedInstanceAdvancedDataSecurityMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Advanced data security should be enabled on your managed instances\",\r\n          \"description\": \"Enable or disable the monitoring of SQL managed instances without Advanced Data Security\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"kubernetesServiceRbacEnabledMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Role-Based Access Control (RBAC) should be used on Kubernetes Services\",\r\n          \"description\": \"Enable or disable the monitoring of Kubernetes Services without RBAC enabled\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"kubernetesServicePspEnabledMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Pod Security Policies should be defined on Kubernetes Services\",\r\n          \"description\": \"Enable or disable the monitoring of Kubernetes Services without Pod Security Policy enabled\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Authorized IP ranges should be defined on Kubernetes Services\",\r\n          \"description\": \"Enable or disable the monitoring of Kubernetes Services without Authorized IP Ranges enabled\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"kubernetesServiceVersionUpToDateMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Kubernetes Services should be upgraded to a non vulnerable Kubernetes version\",\r\n          \"description\": \"Enable or disable the monitoring of the Kubernetes Services with versions that contain known vulnerabilities\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Audit\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"Audit\"\r\n      },\r\n      \"vulnerabilityAssessmentOnManagedInstanceMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vulnerability assessment should be enabled on your SQL managed instances\",\r\n          \"description\": \"Audit SQL managed instances which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"vulnerabilityAssessmentOnServerMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Vulnerability assessment should be enabled on your SQL servers\",\r\n          \"description\": \"Audit Azure SQL servers which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"threatDetectionTypesOnManagedInstanceMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL managed instance Advanced Data Security settings\",\r\n          \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"threatDetectionTypesOnServerMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Advanced Threat Protection types should be set to 'All' in SQL server Advanced Data Security settings\",\r\n          \"description\": \"It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"adaptiveNetworkHardeningsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Network Security Group Rules for Internet facing virtual machines should be hardened\",\r\n          \"description\": \"Enable or disable the monitoring of Internet-facing virtual machines for Network Security Group traffic hardening recommendations\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"restrictAccessToManagementPortsMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Management ports should be closed on your virtual machines\",\r\n          \"description\": \"Enable or disable the monitoring of open management ports on Virtual Machines\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"restrictAccessToAppServicesMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Access to App Services should be restricted\",\r\n          \"description\": \"Enable or disable the monitoring of permissive network access to app-services\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"disableIPForwardingMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"IP Forwarding on your virtual machine should be disabled\",\r\n          \"description\": \"Enable or disable the monitoring of IP forwarding on virtual machines\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"SQL server TDE protector should be encrypted with your own key\",\r\n          \"description\": \"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      },\r\n      \"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"SQL managed instance TDE protector should be encrypted with your own key\",\r\n          \"description\": \"Enable or disable the monitoring of Transparent Data Encryption (TDE) with your own key support. TDE with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"AuditIfNotExists\",\r\n          \"Disabled\"\r\n        ],\r\n        \"defaultValue\": \"AuditIfNotExists\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vmssOsVulnerabilitiesMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vmssOsVulnerabilitiesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vmssEndpointProtectionMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vmssEndpointProtectionMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vmssSystemUpdatesMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vmssSystemUpdatesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInIoTHubMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInIoTHubMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInIoTHubRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInServiceFabricMonitoringEffect\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInServiceFabricMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"accessRulesInEventHubNamespaceMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('accessRulesInEventHubNamespaceMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"accessRulesInEventHubMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('accessRulesInEventHubMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"disableUnrestrictedNetworkToStorageAccountMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('disableUnrestrictedNetworkToStorageAccountMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"useRbacRulesMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('useRbacRulesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInStreamAnalyticsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInStreamAnalyticsMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInStreamAnalyticsRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"secureTransferToStorageAccountMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('secureTransferToStorageAccountMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"aadAuthenticationInSqlServerMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('aadAuthenticationInSqlServerMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"namespaceAuthorizationRulesInServiceBusMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('namespaceAuthorizationRulesInServiceBusMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInServiceBusMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInServiceBusMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInServiceBusRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"clusterProtectionLevelInServiceFabricMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('clusterProtectionLevelInServiceFabricMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"aadAuthenticationInServiceFabricMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('aadAuthenticationInServiceFabricMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInSearchServiceMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInSearchServiceMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInSearchServiceRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInRedisCacheMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInRedisCacheMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInLogicAppsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInLogicAppsMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInLogicAppsRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInKeyVaultMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInKeyVaultMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInKeyVaultRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInEventHubMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInEventHubMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInEventHubRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInDataLakeStoreMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInDataLakeStoreMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInDataLakeStoreRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInDataLakeAnalyticsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInDataLakeAnalyticsMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInDataLakeAnalyticsRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"classicStorageAccountsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('classicStorageAccountsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"classicComputeVMsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('classicComputeVMsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"metricAlertsInBatchAccountPoolDeleteStart\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('metricAlertsInBatchAccountMonitoringEffect')]\"\r\n          },\r\n          \"metricName\": {\r\n            \"value\": \"PoolDeleteStartEvent\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInBatchAccountMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInBatchAccountMonitoringEffect')]\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInBatchAccountRetentionDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"encryptionOfAutomationAccountMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('encryptionOfAutomationAccountMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diagnosticsLogsInSelectiveAppServicesMonitoringEffect\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diagnosticsLogsInSelectiveAppServicesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlDbEncryptionMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlDbEncryptionMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlServerAuditingMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlServerAuditingMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlServerAuditingActionsAndGroupsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlServerAuditingActionsAndGroupsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"SqlServerAuditingRetentionDaysMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('SqlServerAuditingRetentionDaysMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlEncryptionMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlEncryptionMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlAuditingMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlAuditingMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"systemUpdatesMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('systemUpdatesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"jitNetworkAccessMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('jitNetworkAccessMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"adaptiveApplicationControlsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('adaptiveApplicationControlsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"networkSecurityGroupsOnSubnetsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('networkSecurityGroupsOnSubnetsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"networkSecurityGroupsOnVirtualMachinesMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('networkSecurityGroupsOnVirtualMachinesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"systemConfigurationsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('systemConfigurationsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"endpointProtectionMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('endpointProtectionMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"diskEncryptionMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('diskEncryptionMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vulnerabilityAssessmentMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vulnerabilityAssesmentMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"webApplicationFirewallMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('webApplicationFirewallMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"nextGenerationFirewallMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('nextGenerationFirewallMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlDbVulnerabilityAssesmentMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlDbVulnerabilityAssesmentMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlDbDataClassificationMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlDbDataClassificationMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityDesignateLessThanOwnersMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityDesignateLessThanOwnersMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityDesignateMoreThanOneOwnerMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityDesignateMoreThanOneOwnerMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityEnableMFAForOwnerPermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityEnableMFAForOwnerPermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityEnableMFAForWritePermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityEnableMFAForWritePermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityEnableMFAForReadPermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityEnableMFAForReadPermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityRemoveDeprecatedAccountWithOwnerPermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityRemoveDeprecatedAccountMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityRemoveDeprecatedAccountMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityRemoveExternalAccountWithOwnerPermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityRemoveExternalAccountWithOwnerPermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityRemoveExternalAccountWithWritePermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityRemoveExternalAccountWithWritePermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"identityRemoveExternalAccountWithReadPermissionsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('identityRemoveExternalAccountWithReadPermissionsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"apiAppDisableRemoteDebuggingMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('apiAppDisableRemoteDebuggingMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"functionAppDisableRemoteDebuggingMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('functionAppDisableRemoteDebuggingMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"webAppDisableRemoteDebuggingMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('webAppDisableRemoteDebuggingMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"apiAppEnforceHttpsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('apiAppEnforceHttpsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"functionAppEnforceHttpsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('functionAppEnforceHttpsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"webAppEnforceHttpsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('webAppEnforceHttpsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"apiAppRestrictCORSAccessMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('apiAppRestrictCORSAccessMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"functionAppRestrictCORSAccessMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('functionAppRestrictCORSAccessMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"webAppRestrictCORSAccessMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('webAppRestrictCORSAccessMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vnetEnableDDoSProtectionMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vnetEnableDDoSProtectionMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlServerAdvancedDataSecurityMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlServerAdvancedDataSecurityMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlServerAdvancedDataSecurityEmailsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9677b740-f641-4f3c-b9c5-466005c85278\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlServerAdvancedDataSecurityEmailsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlManagedInstanceAdvancedDataSecurityEmailsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlManagedInstanceAdvancedDataSecurityEmailsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlManagedInstanceAdvancedDataSecurityEmailAdminsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"sqlManagedInstanceAdvancedDataSecurityMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('sqlManagedInstanceAdvancedDataSecurityMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"kubernetesServiceRbacEnabledMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('kubernetesServiceRbacEnabledMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"kubernetesServicePspEnabledMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('kubernetesServicePspEnabledMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"kubernetesServiceVersionUpToDateMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/fb893a29-21bb-418c-a157-e99480ec364c\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('kubernetesServiceVersionUpToDateMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"kubernetesServiceAuthorizedIPRangesEnabledMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('kubernetesServiceAuthorizedIPRangesEnabledMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vulnerabilityAssessmentOnServerMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vulnerabilityAssessmentOnServerMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"vulnerabilityAssessmentOnManagedInstanceMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('vulnerabilityAssessmentOnManagedInstanceMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"threatDetectionTypesOnServerMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('threatDetectionTypesOnServerMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"threatDetectionTypesOnManagedInstanceMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('threatDetectionTypesOnManagedInstanceMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"adaptiveNetworkHardeningsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('adaptiveNetworkHardeningsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"restrictAccessToManagementPortsMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('restrictAccessToManagementPortsMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"restrictAccessToAppServicesMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('restrictAccessToAppServicesMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"disableIPForwardingMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('disableIPForwardingMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ensureServerTDEIsEncryptedWithYourOwnKeyMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('ensureServerTDEIsEncryptedWithYourOwnKeyMonitoringEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoring\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"[parameters('ensureManagedInstanceTDEIsEncryptedWithYourOwnKeyMonitoringEffect')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"1f3afdf9-d0c9-4c3d-847f-89da613e70a8\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8yNWVmOWI3Mi00YWYyLTQ1MDEtYWNkMS1mYzgxNGU3M2RkZTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:cb17f6bc-a043-405b-a21b-f9527344abe4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "bc24f201-177e-4140-ad10-12d8269251e4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:bc24f201-177e-4140-ad10-12d8269251e4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:40 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '25ef9b72-4af2-4501-acd1-fc814e73dde1' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8yNWVmOWI3Mi00YWYyLTQ1MDEtYWNkMS1mYzgxNGU3M2RkZTE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "9e9473bc-080f-4ac0-9c60-7abd1ec80c5d"
        ],
        "x-ms-request-id": [
          "westus:aa61271b-7c3b-4e43-98c8-441b7e315d85"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:9e9473bc-080f-4ac0-9c60-7abd1ec80c5d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:40 GMT"
        ],
        "Content-Length": [
          "1457"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that do not have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"installedApplication\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names (supports wildcards)\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_InstalledApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\",\r\n        \"parameters\": {\r\n          \"installedApplication\": {\r\n            \"value\": \"[parameters('installedApplication')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_InstalledApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/25ef9b72-4af2-4501-acd1-fc814e73dde1\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"25ef9b72-4af2-4501-acd1-fc814e73dde1\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/3937f550-eedd-4639-9c5e-294358be442e?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8zOTM3ZjU1MC1lZWRkLTQ2MzktOWM1ZS0yOTQzNThiZTQ0MmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:bb060286-5cbe-4dcc-ad45-a9ad4eaa561d"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "8687c7c5-3352-44cb-8220-19af72ad3a38"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:8687c7c5-3352-44cb-8220-19af72ad3a38"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:40 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '3937f550-eedd-4639-9c5e-294358be442e' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/3937f550-eedd-4639-9c5e-294358be442e?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8zOTM3ZjU1MC1lZWRkLTQ2MzktOWM1ZS0yOTQzNThiZTQ0MmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "fa64cae6-5ff1-4d69-b887-a378b63c40e9"
        ],
        "x-ms-request-id": [
          "westus:83d0d6ab-a515-4181-ae16-8aee9ff8cc1d"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:fa64cae6-5ff1-4d69-b887-a378b63c40e9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "14297"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit UK OFFICIAL and UK NHS controls and deploy specific VM Extensions to support audit requirements\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative includes policies that address a subset of UK OFFICIAL and UK NHS controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/ukofficial-blueprint and https://aka.ms/uknhs-blueprint\",\r\n    \"metadata\": {\r\n      \"category\": \"Regulatory Compliance\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"List of resource types that should have diagnostic logs enabled\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ],\r\n        \"defaultValue\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithReadPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithReadPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMaximumPasswordAge70Days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMinimumPasswordAge1Day\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmEtcPasswdFilePermissionsAreSetTo0644\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMaximumPasswordAge70Days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMinimumPasswordAge1Day\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleAppWhitelistingInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnauditedSQLDatabaseInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedSQLDatabaseInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedVmDisksInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorVmVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditDiagnosticSetting\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditEnablementOfEncryptionOfAutomationAccountVariables\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSecureTransferToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSQLServerLevelAuditingSettings\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditTheSettingOfClusterprotectionlevelPropertyToEncryptandsignInServiceFabric\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditTransparentDataEncryptionStatus\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUnrestrictedNetworkAccessToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUsageOfAzureActiveDirectoryForClientAuthenticationInServiceFabric\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditVMsThatDoNotUseManagedDisks\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUseOfClassicStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUseOfClassicVirtualMachines\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n        \"parameters\": {}\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/3937f550-eedd-4639-9c5e-294358be442e\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"3937f550-eedd-4639-9c5e-294358be442e\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8zZmE3Y2JmNS1jMGE0LTRhNTktODVhNS1jY2E0ZDk5NmQ1YTY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:82fbec07-387a-48cc-8d6d-2faf9769071a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "b5abc2e8-e407-48eb-afc0-8ec55bb044ab"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:b5abc2e8-e407-48eb-afc0-8ec55bb044ab"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy8zZmE3Y2JmNS1jMGE0LTRhNTktODVhNS1jY2E0ZDk5NmQ1YTY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:d606444d-bea3-4a3e-867b-fd0c3a6e22a4"
        ],
        "x-ms-correlation-request-id": [
          "0d87ae57-b290-4707-ba5a-69383fee920f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:0d87ae57-b290-4707-ba5a-69383fee920f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:40 GMT"
        ],
        "Content-Length": [
          "3832"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit VMs with insecure password security settings\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits virtual machines with insecure password security settings. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_MaximumPasswordAge\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_MinimumPasswordAge\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_PasswordMustMeetComplexityRequirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_StorePasswordsUsingReversibleEncryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_EnforcePasswordHistory\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_MinimumPasswordLength\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_PasswordPolicy_msid110\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_PasswordPolicy_msid121\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_PasswordPolicy_msid232\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_MaximumPasswordAge\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_MinimumPasswordAge\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_PasswordMustMeetComplexityRequirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_StorePasswordsUsingReversibleEncryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_EnforcePasswordHistory\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_MinimumPasswordLength\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_PasswordPolicy_msid110\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_PasswordPolicy_msid121\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_PasswordPolicy_msid232\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"3fa7cbf5-c0a4-4a59-85a5-cca4d996d5a6\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/496eeda9-8f2f-4d5e-8dfd-204f0a92ed41?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy80OTZlZWRhOS04ZjJmLTRkNWUtOGRmZC0yMDRmMGE5MmVkNDE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f2626a74-a18b-4366-acf1-3afe9ffa9041"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "1e6b61c9-1d49-476c-80ed-7db20e64043f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:1e6b61c9-1d49-476c-80ed-7db20e64043f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '496eeda9-8f2f-4d5e-8dfd-204f0a92ed41' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/496eeda9-8f2f-4d5e-8dfd-204f0a92ed41?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy80OTZlZWRhOS04ZjJmLTRkNWUtOGRmZC0yMDRmMGE5MmVkNDE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:d44dfe0d-f4da-43eb-a1d0-71e1cba96e22"
        ],
        "x-ms-correlation-request-id": [
          "4f45b6dd-6a8b-4ca7-8096-26e9003e5c44"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205341Z:4f45b6dd-6a8b-4ca7-8096-26e9003e5c44"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "12799"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit PCI v3.2.1:2018 controls and deploy specific VM Extensions to support audit requirements\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of PCI v3.2.1:2018 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/pciv321-init.\",\r\n    \"metadata\": {\r\n      \"category\": \"Regulatory Compliance\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"List of resource types that should have diagnostic logs enabled\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ],\r\n        \"defaultValue\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditDeprecatedAccountsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditExternalAccountsWithReadPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditWindowsVmMaximumPasswordAge70Days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewDeployVmExtensionToAuditWindowsVmMaximumPasswordAge70Days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewDeployVmExtensionToAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewDeployVmExtensionToAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditHttpsOnlyAccessForAnApiApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditHttpsOnlyAccessForAFunctionApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditHttpsOnlyAccessForAWebApplication\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditMaximumNumberOfOwnersForASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewAuditMinimumNumberOfOwnersForSubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorUnauditedSQLDatabaseInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorUnencryptedSQLDatabaseInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorUnencryptedVmDisksInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"accessThroughInternetFacingEndpointShouldBeRestricted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"previewMonitorVmVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditDiagnosticSetting\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditEnablementOfEncryptionOfAutomationAccountVariables\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditSecureTransferToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditSQLServerLevelAuditingSettings\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditTheSettingOfClusterprotectionlevelPropertyToEncryptandsignInServiceFabric\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditUseOfClassicStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditUseOfClassicVirtualMachines\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditTransparentDataEncryptionStatus\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditUnrestrictedNetworkAccessToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"auditUsageOfCustomRBACRules\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n        \"parameters\": {}\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/496eeda9-8f2f-4d5e-8dfd-204f0a92ed41\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"496eeda9-8f2f-4d5e-8dfd-204f0a92ed41\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/538942d3-3fae-4fb6-9d94-744f9a51e7da?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy81Mzg5NDJkMy0zZmFlLTRmYjYtOWQ5NC03NDRmOWE1MWU3ZGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:b7a10050-8230-434f-8096-6fadebd41b50"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "3ac387a3-a7e8-43fe-8e11-511094cb346f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:3ac387a3-a7e8-43fe-8e11-511094cb346f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '538942d3-3fae-4fb6-9d94-744f9a51e7da' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/538942d3-3fae-4fb6-9d94-744f9a51e7da?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy81Mzg5NDJkMy0zZmFlLTRmYjYtOWQ5NC03NDRmOWE1MWU3ZGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:0700078a-eabf-46da-aaef-cc1efd9f27f6"
        ],
        "x-ms-correlation-request-id": [
          "a693cebb-992a-48e2-abc4-338a3f369551"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:a693cebb-992a-48e2-abc4-338a3f369551"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "5350"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that are not set to the specified time zone\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that are not set to the specified time zone. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"TimeZone\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Time zone\",\r\n          \"description\": \"The expected time zone\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"(UTC-12:00) International Date Line West\",\r\n          \"(UTC-11:00) Coordinated Universal Time-11\",\r\n          \"(UTC-10:00) Aleutian Islands\",\r\n          \"(UTC-10:00) Hawaii\",\r\n          \"(UTC-09:30) Marquesas Islands\",\r\n          \"(UTC-09:00) Alaska\",\r\n          \"(UTC-09:00) Coordinated Universal Time-09\",\r\n          \"(UTC-08:00) Baja California\",\r\n          \"(UTC-08:00) Coordinated Universal Time-08\",\r\n          \"(UTC-08:00) Pacific Time (US & Canada)\",\r\n          \"(UTC-07:00) Arizona\",\r\n          \"(UTC-07:00) Chihuahua, La Paz, Mazatlan\",\r\n          \"(UTC-07:00) Mountain Time (US & Canada)\",\r\n          \"(UTC-06:00) Central America\",\r\n          \"(UTC-06:00) Central Time (US & Canada)\",\r\n          \"(UTC-06:00) Easter Island\",\r\n          \"(UTC-06:00) Guadalajara, Mexico City, Monterrey\",\r\n          \"(UTC-06:00) Saskatchewan\",\r\n          \"(UTC-05:00) Bogota, Lima, Quito, Rio Branco\",\r\n          \"(UTC-05:00) Chetumal\",\r\n          \"(UTC-05:00) Eastern Time (US & Canada)\",\r\n          \"(UTC-05:00) Haiti\",\r\n          \"(UTC-05:00) Havana\",\r\n          \"(UTC-05:00) Indiana (East)\",\r\n          \"(UTC-05:00) Turks and Caicos\",\r\n          \"(UTC-04:00) Asuncion\",\r\n          \"(UTC-04:00) Atlantic Time (Canada)\",\r\n          \"(UTC-04:00) Caracas\",\r\n          \"(UTC-04:00) Cuiaba\",\r\n          \"(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\",\r\n          \"(UTC-04:00) Santiago\",\r\n          \"(UTC-03:30) Newfoundland\",\r\n          \"(UTC-03:00) Araguaina\",\r\n          \"(UTC-03:00) Brasilia\",\r\n          \"(UTC-03:00) Cayenne, Fortaleza\",\r\n          \"(UTC-03:00) City of Buenos Aires\",\r\n          \"(UTC-03:00) Greenland\",\r\n          \"(UTC-03:00) Montevideo\",\r\n          \"(UTC-03:00) Punta Arenas\",\r\n          \"(UTC-03:00) Saint Pierre and Miquelon\",\r\n          \"(UTC-03:00) Salvador\",\r\n          \"(UTC-02:00) Coordinated Universal Time-02\",\r\n          \"(UTC-02:00) Mid-Atlantic - Old\",\r\n          \"(UTC-01:00) Azores\",\r\n          \"(UTC-01:00) Cabo Verde Is.\",\r\n          \"(UTC) Coordinated Universal Time\",\r\n          \"(UTC+00:00) Dublin, Edinburgh, Lisbon, London\",\r\n          \"(UTC+00:00) Monrovia, Reykjavik\",\r\n          \"(UTC+00:00) Sao Tome\",\r\n          \"(UTC+01:00) Casablanca\",\r\n          \"(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\",\r\n          \"(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\",\r\n          \"(UTC+01:00) Brussels, Copenhagen, Madrid, Paris\",\r\n          \"(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb\",\r\n          \"(UTC+01:00) West Central Africa\",\r\n          \"(UTC+02:00) Amman\",\r\n          \"(UTC+02:00) Athens, Bucharest\",\r\n          \"(UTC+02:00) Beirut\",\r\n          \"(UTC+02:00) Cairo\",\r\n          \"(UTC+02:00) Chisinau\",\r\n          \"(UTC+02:00) Damascus\",\r\n          \"(UTC+02:00) Gaza, Hebron\",\r\n          \"(UTC+02:00) Harare, Pretoria\",\r\n          \"(UTC+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\",\r\n          \"(UTC+02:00) Jerusalem\",\r\n          \"(UTC+02:00) Kaliningrad\",\r\n          \"(UTC+02:00) Khartoum\",\r\n          \"(UTC+02:00) Tripoli\",\r\n          \"(UTC+02:00) Windhoek\",\r\n          \"(UTC+03:00) Baghdad\",\r\n          \"(UTC+03:00) Istanbul\",\r\n          \"(UTC+03:00) Kuwait, Riyadh\",\r\n          \"(UTC+03:00) Minsk\",\r\n          \"(UTC+03:00) Moscow, St. Petersburg\",\r\n          \"(UTC+03:00) Nairobi\",\r\n          \"(UTC+03:30) Tehran\",\r\n          \"(UTC+04:00) Abu Dhabi, Muscat\",\r\n          \"(UTC+04:00) Astrakhan, Ulyanovsk\",\r\n          \"(UTC+04:00) Baku\",\r\n          \"(UTC+04:00) Izhevsk, Samara\",\r\n          \"(UTC+04:00) Port Louis\",\r\n          \"(UTC+04:00) Saratov\",\r\n          \"(UTC+04:00) Tbilisi\",\r\n          \"(UTC+04:00) Volgograd\",\r\n          \"(UTC+04:00) Yerevan\",\r\n          \"(UTC+04:30) Kabul\",\r\n          \"(UTC+05:00) Ashgabat, Tashkent\",\r\n          \"(UTC+05:00) Ekaterinburg\",\r\n          \"(UTC+05:00) Islamabad, Karachi\",\r\n          \"(UTC+05:00) Qyzylorda\",\r\n          \"(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi\",\r\n          \"(UTC+05:30) Sri Jayawardenepura\",\r\n          \"(UTC+05:45) Kathmandu\",\r\n          \"(UTC+06:00) Astana\",\r\n          \"(UTC+06:00) Dhaka\",\r\n          \"(UTC+06:00) Omsk\",\r\n          \"(UTC+06:30) Yangon (Rangoon)\",\r\n          \"(UTC+07:00) Bangkok, Hanoi, Jakarta\",\r\n          \"(UTC+07:00) Barnaul, Gorno-Altaysk\",\r\n          \"(UTC+07:00) Hovd\",\r\n          \"(UTC+07:00) Krasnoyarsk\",\r\n          \"(UTC+07:00) Novosibirsk\",\r\n          \"(UTC+07:00) Tomsk\",\r\n          \"(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi\",\r\n          \"(UTC+08:00) Irkutsk\",\r\n          \"(UTC+08:00) Kuala Lumpur, Singapore\",\r\n          \"(UTC+08:00) Perth\",\r\n          \"(UTC+08:00) Taipei\",\r\n          \"(UTC+08:00) Ulaanbaatar\",\r\n          \"(UTC+08:45) Eucla\",\r\n          \"(UTC+09:00) Chita\",\r\n          \"(UTC+09:00) Osaka, Sapporo, Tokyo\",\r\n          \"(UTC+09:00) Pyongyang\",\r\n          \"(UTC+09:00) Seoul\",\r\n          \"(UTC+09:00) Yakutsk\",\r\n          \"(UTC+09:30) Adelaide\",\r\n          \"(UTC+09:30) Darwin\",\r\n          \"(UTC+10:00) Brisbane\",\r\n          \"(UTC+10:00) Canberra, Melbourne, Sydney\",\r\n          \"(UTC+10:00) Guam, Port Moresby\",\r\n          \"(UTC+10:00) Hobart\",\r\n          \"(UTC+10:00) Vladivostok\",\r\n          \"(UTC+10:30) Lord Howe Island\",\r\n          \"(UTC+11:00) Bougainville Island\",\r\n          \"(UTC+11:00) Chokurdakh\",\r\n          \"(UTC+11:00) Magadan\",\r\n          \"(UTC+11:00) Norfolk Island\",\r\n          \"(UTC+11:00) Sakhalin\",\r\n          \"(UTC+11:00) Solomon Is., New Caledonia\",\r\n          \"(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky\",\r\n          \"(UTC+12:00) Auckland, Wellington\",\r\n          \"(UTC+12:00) Coordinated Universal Time+12\",\r\n          \"(UTC+12:00) Fiji\",\r\n          \"(UTC+12:00) Petropavlovsk-Kamchatsky - Old\",\r\n          \"(UTC+12:45) Chatham Islands\",\r\n          \"(UTC+13:00) Coordinated Universal Time+13\",\r\n          \"(UTC+13:00) Nuku'alofa\",\r\n          \"(UTC+13:00) Samoa\",\r\n          \"(UTC+14:00) Kiritimati Island\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsTimeZone\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c\",\r\n        \"parameters\": {\r\n          \"TimeZone\": {\r\n            \"value\": \"[parameters('TimeZone')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsTimeZone\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9f658460-46b7-43af-8565-94fc0662be38\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/538942d3-3fae-4fb6-9d94-744f9a51e7da\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"538942d3-3fae-4fb6-9d94-744f9a51e7da\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/55f3eceb-5573-4f18-9695-226972c6d74a?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy81NWYzZWNlYi01NTczLTRmMTgtOTY5NS0yMjY5NzJjNmQ3NGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6f9e2d0f-d95c-4fc8-816a-8dcabe0f46f6"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "e630da8c-0a1a-4159-ae6d-f9f39c3d5ad0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:e630da8c-0a1a-4159-ae6d-f9f39c3d5ad0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '55f3eceb-5573-4f18-9695-226972c6d74a' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/55f3eceb-5573-4f18-9695-226972c6d74a?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy81NWYzZWNlYi01NTczLTRmMTgtOTY5NS0yMjY5NzJjNmQ3NGE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:d66cdaf0-8468-4119-83c0-516194ad9dd4"
        ],
        "x-ms-correlation-request-id": [
          "ec5a0414-c0cc-4602-89f1-a07e9f562291"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:ec5a0414-c0cc-4602-89f1-a07e9f562291"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "3554"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Enable Azure Monitor for VMs\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"Enable Azure Monitor for the Virtual Machines (VMs) in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics_1\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\"\r\n        }\r\n      },\r\n      \"listOfImageIdToInclude_windows\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      },\r\n      \"listOfImageIdToInclude_linux\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Windows_VM_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"value\": \"[parameters('logAnalytics_1')]\"\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Linux_VM_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"value\": \"[parameters('logAnalytics_1')]\"\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Windows_VM_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Linux_VM_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"LogAnalytics_OSImage_Audit\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DependencyAgent_OSImage_Audit\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/55f3eceb-5573-4f18-9695-226972c6d74a\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"55f3eceb-5573-4f18-9695-226972c6d74a\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/6b3c1e80-8ae5-405b-b021-c23d13b3959f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy82YjNjMWU4MC04YWU1LTQwNWItYjAyMS1jMjNkMTNiMzk1OWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:e340d62b-578a-4640-ac4d-ceb73237de0f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "7dcb1d3e-7f10-4648-994b-486327b12387"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:7dcb1d3e-7f10-4648-994b-486327b12387"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:41 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '6b3c1e80-8ae5-405b-b021-c23d13b3959f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/6b3c1e80-8ae5-405b-b021-c23d13b3959f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy82YjNjMWU4MC04YWU1LTQwNWItYjAyMS1jMjNkMTNiMzk1OWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:90446d54-5207-44f9-bb72-675d5ca21554"
        ],
        "x-ms-correlation-request-id": [
          "979eda52-a7d6-4710-aad0-03d619e055e0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:979eda52-a7d6-4710-aad0-03d619e055e0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:42 GMT"
        ],
        "Content-Length": [
          "1230"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that are not joined to the specified domain\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that are not joined to the specified domain. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"DomainName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Domain Name (FQDN)\",\r\n          \"description\": \"The fully qualified domain name (FQDN) that the Windows VMs should be joined to\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsDomainMembership\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970\",\r\n        \"parameters\": {\r\n          \"DomainName\": {\r\n            \"value\": \"[parameters('DomainName')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsDomainMembership\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/6b3c1e80-8ae5-405b-b021-c23d13b3959f\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"6b3c1e80-8ae5-405b-b021-c23d13b3959f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/75714362-cae7-409e-9b99-a8e5075b7fad?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy83NTcxNDM2Mi1jYWU3LTQwOWUtOWI5OS1hOGU1MDc1YjdmYWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:bd6665cf-e61e-429d-83e4-b68a0ac3ba39"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "495ebe87-7b02-4010-ae02-8faacc1e879a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:495ebe87-7b02-4010-ae02-8faacc1e879a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:42 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '75714362-cae7-409e-9b99-a8e5075b7fad' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/75714362-cae7-409e-9b99-a8e5075b7fad?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy83NTcxNDM2Mi1jYWU3LTQwOWUtOWI5OS1hOGU1MDc1YjdmYWQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:49ef1467-d6c0-4936-9345-e18162fb07f2"
        ],
        "x-ms-correlation-request-id": [
          "9b6f4283-5e12-432a-8004-cce46a46c7a5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205342Z:9b6f4283-5e12-432a-8004-cce46a46c7a5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:42 GMT"
        ],
        "Content-Length": [
          "3769"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Enable Azure Monitor for VM Scale Sets (VMSS)\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"Enable Azure Monitor for the VM Scale Sets in the specified scope (Management group, Subscription or resource group). Takes Log Analytics workspace as parameter. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n    \"metadata\": {\r\n      \"category\": \"Monitoring\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalytics_1\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace\",\r\n          \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n          \"strongType\": \"omsWorkspace\"\r\n        }\r\n      },\r\n      \"listOfImageIdToInclude_windows\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      },\r\n      \"listOfImageIdToInclude_linux\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n          \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n        },\r\n        \"defaultValue\": []\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Windows_VMSS_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"value\": \"[parameters('logAnalytics_1')]\"\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"LogAnalyticsExtension_Linux_VMSS_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\",\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"value\": \"[parameters('logAnalytics_1')]\"\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Windows_VMSS_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DependencyAgentExtension_Linux_VMSS_Deploy\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"LogAnalytics_OSImage_VMSS_Audit\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DependencyAgent_OSImage_VMSS_Audit\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"value\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/75714362-cae7-409e-9b99-a8e5075b7fad\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"75714362-cae7-409e-9b99-a8e5075b7fad\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy84OWM2Y2RkYy0xYzczLTRhYzEtYjE5Yy01NGQxYTE1YTQyZjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:6882d917-0ba1-4d6a-a7b8-3287e2a99055"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "0bfd7d79-d7f9-422e-8496-d854509e6bf0"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:0bfd7d79-d7f9-422e-8496-d854509e6bf0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:42 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '89c6cddc-1c73-4ac1-b19c-54d1a15a42f2' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy84OWM2Y2RkYy0xYzczLTRhYzEtYjE5Yy01NGQxYTE1YTQyZjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11994"
        ],
        "x-ms-request-id": [
          "westus:69b0053c-ccc5-4bf5-a6ac-7960cb7e478b"
        ],
        "x-ms-correlation-request-id": [
          "82d77c02-ffa2-4f06-b645-b0080ab71e38"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:82d77c02-ffa2-4f06-b645-b0080ab71e38"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:42 GMT"
        ],
        "Content-Length": [
          "17361"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit ISO 27001:2013 controls and deploy specific VM Extensions to support audit requirements\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of ISO 27001:2013 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/iso27001-blueprint.\",\r\n    \"metadata\": {\r\n      \"category\": \"Regulatory Compliance\"\r\n    },\r\n    \"parameters\": {\r\n      \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"List of resource types that should have diagnostic logs enabled\",\r\n          \"strongType\": \"resourceTypes\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ],\r\n        \"defaultValue\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithReadPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDependencyAgentDeploymentVmImageOSUnlisted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDependencyAgentDeploymentInVMSSVmImageOSUnlisted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditLinuxVmPasswdFilePermissions\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMaximumPasswordAge70Days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmMinimumPasswordAge1Day\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVmExtensionToAuditWindowsVmShouldNotStorePasswordsUsingReversibleEncryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmEtcPasswdFilePermissionsAreSetTo0644\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAFunctionApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAWebApplication\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAnApiApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLinuxVmAllowingRemoteConnectionsFromAccountsWithNoPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentVmImageOSUnlisted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentInVMSSVmImageOSUnlisted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditMaximumNumberOfOwnersForASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditMinimumNumberOfOwnersForSubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmEnforcesPasswordComplexityRequirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMaximumPasswordAge70Days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmMinimumPasswordAge1Day\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmPasswordsMustBeAtLeast14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmShouldNotAllowPrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditWindowsVmShouldNotStorePasswordsUsingReversibleEncryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleAppWhitelistingInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnauditedSQLDatabaseInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedSQLDatabaseInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedVmDisksInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnprotectedNetworkEndpointsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnprotectedWebApplicationInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorVmVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditDiagnosticSetting\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditEnablementOfEncryptionOfAutomationAccountVariables\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSecureTransferToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSQLServerLevelAuditingSettings\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditTheSettingOfClusterprotectionlevelPropertyToEncryptandsignInServiceFabric\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditTransparentDataEncryptionStatus\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUnrestrictedNetworkAccessToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUsageOfAzureActiveDirectoryForClientAuthenticationInServiceFabric\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUsageOfCustomRBACRules\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUseOfClassicStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUseOfClassicVirtualMachines\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditVMsThatDoNotUseManagedDisks\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n        \"parameters\": {}\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/89c6cddc-1c73-4ac1-b19c-54d1a15a42f2\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"89c6cddc-1c73-4ac1-b19c-54d1a15a42f2\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy84YmM1NWU2Yi1lOWQ1LTQyNjYtOGRhYy1mNjg4ZDE1MWVjOWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:f50c6abc-ae17-4b1c-865f-c4771b731d78"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "7b255532-5f90-4f07-8a64-e3e1823a38e1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:7b255532-5f90-4f07-8a64-e3e1823a38e1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '8bc55e6b-e9d5-4266-8dac-f688d151ec9c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy84YmM1NWU2Yi1lOWQ1LTQyNjYtOGRhYy1mNjg4ZDE1MWVjOWM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-request-id": [
          "westus:244abe97-c570-49bb-a729-e89c0dc07404"
        ],
        "x-ms-correlation-request-id": [
          "b35516e9-9d75-4f00-a5eb-9babda20ea82"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:b35516e9-9d75-4f00-a5eb-9babda20ea82"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "983"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows web servers that are not using secure communication protocols\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsTLS\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsTLS\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/8bc55e6b-e9d5-4266-8dac-f688d151ec9c\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"8bc55e6b-e9d5-4266-8dac-f688d151ec9c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/8eeec860-e2fa-4f89-a669-84942c57225f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy84ZWVlYzg2MC1lMmZhLTRmODktYTY2OS04NDk0MmM1NzIyNWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:0d321060-25d9-49c5-8c31-2600bde596ec"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "850bac3d-435a-4fe5-a36d-54200bc7f4bd"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:850bac3d-435a-4fe5-a36d-54200bc7f4bd"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '8eeec860-e2fa-4f89-a669-84942c57225f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/8eeec860-e2fa-4f89-a669-84942c57225f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy84ZWVlYzg2MC1lMmZhLTRmODktYTY2OS04NDk0MmM1NzIyNWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:bab50404-d1ba-40c9-b876-74dbe2cc06b5"
        ],
        "x-ms-correlation-request-id": [
          "5589fcc4-ecda-42aa-a199-a19aa77e7e01"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:5589fcc4-ecda-42aa-a199-a19aa77e7e01"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:42 GMT"
        ],
        "Content-Length": [
          "1316"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines on which the specified services are not installed and 'Running'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"ServiceName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Service names (supports wildcards)\",\r\n          \"description\": \"A semicolon-separated list of the names of the services that should be installed and 'Running'. e.g. 'WinRm;Wi*'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsServiceStatus\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262\",\r\n        \"parameters\": {\r\n          \"ServiceName\": {\r\n            \"value\": \"[parameters('ServiceName')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsServiceStatus\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/8eeec860-e2fa-4f89-a669-84942c57225f\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"8eeec860-e2fa-4f89-a669-84942c57225f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy85Y2IzY2M3YS1iMzliLTRiODItYmM4OS1lNWE1ZDlmZjdiOTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:8fd3c49c-abda-483a-8bd3-cea3520f91a0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "622077da-b93c-4cc3-b95a-918371a12ea6"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205343Z:622077da-b93c-4cc3-b95a-918371a12ea6"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy85Y2IzY2M3YS1iMzliLTRiODItYmM4OS1lNWE1ZDlmZjdiOTc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-correlation-request-id": [
          "eb0f4452-207a-4340-94ec-1acba4f7c99c"
        ],
        "x-ms-request-id": [
          "westus:cfa13cd7-717b-43e7-8c2e-498fe4b013a8"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:eb0f4452-207a-4340-94ec-1acba4f7c99c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "710"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Enable Data Protection Suite\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"Enable data protection for SQL servers. This initiative is assigned automatically by Azure Security Center Standard Tier.\",\r\n    \"metadata\": {\r\n      \"category\": \"Security Center\"\r\n    },\r\n    \"parameters\": {},\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"deployThreatDetectionOnSqlServers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\",\r\n        \"parameters\": {}\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"9cb3cc7a-b39b-4b82-bc89-e5a5d9ff7b97\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/9d2fd8e6-95c8-410d-add0-43ada4241574?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy85ZDJmZDhlNi05NWM4LTQxMGQtYWRkMC00M2FkYTQyNDE1NzQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:62ddffe7-5ebf-433c-b887-4477cfe0eded"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "f8701b6f-c20d-4657-abdd-bedbe5ad0e82"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:f8701b6f-c20d-4657-abdd-bedbe5ad0e82"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition '9d2fd8e6-95c8-410d-add0-43ada4241574' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/9d2fd8e6-95c8-410d-add0-43ada4241574?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy85ZDJmZDhlNi05NWM4LTQxMGQtYWRkMC00M2FkYTQyNDE1NzQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:061904a4-9393-4f31-ac28-960416de7e3d"
        ],
        "x-ms-correlation-request-id": [
          "aaa537df-7bdf-4dd8-bec0-cd0935b9e9eb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:aaa537df-7bdf-4dd8-bec0-cd0935b9e9eb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "1734"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines on which Windows Defender Exploit Guard is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"NotAvailableMachineState\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"State in which to show VMs on which Windows Defender Exploit Guard is not available\",\r\n          \"description\": \"Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to 'Non-Compliant' will make machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) non-compliant. Setting this value to 'Compliant' will make these machines compliant.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Compliant\",\r\n          \"Non-Compliant\"\r\n        ],\r\n        \"defaultValue\": \"Non-Compliant\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsDefenderExploitGuard\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\",\r\n        \"parameters\": {\r\n          \"NotAvailableMachineState\": {\r\n            \"value\": \"[parameters('NotAvailableMachineState')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsDefenderExploitGuard\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/9d2fd8e6-95c8-410d-add0-43ada4241574\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"9d2fd8e6-95c8-410d-add0-43ada4241574\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/acb6cd8e-45f5-466f-b3cb-ff6fce525f71?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9hY2I2Y2Q4ZS00NWY1LTQ2NmYtYjNjYi1mZjZmY2U1MjVmNzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:c59c8274-8d5b-4fc2-8dbb-453a8c69902e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "72f61410-12c9-4eec-bef0-1316a168289d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:72f61410-12c9-4eec-bef0-1316a168289d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'acb6cd8e-45f5-466f-b3cb-ff6fce525f71' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/acb6cd8e-45f5-466f-b3cb-ff6fce525f71?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9hY2I2Y2Q4ZS00NWY1LTQ2NmYtYjNjYi1mZjZmY2U1MjVmNzE/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "westus:8a43d6be-fc0d-42d3-814d-9f0202443102"
        ],
        "x-ms-correlation-request-id": [
          "c57e5ed0-0d8d-46cc-9f7b-0657b8bd3b13"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:c57e5ed0-0d8d-46cc-9f7b-0657b8bd3b13"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "1823"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows Server VMs on which Windows Serial Console is not enabled\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows Server virtual machines on which Windows Serial Console is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"EMSPortNumber\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"EMS Port Number\",\r\n          \"description\": \"An integer indicating the COM port to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"EMSBaudRate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"EMS Baud Rate\",\r\n          \"description\": \"An integer indicating the baud rate to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"9600\",\r\n          \"19200\",\r\n          \"38400\",\r\n          \"57600\",\r\n          \"115200\"\r\n        ],\r\n        \"defaultValue\": \"115200\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsSerialConsole\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7a031c68-d6ab-406e-a506-697a19c634b0\",\r\n        \"parameters\": {\r\n          \"EMSPortNumber\": {\r\n            \"value\": \"[parameters('EMSPortNumber')]\"\r\n          },\r\n          \"EMSBaudRate\": {\r\n            \"value\": \"[parameters('EMSBaudRate')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsSerialConsole\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/acb6cd8e-45f5-466f-b3cb-ff6fce525f71\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"acb6cd8e-45f5-466f-b3cb-ff6fce525f71\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/add1999e-a61c-46d3-b8c3-f35fb8398175?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9hZGQxOTk5ZS1hNjFjLTQ2ZDMtYjhjMy1mMzVmYjgzOTgxNzU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:15daa8a8-53b0-43ea-a707-118b51b01380"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "d91e4306-6586-49c9-a3e5-d1c57d423ef4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:d91e4306-6586-49c9-a3e5-d1c57d423ef4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'add1999e-a61c-46d3-b8c3-f35fb8398175' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/add1999e-a61c-46d3-b8c3-f35fb8398175?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9hZGQxOTk5ZS1hNjFjLTQ2ZDMtYjhjMy1mMzVmYjgzOTgxNzU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:f5f12326-e82c-4d32-a177-139fb7a1db0d"
        ],
        "x-ms-correlation-request-id": [
          "2489733b-1a58-4121-9937-a076f18a48fb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:2489733b-1a58-4121-9937-a076f18a48fb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "1381"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs in which the Administrators group contains any of the specified members\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines in which the Administrators group contains any of the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"MembersToExclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Members to exclude\",\r\n          \"description\": \"A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_AdministratorsGroupMembersToExclude\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n        \"parameters\": {\r\n          \"MembersToExclude\": {\r\n            \"value\": \"[parameters('MembersToExclude')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_AdministratorsGroupMembersToExclude\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/add1999e-a61c-46d3-b8c3-f35fb8398175\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"add1999e-a61c-46d3-b8c3-f35fb8398175\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/b6f5e05c-0aaa-4337-8dd4-357c399d12ae?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9iNmY1ZTA1Yy0wYWFhLTQzMzctOGRkNC0zNTdjMzk5ZDEyYWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:1247dfad-d960-4ac4-a692-780e43be41b4"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "9a62670b-11a8-449e-af4d-601c8eb1c046"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:9a62670b-11a8-449e-af4d-601c8eb1c046"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'b6f5e05c-0aaa-4337-8dd4-357c399d12ae' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/b6f5e05c-0aaa-4337-8dd4-357c399d12ae?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9iNmY1ZTA1Yy0wYWFhLTQzMzctOGRkNC0zNTdjMzk5ZDEyYWU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:49b2eaeb-9465-4172-b0fe-92fa37197626"
        ],
        "x-ms-correlation-request-id": [
          "21c15ff4-c808-4ae5-93cc-242e1aaecd93"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205344Z:21c15ff4-c808-4ae5-93cc-242e1aaecd93"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:43 GMT"
        ],
        "Content-Length": [
          "3418"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that contain certificates expiring within the specified number of days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that contain certificates expiring within the specified number of days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"CertificateStorePath\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate store path\",\r\n          \"description\": \"The path to the certificate store containing the certificates to check the expiration dates of. Default value is 'Cert:' which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: 'Cert:\\\\LocalMachine', 'Cert:\\\\LocalMachine\\\\TrustedPublisher', 'Cert:\\\\CurrentUser'\"\r\n        },\r\n        \"defaultValue\": \"Cert:\"\r\n      },\r\n      \"ExpirationLimitInDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Expiration limit in days\",\r\n          \"description\": \"An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"CertificateThumbprintsToInclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate thumbprints to include\",\r\n          \"description\": \"A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"CertificateThumbprintsToExclude\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate thumbprints to exclude\",\r\n          \"description\": \"A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"IncludeExpiredCertificates\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Include expired certificates\",\r\n          \"description\": \"Must be 'true' or 'false'. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"false\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_CertificateExpiration\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\",\r\n        \"parameters\": {\r\n          \"CertificateStorePath\": {\r\n            \"value\": \"[parameters('CertificateStorePath')]\"\r\n          },\r\n          \"ExpirationLimitInDays\": {\r\n            \"value\": \"[parameters('ExpirationLimitInDays')]\"\r\n          },\r\n          \"CertificateThumbprintsToInclude\": {\r\n            \"value\": \"[parameters('CertificateThumbprintsToInclude')]\"\r\n          },\r\n          \"CertificateThumbprintsToExclude\": {\r\n            \"value\": \"[parameters('CertificateThumbprintsToExclude')]\"\r\n          },\r\n          \"IncludeExpiredCertificates\": {\r\n            \"value\": \"[parameters('IncludeExpiredCertificates')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_CertificateExpiration\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9328f27e-611e-44a7-a244-39109d7d35ab\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/b6f5e05c-0aaa-4337-8dd4-357c399d12ae\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"b6f5e05c-0aaa-4337-8dd4-357c399d12ae\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/b8b5b0a8-b809-4e5d-8082-382c686e35b7?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9iOGI1YjBhOC1iODA5LTRlNWQtODA4Mi0zODJjNjg2ZTM1Yjc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:531d9096-4f45-4fa6-8025-09ea4d43607e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "d13aa43e-2697-4d0a-8f73-57bc062d244b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:d13aa43e-2697-4d0a-8f73-57bc062d244b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'b8b5b0a8-b809-4e5d-8082-382c686e35b7' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/b8b5b0a8-b809-4e5d-8082-382c686e35b7?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9iOGI1YjBhOC1iODA5LTRlNWQtODA4Mi0zODJjNjg2ZTM1Yjc/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11993"
        ],
        "x-ms-request-id": [
          "westus:522feefa-373d-4dcb-97d1-fedc7020f2ad"
        ],
        "x-ms-correlation-request-id": [
          "482ca812-c071-47ba-b3f9-c4825c6da9c4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:482ca812-c071-47ba-b3f9-c4825c6da9c4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "1292"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that have not restarted within the specified number of days\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that have not restarted within the specified number of days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"NumberOfDays\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Number of days\",\r\n          \"description\": \"The number of days without restart until the machine is considered non-compliant\"\r\n        },\r\n        \"defaultValue\": \"12\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_MachineLastBootUpTime\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194\",\r\n        \"parameters\": {\r\n          \"NumberOfDays\": {\r\n            \"value\": \"[parameters('NumberOfDays')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_MachineLastBootUpTime\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/b8b5b0a8-b809-4e5d-8082-382c686e35b7\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"b8b5b0a8-b809-4e5d-8082-382c686e35b7\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/c58599d5-0d51-454f-aaf1-da18a5e76edd?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jNTg1OTlkNS0wZDUxLTQ1NGYtYWFmMS1kYTE4YTVlNzZlZGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:3aa5d379-3161-4ad8-b93f-8589f5e890e2"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "5b36bea4-c077-4e14-a6da-68402786a7b1"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:5b36bea4-c077-4e14-a6da-68402786a7b1"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'c58599d5-0d51-454f-aaf1-da18a5e76edd' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/c58599d5-0d51-454f-aaf1-da18a5e76edd?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jNTg1OTlkNS0wZDUxLTQ1NGYtYWFmMS1kYTE4YTVlNzZlZGQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:49d86439-f28a-4c86-a3f5-bd4e11479e92"
        ],
        "x-ms-correlation-request-id": [
          "cbba8bb6-58a2-4fe2-980d-c9f59207128a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:cbba8bb6-58a2-4fe2-980d-c9f59207128a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "1074"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs on which the DSC configuration is not compliant\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsDscConfiguration\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsDscConfiguration\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c58599d5-0d51-454f-aaf1-da18a5e76edd\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"c58599d5-0d51-454f-aaf1-da18a5e76edd\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jOTM3ZGNiNC00Mzk4LTRiMzktOGQ2My00YTZiZTQzMjI1MmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:637fc4ed-eaf5-4656-89c1-67fc63fec133"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "be50686e-146e-4e2d-b84e-7758398b508d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:be50686e-146e-4e2d-b84e-7758398b508d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:44 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'c937dcb4-4398-4b39-8d63-4a6be432252e' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jOTM3ZGNiNC00Mzk4LTRiMzktOGQ2My00YTZiZTQzMjI1MmU/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:471b821d-cfd1-43b7-8161-e221a28cbf0a"
        ],
        "x-ms-correlation-request-id": [
          "c951dca2-4428-49bb-8d5a-bed3b5ec2681"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:c951dca2-4428-49bb-8d5a-bed3b5ec2681"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:45 GMT"
        ],
        "Content-Length": [
          "1296"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Linux VMs that do not have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Linux virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"ApplicationName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_InstalledApplicationLinux\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721\",\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"value\": \"[parameters('ApplicationName')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_InstalledApplicationLinux\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c937dcb4-4398-4b39-8d63-4a6be432252e\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"c937dcb4-4398-4b39-8d63-4a6be432252e\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/c96b2a9c-6fab-4ac2-ae21-502143491cd4?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jOTZiMmE5Yy02ZmFiLTRhYzItYWUyMS01MDIxNDM0OTFjZDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:35fc907f-b250-4185-bf5f-103cba726ca5"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "699ba693-c72f-4f64-b26e-3da30ae7ecf2"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:699ba693-c72f-4f64-b26e-3da30ae7ecf2"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:45 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'c96b2a9c-6fab-4ac2-ae21-502143491cd4' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/c96b2a9c-6fab-4ac2-ae21-502143491cd4?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jOTZiMmE5Yy02ZmFiLTRhYzItYWUyMS01MDIxNDM0OTFjZDQ/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:75d30bfa-2f40-4b12-8aa2-3123752e0ea1"
        ],
        "x-ms-correlation-request-id": [
          "44e97ce2-9b1c-46c1-a673-e0616e1f885b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205345Z:44e97ce2-9b1c-46c1-a673-e0616e1f885b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:45 GMT"
        ],
        "Content-Length": [
          "923"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs with a pending reboot\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines with a pending reboot. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsPendingReboot\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsPendingReboot\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c96b2a9c-6fab-4ac2-ae21-502143491cd4\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"c96b2a9c-6fab-4ac2-ae21-502143491cd4\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/c980fd64-c67f-49a6-a8a8-e57661150802?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jOTgwZmQ2NC1jNjdmLTQ5YTYtYThhOC1lNTc2NjExNTA4MDI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:4be93b0f-1d6f-41b4-bb00-29da27621d71"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "c0ef1f48-47a0-4b19-beb3-7513823f938c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205346Z:c0ef1f48-47a0-4b19-beb3-7513823f938c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:45 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'c980fd64-c67f-49a6-a8a8-e57661150802' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/c980fd64-c67f-49a6-a8a8-e57661150802?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jOTgwZmQ2NC1jNjdmLTQ5YTYtYThhOC1lNTc2NjExNTA4MDI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11995"
        ],
        "x-ms-request-id": [
          "westus:eb514308-f9ab-4a6a-bbd8-7ed2cf1ef60b"
        ],
        "x-ms-correlation-request-id": [
          "8728c03b-1710-4575-89b3-583ed4fc3490"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205346Z:8728c03b-1710-4575-89b3-583ed4fc3490"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "1513"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that do not have the specified Windows PowerShell modules installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"Modules\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"PowerShell Modules\",\r\n          \"description\": \"A semicolon-separated list of the names of the PowerShell modules that should be installed. You may also specify a specific version of a module that should be installed by including a comma after the module name, followed by the desired version. e.g. PSDscResources; SqlServerDsc, 12.0.0.0; ComputerManagementDsc, 6.1.0.0\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsPowerShellModules\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf\",\r\n        \"parameters\": {\r\n          \"Modules\": {\r\n            \"value\": \"[parameters('Modules')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsPowerShellModules\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/c980fd64-c67f-49a6-a8a8-e57661150802\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"c980fd64-c67f-49a6-a8a8-e57661150802\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/cdfcc6ff-945e-4bc6-857e-056cbc511e0c?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jZGZjYzZmZi05NDVlLTRiYzYtODU3ZS0wNTZjYmM1MTFlMGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:cd210fa9-8e46-4a62-b906-c0f2dd2e4c53"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "99be6724-3e3a-4998-9be2-db526bff8798"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205346Z:99be6724-3e3a-4998-9be2-db526bff8798"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'cdfcc6ff-945e-4bc6-857e-056cbc511e0c' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/cdfcc6ff-945e-4bc6-857e-056cbc511e0c?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jZGZjYzZmZi05NDVlLTRiYzYtODU3ZS0wNTZjYmM1MTFlMGM/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:e5d1e553-0fa4-4202-b46b-1999a87d1d2a"
        ],
        "x-ms-correlation-request-id": [
          "d9cdd659-0141-45be-8366-ce1afa7b2318"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205346Z:d9cdd659-0141-45be-8366-ce1afa7b2318"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "1502"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"CertificateThumbprints\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Certificate thumbprints\",\r\n          \"description\": \"A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_WindowsCertificateInTrustedRoot\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\",\r\n        \"parameters\": {\r\n          \"CertificateThumbprints\": {\r\n            \"value\": \"[parameters('CertificateThumbprints')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_WindowsCertificateInTrustedRoot\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/cdfcc6ff-945e-4bc6-857e-056cbc511e0c\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"cdfcc6ff-945e-4bc6-857e-056cbc511e0c\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jZjI1YjljMS1iZDIzLTRlYjYtYmQyYy1mNGYzYWM2NDRhNWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:ac33a7c0-b5c7-4c2e-b939-927038838fc9"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "dfc8d409-da03-42ee-bfe7-d9d8e2345495"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205346Z:dfc8d409-da03-42ee-bfe7-d9d8e2345495"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9jZjI1YjljMS1iZDIzLTRlYjYtYmQyYy1mNGYzYWM2NDRhNWY/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "westus:5e47f240-378d-4678-896e-703cf7469337"
        ],
        "x-ms-correlation-request-id": [
          "cae798f2-d827-4ad8-a3a9-638476f12560"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205346Z:cae798f2-d827-4ad8-a3a9-638476f12560"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "21423"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"[Preview]: Audit NIST SP 800-53 R4 controls and deploy specific VM Extensions to support audit requirements\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of NIST SP 800-53 R4 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/nist80053-blueprint.\",\r\n    \"metadata\": {\r\n      \"category\": \"Regulatory Compliance\"\r\n    },\r\n    \"parameters\": {\r\n      \"logAnalyticsWorkspaceIdforVMReporting\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Log Analytics workspace ID for VM agent reporting\"\r\n        }\r\n      },\r\n      \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n        \"type\": \"Array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"List of resource types that should have diagnostic logs enabled\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ],\r\n        \"defaultValue\": [\r\n          \"Microsoft.AnalysisServices/servers\",\r\n          \"Microsoft.ApiManagement/service\",\r\n          \"Microsoft.Network/applicationGateways\",\r\n          \"Microsoft.Automation/automationAccounts\",\r\n          \"Microsoft.ContainerInstance/containerGroups\",\r\n          \"Microsoft.ContainerRegistry/registries\",\r\n          \"Microsoft.ContainerService/managedClusters\",\r\n          \"Microsoft.Batch/batchAccounts\",\r\n          \"Microsoft.Cdn/profiles/endpoints\",\r\n          \"Microsoft.CognitiveServices/accounts\",\r\n          \"Microsoft.DocumentDB/databaseAccounts\",\r\n          \"Microsoft.DataFactory/factories\",\r\n          \"Microsoft.DataLakeAnalytics/accounts\",\r\n          \"Microsoft.DataLakeStore/accounts\",\r\n          \"Microsoft.EventGrid/eventSubscriptions\",\r\n          \"Microsoft.EventGrid/topics\",\r\n          \"Microsoft.EventHub/namespaces\",\r\n          \"Microsoft.Network/expressRouteCircuits\",\r\n          \"Microsoft.Network/azureFirewalls\",\r\n          \"Microsoft.HDInsight/clusters\",\r\n          \"Microsoft.Devices/IotHubs\",\r\n          \"Microsoft.KeyVault/vaults\",\r\n          \"Microsoft.Network/loadBalancers\",\r\n          \"Microsoft.Logic/integrationAccounts\",\r\n          \"Microsoft.Logic/workflows\",\r\n          \"Microsoft.DBforMySQL/servers\",\r\n          \"Microsoft.Network/networkInterfaces\",\r\n          \"Microsoft.Network/networkSecurityGroups\",\r\n          \"Microsoft.DBforPostgreSQL/servers\",\r\n          \"Microsoft.PowerBIDedicated/capacities\",\r\n          \"Microsoft.Network/publicIPAddresses\",\r\n          \"Microsoft.RecoveryServices/vaults\",\r\n          \"Microsoft.Cache/redis\",\r\n          \"Microsoft.Relay/namespaces\",\r\n          \"Microsoft.Search/searchServices\",\r\n          \"Microsoft.ServiceBus/namespaces\",\r\n          \"Microsoft.SignalRService/SignalR\",\r\n          \"Microsoft.Sql/servers/databases\",\r\n          \"Microsoft.Sql/servers/elasticPools\",\r\n          \"Microsoft.StreamAnalytics/streamingjobs\",\r\n          \"Microsoft.TimeSeriesInsights/environments\",\r\n          \"Microsoft.Network/trafficManagerProfiles\",\r\n          \"Microsoft.Compute/virtualMachines\",\r\n          \"Microsoft.Compute/virtualMachineScaleSets\",\r\n          \"Microsoft.Network/virtualNetworks\",\r\n          \"Microsoft.Network/virtualNetworkGateways\"\r\n        ]\r\n      },\r\n      \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"List of users excluded from Windows VM Administrators group\"\r\n        }\r\n      },\r\n      \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"List of users that must be included in Windows VM Administrators group\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithOwnerPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithReadPermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAccountsWithWritePermissionsWhoAreNotMfaEnabledOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditAnyMissingSystemUpdatesOnVirtualMachineScaleSetsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditCORSResourceAccessRestrictionsForAWebApplication\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditDeprecatedAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithOwnerPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithReadPermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditExternalAccountsWithWritePermissionsOnASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAFunctionApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAWebApplication\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditHttpsOnlyAccessForAnApiApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentMImageOSUnlisted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsAgentDeploymentInVMSSVmImageOSUnlisted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditLogAnalyticsWorkspaceforVMPreviewReportMismatch\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917\",\r\n        \"parameters\": {\r\n          \"logAnalyticsWorkspaceId\": {\r\n            \"value\": \"[parameters('logAnalyticsWorkspaceIdforVMreporting')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditMaximumNumberOfOwnersForASubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditMinimumNumberOfOwnersForSubscription\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditOSVulnerabilitiesOnYourVirtualMachineScaleSetsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditRemoteDebuggingStateForAFunctionApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditRemoteDebuggingStateForAWebApplication\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditRemoteDebuggingStateForAnAPIApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditStandardTierOfDDoSProtectionIsEnabledForAVirtualNetwork\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatLinuxVMsDoNotAllowRemoteConnectionsFromAccountsWithoutPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatLinuxVMsDoNotHaveAccountsWithoutPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatLinuxVMsHaveThePasswdFilePermissionsSetTo0644\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsCannotreUseThePrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsHaveAMaximumPasswordAgeOf70days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAudiThatWindowsVMsHaveAMinimumPasswordAgeOf1Day\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsHaveThePasswordComplexitySettingEnabled\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsRestrictTheMinimumPasswordLengthTo14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditThatWindowsVMsStorePasswordsUsingReversibleEncryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewAuditTheEndpointProtectionSolutionOnVirtualMachineScaleSetsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatLinuxVMsDoNotAllowRemoteConnectionsFromAccountsWithoutPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatLinuxVMsDoNotHaveAccountsWithoutPasswords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatLinuxVMsHaveThePasswdFilePermissionsSeTTo0644\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsCannotreUseThePrevious24Passwords\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsHaveAMaximumPasswordAgeOf70days\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsHaveAMinimumPasswordAgeOf1Day\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsHaveThePasswordComplexitySettingEnabled\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsRestrictTheMinimumPasswordLengthTo14Characters\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewDeployVMExtensionToAuditThatWindowsVMsStorePasswordsUsingReversibleEncryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorInternetFacingVirtualMachinesForNetworkSecurityGroupTrafficHardeningRecommendations\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorMissingEndpointProtectionInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorMissingSystemUpdatesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorOSVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleAppWhitelistingInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorPossibleNetworkJustInTimeJITAccessInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorSQLVulnerabilityAssessmentResultsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnauditedSQLServersInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedSQLDatabasesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnencryptedVMDisksInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorUnprotectedNetworkEndpointsInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"PreviewMonitorVMVulnerabilitiesInAzureSecurityCenter\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditDiagnosticSetting\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"value\": \"[parameters('listOfResourceTypesWithDiagnosticLogsEnabled')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditEnablingOfOnlySecureConnectionsToYourRedisCache\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditProvisioningOfAnAzureActiveDirectoryAdministratorForSQLServer\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSecureTransferToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSQLManagedInstancesWithoutAdvancedDataSecurity\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSQLServerLevelAuditingSettings\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditSQLServersWithoutAdvancedDataSecurity\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditThatTheAdministratorsGroupInsideWindowsVMsExcludesTheSpecifiedMembers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditThatTheAdministratorsGroupInsideWindowsVMsIncludesTheSpecifiedMembers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditThatWindowsWebServersAreUsingsScureCommunicationProtocols\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditTransparentDataEncryptionStatus\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUnrestrictedNetworkAccessToStorageAccounts\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUsageOfAzureActiveDirectoryForClientAuthenticationInServiceFabric\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditUsageOfCustomRBACRules\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"AuditVirtualMachinesWithoutDisasterRecoveryConfigured\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\",\r\n        \"parameters\": {}\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DeployVMExtensionToAuditThatTheAdministratorsGroupInsideWindowsVMsExcludesTheSpecifiedMembers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n        \"parameters\": {\r\n          \"MembersToExclude\": {\r\n            \"value\": \"[parameters('listOfMembersToExcludeFromWindowsVMAdministratorsGroup')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DeployVMExtensionToAuditThatTheAdministratorsGroupInsideWindowsVMsIncludesTheSpecifiedMembers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\",\r\n        \"parameters\": {\r\n          \"MembersToInclude\": {\r\n            \"value\": \"[parameters('listOfMembersToIncludeInWindowsVMAdministratorsGroup')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"DeployVMExtensionToAuditThatWindowsWebServersAreUsingScureCommunicationProtocols\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\",\r\n        \"parameters\": {}\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9kN2ZmZjdlYS05ZDQ3LTQ5NTItYjg1NC1iN2RhMjYxZTQ4ZjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:139ce288-f192-480d-8d52-63a14d329a0c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "2e83ff39-c51a-448f-b46a-72ead6efe6b3"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205347Z:2e83ff39-c51a-448f-b46a-72ead6efe6b3"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'd7fff7ea-9d47-4952-b854-b7da261e48f2' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9kN2ZmZjdlYS05ZDQ3LTQ5NTItYjg1NC1iN2RhMjYxZTQ4ZjI/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11993"
        ],
        "x-ms-request-id": [
          "westus:e8071331-b08b-4383-9165-afef859b8329"
        ],
        "x-ms-correlation-request-id": [
          "d60be723-537e-4752-bdfd-af40b573efaf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205347Z:d60be723-537e-4752-bdfd-af40b573efaf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "1438"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Windows VMs that have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Windows virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"ApplicationName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names (supports wildcards)\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_NotInstalledApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2\",\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"value\": \"[parameters('ApplicationName')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_NotInstalledApp\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/d7fff7ea-9d47-4952-b854-b7da261e48f2\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"d7fff7ea-9d47-4952-b854-b7da261e48f2\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/e78961ba-36fe-4739-9212-e3031b4c8db7/providers/Microsoft.Authorization/policysetdefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20?api-version=2019-01-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZTc4OTYxYmEtMzZmZS00NzM5LTkyMTItZTMwMzFiNGM4ZGI3L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9mNDhiY2M3OC01NDAwLTRmYjAtYjkxMy01MTQwYTJlNWZhMjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus:328ca8ab-2e71-450e-93c7-50da2b084fe8"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11991"
        ],
        "x-ms-correlation-request-id": [
          "24e7ddab-4b40-4611-a9b1-4a5b90a2c95f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205347Z:24e7ddab-4b40-4611-a9b1-4a5b90a2c95f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:47 GMT"
        ],
        "Content-Length": [
          "145"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'f48bcc78-5400-4fb0-b913-5140a2e5fa20' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/Providers/Microsoft.Authorization/policysetdefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20?api-version=2019-01-01",
      "EncodedRequestUri": "L1Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lzZXRkZWZpbml0aW9ucy9mNDhiY2M3OC01NDAwLTRmYjAtYjkxMy01MTQwYTJlNWZhMjA/YXBpLXZlcnNpb249MjAxOS0wMS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "AzurePowershell/v1.0.0",
          "PSVersion/v6.1.0"
        ],
        "ParameterSetName": [
          "NameParameterSet"
        ],
        "CommandName": [
          "Get-AzPolicySetDefinition"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11996"
        ],
        "x-ms-request-id": [
          "westus:104c69bc-5b7d-497f-b377-9c636df0c56c"
        ],
        "x-ms-correlation-request-id": [
          "ba1fa11e-054f-4afc-9dd4-1045340b9630"
        ],
        "x-ms-routing-request-id": [
          "WESTUS:20190715T205347Z:ba1fa11e-054f-4afc-9dd4-1045340b9630"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Mon, 15 Jul 2019 20:53:46 GMT"
        ],
        "Content-Length": [
          "1292"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Retry-After": [
          "0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Audit Linux VMs that have the specified applications installed\",\r\n    \"policyType\": \"BuiltIn\",\r\n    \"description\": \"This initiative deploys the policy requirements and audits Linux virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n    \"metadata\": {\r\n      \"category\": \"Guest Configuration\"\r\n    },\r\n    \"parameters\": {\r\n      \"ApplicationName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Application names\",\r\n          \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'python; powershell'\"\r\n        }\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Deploy_NotInstalledApplicationLinux\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0\",\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"value\": \"[parameters('ApplicationName')]\"\r\n          }\r\n        }\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"Audit_NotInstalledApplicationLinux\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/f48bcc78-5400-4fb0-b913-5140a2e5fa20\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"f48bcc78-5400-4fb0-b913-5140a2e5fa20\"\r\n}",
      "StatusCode": 200
    }
  ],
  "Names": {},
  "Variables": {
    "SubscriptionId": "e78961ba-36fe-4739-9212-e3031b4c8db7"
  }
}